<!DOCTYPE html>
<html lang="de"> <!-- Sets the language to German for correct hyphenation. -->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Nutzungsvorgaben Security: Inhalt :: IsyFact Dokumentation</title>
    <link rel="canonical" href="https://isyfact.github.io/isyfact-standards-doku/latest/isy-security/nutzungsvorgaben/inhalt.html">
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <link rel="stylesheet" href="../../../../_/css/font-awesome.min.css">
    <link rel="stylesheet" href="../../../../_/css/isyfact.css">
    <script>var uiRootPath = '../../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://isyfact.github.io">IsyFact Dokumentation</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="isyfact-standards-doku" data-version="3.0.0-SNAPSHOT">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../einstieg/einstieg.html">IsyFact Standards</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../einstieg/einstieg.html">Einstieg</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../einstieg/vorstellung.html">Vorstellung der IsyFact</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/vorstellung/isyfact-standards.html">IsyFact-Standards</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/vorstellung/isyfact-erweiterungen.html">IsyFact-Erweiterungen</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/vorstellung/rahmenbedingungen.html">Rahmenbedingungen</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/erste-schritte.html">Erste Schritte</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../einstieg/produkte.html">Eingesetzte Produkte</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/produktkatalog/produktvorgabenAllgemein.html">Allgemeine Produktvorgaben</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/produktkatalog/technologiestackJavaSpring.html">Java/Spring</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/produktkatalog/technologiestackTypescriptAngular.html">Typescript/Angular</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/produktkatalog/negativliste.html">Negativliste</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/produktkatalog/lebenszyklus.html">Lebenszyklus</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/produktkatalog/changelog.html">Changelog</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/tutorial/master.html">Tutorial</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/whitepaper.html">Whitepaper</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../blaupausen/blaupausen.html">Blaupausen</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../blaupausen/referenzarchitektur/master.html">Referenzarchitektur</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../blaupausen/referenzarchitektur-it-system/master.html">Referenzarchitektur IT-System</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-anwendungskern/master.html">Anwendungskern</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-datenzugriff/einordnung-ziele.html">Datenzugriff</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-datenzugriff/persistenzlogik.html">Konzeption der Persistenzlogik</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-datenzugriff/historisierung.html">Historisierung</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-datenzugriff/versionierung.html">Versionierung von Datenbankschemas</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-service/master.html">Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-web-gui/master.html">Web GUI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-batch/master.html">Batch</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Vorgaben</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/vorgaben-architektur/summaryArchitectureRules.html">Architektur</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/vorgaben-it-sicherheit/summarySecurityRules.html">IT-Sicherheit</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../bausteine/bausteine.html">Bausteine</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Datum &amp; Zeit</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-datetime/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-datetime/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Fehlerbehandlung</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-exception-core/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-exception-core/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">HttpInvoker</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-serviceapi-core/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-serviceapi-core/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">JPA/Hibernate</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../isy-persistence/konzept.html">Konzept</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../isy-persistence/konzept/vorgaben-konventionen.html">Vorgaben und Konventionen</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../isy-persistence/konzept/historisierung.html">Historisierung</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../isy-persistence/konzept/versionierung-mit-liquibase.html">Versionierung (Liquibase)</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../isy-persistence/konzept/versionierung.html">Versionierung (Eigenentwicklung)</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Nutzungsvorgaben</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../isy-persistence/nutzungsvorgaben/umsetzung-datenzugriff.html">Umsetzung des Datenzugriffs</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../isy-persistence/nutzungsvorgaben/konfiguration.html">Konfiguration des O/R-Mappings</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../isy-persistence/nutzungsvorgaben/historisierung.html">Historisierung</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../isy-persistence/nutzungsvorgaben/versionierung.html">Versionierung (Eigenentwicklung)</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Konfiguration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-konfiguration/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-konfiguration/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Logging</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-logging/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-logging/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Polling</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-polling/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-polling/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">REST</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-service-rest/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-service-rest/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Security</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Sicherheit</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sicherheit/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sicherheit/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Sonderzeichen</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sonderzeichen/konzept/sonderzeichen.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sonderzeichen/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Task Scheduling</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../isy-task/konzept.html">Konzept</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../isy-task/konzept/erweiterung-spring.html">Task Scheduling mit Spring</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../isy-task/konzept/integration-isyfact.html">Integration der IsyFact in das Task Scheduling</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-task/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Überwachung</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-ueberwachung/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-ueberwachung/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Util</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-util/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Bedienkonzept</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-bedienkonzept/bedienkonzept.html">Bedienkonzept</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">JSF</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../../isyfact-jsf-doku/latest/isy-web/konzept/konzept.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../../isyfact-jsf-doku/latest/isy-web/nutzungsvorgaben/nutzungsvorgaben.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../plattform/plattform.html">Plattform</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../methodik/methodik.html">Methodik</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../methodik/namenskonventionen/master.html">Namenskonventionen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../methodik/versionierung/master.html">Versionierung</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../methodik/java-programmierkonventionen/master.html">Java Programmierkonventionen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../methodik/typescript-programmierkonventionen/master.html">TypeScript Programmierkonventionen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../methodik/vorgaben-dokumentation.html">Vorgaben Dokumentation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../methodik/diagrammerstellung.html">Diagrammerstellung und Modellierung</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../methodik/diagrammerstellung/diagramsnet.html">diagrams.net</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../methodik/diagrammerstellung/enterprise-architect.html">Enterprise Architect</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/vorgaben-dokumentation/dokumentationstypen.html">Dokumentationstypen der IsyFact</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../methodik/vorlagen.html">Vorlagen</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Spezifikation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../methodik/vorlage-systemspezifikation/master.html">Systemspezifikation</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../methodik/vorlage-schnittstellendokumentation/master.html">Schnittstellen­dokumentation</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../methodik/anleitung-datenflussdiagramme/master.html">Anleitung für Datenflussdiagramme</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/vorlage-systementwurf/antora-master.html">Systementwurf</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/vorlage-systemhandbuch/antora-master.html">Systemhandbuch</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/vorlagen/bearbeitung.html">Bearbeitung der AsciiDoc-Vorlagen</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../werkzeuge/werkzeuge.html">Werkzeuge</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../werkzeuge/dokumentation/einleitung/einfuehrung.html">Dokumentation gemäß IsyFact</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Antora (empfohlen)</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../werkzeuge/dokumentation/erstellung/erstellung-antora.html">Seiten anlegen</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../../werkzeuge/seitenvorlage.html">Seitenvorlage</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../../werkzeuge/kopiervorlage.html">Kopiervorlage für neue Seiten</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../werkzeuge/dokumentation/bearbeitung/bearbeitung-antora.html">Seiten bearbeiten</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../werkzeuge/dokumentation/generierung/generierung-antora.html">Projektseite erzeugen</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">AsciidoctorJ</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../werkzeuge/dokumentation/erstellung/erstellung-asciidoctorj.html">Neue Dokumente anlegen</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../werkzeuge/dokumentation/bearbeitung/bearbeitung-asciidoctorj.html">Dokumente bearbeiten</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../werkzeuge/dokumentation/generierung/generierung-asciidoctorj.html">PDF- und HTML-Dokumente erzeugen</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../werkzeuge/dokumentation/changelog/changelog-doku.html">Zentralisiertes und automatisiertes Changelog</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../werkzeuge/entwicklungsumgebung/master.html">Entwicklungsumgebung</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../werkzeuge/versionierungskontrolle/master.html">Versionierungskontrolle</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../werkzeuge/gui-tests/gui-tests-mit-selenium.html">GUI-Tests mit Selenium</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../changelog/aenderungen.html">Änderungen Version 3.0 (DEV)</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../changelog/releasenotes.html">Release Notes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../changelog/changelog.html">Changelog</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../changelog/migrationsleitfaden.html">Migrationsleitfaden IsyFact 3.0 (DEV)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/migrationsleitfaden-if2/master.html">Migrationsleitfaden IsyFact 2</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">IsyFact Standards</span>
    <span class="version">3.0 (DEV)</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../../glossary/latest/glossary/master.html">Glossar</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../glossary/latest/glossary/master.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../../einstieg/einstieg.html">IsyFact Standards</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../einstieg/einstieg.html">3.0 (DEV)</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../isyfact-jsf-doku/latest/isy-web/konzept/konzept.html">JavaServer Faces (JSF)</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../isyfact-jsf-doku/latest/isy-web/konzept/konzept.html">5.3</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../einstieg/einstieg.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../einstieg/einstieg.html">IsyFact Standards</a></li>
    <li><a href="inhalt.html">Nutzungsvorgaben Security: Inhalt</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/IsyFact/isyfact-standards/edit/master/isyfact-standards-doc/src/docs/antora/modules/isy-security/pages/nutzungsvorgaben/inhalt.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Inhalt" data-levels="3">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Nutzungsvorgaben Security: Inhalt</h1>
<div class="sect1">
<h2 id="software-architektur-security-baustein"><a class="anchor" href="#software-architektur-security-baustein"></a>1. Software-Architektur des Security Bausteins</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Die Software-Architektur des Security-Bausteins bildet das Fundament für die Sicherheit von Anwendungen in modernen Softwarelösungen.
Die korrekte Gestaltung und Implementierung dieser Architektur ist entscheidend, um Schutzmechanismen gegen potenzielle Sicherheitsbedrohungen zu etablieren.
In diesem Kapitel wird detailliert auf die verschiedenen Aspekte der Software-Architektur des Security-Bausteins eingegangen und bewährte Methoden sowie bewährte Praktiken vorgestellt, um eine robuste und zuverlässige Sicherheitsinfrastruktur zu schaffen.</p>
</div>
<div class="paragraph">
<p>Im Folgenden werden die <a href="#aussensicht-der-komponente-security">Interfaces des Bausteins Security</a> genauer erläutert.</p>
</div>
<div class="sect2">
<h3 id="security-interface"><a class="anchor" href="#security-interface"></a>1.1. Security</h3>
<div class="paragraph">
<p>Das Interface <code>Security</code> stellt die zentrale Schnittstelle bereit, über die auf den Baustein zugegriffen wird.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
Es empfiehlt sich, die Beans direkt zu 'autowiren' und das Interface hauptsächlich für eine Migration vom alten Sicherheitsbaustein <code>isy-sicherheit</code> auf den neuen Baustein <code>isy-security</code> zu verwenden.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Die folgenden Methoden bieten Zugriff auf eine Liste von allen im System hinterlegten Rollen, den Berechtigungsmanager und den optionalen Authentifizierungsmanager:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>Set&lt;String&gt; getAlleRollen()</code></dt>
<dd>
<p>Liefert die Menge aller im System konfigurierten Rollen.</p>
</dd>
<dt class="hdlist1"><code>Berechtigungsmanager getBerechtigungsManager()</code></dt>
<dd>
<p>Stellt eine Referenz auf das <code>Berechtigungsmanager</code> Bean bereit.</p>
</dd>
<dt class="hdlist1"><code>Optional&lt;Authentifizierungsmanager&gt; getAuthentifizierungsManager()</code></dt>
<dd>
<p>Liefert ein <code>Optional</code>, das eine Referenz auf den <code>Authentifizierungsmanager</code> enthält, oder <code>null</code> falls die Anwendung als Resource-Server agiert und kein <code>Authentifizierungsmanager</code> benötigt wird.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="authentifizierungsmanager-interface"><a class="anchor" href="#authentifizierungsmanager-interface"></a>1.2. Authentifizierungsmanager</h3>
<div class="paragraph">
<p>Zur Authentifizierung von OAuth 2.0 Clients stehen folgende Methoden zur Verfügung:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>void authentifiziere(String oauth2ClientRegistrationId)</code></dt>
<dd>
<p>Authentifiziert einen OAuth 2.0 Client anhand seiner Client-Registration-ID. Unterstützt den <code>client_credentials</code> (<em>Client Credentials</em> Flow) und <code>password</code> (<em>Resource Owner Password Credentials</em> Flow) GrantType.
Zusätzliche Authentifizierungsmerkmale werden aus den <a href="#isyfact-specific-client-registration">IsyFact spezifischen Konfigurationsparametern</a> mit der entsprechenden Client-Registration-ID abgefragt:</p>
<div class="ulist">
<ul>
<li>
<p><code>bhknz</code>: Das BHKNZ kann als optionaler Parameter übergeben werden. Wird aktuell nur für den <em>Resource Owner-Password Credentials</em> Flow ausgewertet.</p>
</li>
<li>
<p><code>username</code> und <code>password</code>: Die Zugangsdaten des technischen Nutzers (Resource Owner), welche für den <em>Resource Owner Password Credentials</em> Flow erforderlich sind.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><code>void authentifiziereClient(String issuerLocation, String clientId, String clientSecret)</code></dt>
<dt class="hdlist1"><code>void authentifiziereClient(String issuerLocation, String clientId, String clientSecret, String bhknz)</code></dt>
<dd>
<p>Authentifiziert einen OAuth 2.0 Client gegen die angegebene <code>issuerLocation</code> anhand seiner <code>clientId</code> und <code>clientSecret</code>.
Das <code>bhknz</code> kann als optionaler Parameter übergeben werden, wird aber für die Client-Authentifizierung noch nicht ausgewertet.</p>
</dd>
<dt class="hdlist1"><code>void authentifiziereSystem(String issuerLocation, String clientId, String clientSecret, String username, String password)</code></dt>
<dt class="hdlist1"><code>void authentifiziereSystem(String issuerLocation, String clientId, String clientSecret, String username, String password, String bhknz)</code></dt>
<dd>
<p>Authentifiziert einen technischen Nutzer (Resource Owner) gegen die angegebene <code>issuerLocation</code> anhand der <code>clientId</code> und <code>clientSecret</code> des zu verwendenden OAuth 2.0 Clients und dem <code>username</code> und <code>password</code> des Resource Owners.
Das <code>bhknz</code> kann als optionaler Parameter übergeben werden und wird in den <a href="#isyfact-specific-client-registration">konfigurierten Header</a> zur Zwei-Faktor-Authentifizierung gesetzt.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="berechtigungsmanager"><a class="anchor" href="#berechtigungsmanager"></a>1.3. Berechtigungsmanager</h3>
<div class="paragraph">
<p>Berechtigungsprüfungen können ebenso an beliebiger Stelle im Quellcode erfolgen.
Dazu stellt der Baustein <code>isy-security</code> über die Schnittstelle Berechtigungsmanager entsprechende Funktionen bereit.
Der Berechtigungsmanager ist ein Container für die Rechte und Rollen des aktuell authentifizierten Anwenders.</p>
</div>
<div class="paragraph">
<p>Zur Formulierung von Berechtigungsprüfungen stehen folgende Methoden des Berechtigungsmanagers zur Verfügung:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>Set&lt;String&gt; getRollen()</code></dt>
<dd>
<p>Liefert die Menge aller Rollen des Anwenders.</p>
</dd>
<dt class="hdlist1"><code>Set&lt;String&gt; getRechte()</code></dt>
<dd>
<p>Liefert die Menge aller Rechte des Anwenders.</p>
</dd>
<dt class="hdlist1"><code>boolean hatRecht(String recht)</code></dt>
<dd>
<p>Ermittelt, ob der Anwender ein bestimmtes Recht besitzt.</p>
</dd>
<dt class="hdlist1"><code>void pruefeRecht(String recht)</code></dt>
<dd>
<p>Prüft, ob der Anwender das angegebene Recht besitzt und erzeugt einen Fehler vom Typ <code>AccessDeniedException</code>, wenn das nicht der Fall ist.</p>
</dd>
<dt class="hdlist1"><code>Object getTokenAttribute(String key)</code></dt>
<dd>
<p>Fragt einen Wert im Access Token des Security Contexts ab.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
Primär sollte die Berechtigungsprüfung über die Spring Annotation <code>@Secured</code> und nicht über die hier erwähnte Methode <code>pruefeRecht(String recht)</code> erfolgen.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="aufrufen_von_nachbarsystemen"><a class="anchor" href="#aufrufen_von_nachbarsystemen"></a>2. Aufrufen von Nachbarsystemen</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Der Aufruf von Nachbarsystemen erfolgt auf Basis des reaktiven <code>Spring WebClient</code>.
Um Nachbarsysteme aufzurufen, die auf Basis von <code>OAuth 2.0</code> abgesichert sind, ist grundlegend die Authentifizierung bei einem <code>IAM-Service</code> mit gültiger <code>client_id</code>, <code>client_secret</code> sowie <code>grant_type</code> erforderlich.
Dieser liefert ein Bearer-Token zurück, in dem die Rollen und somit die Zugriffsmöglichkeiten der aufrufenden Anwendung definiert sind.</p>
</div>
<div class="sect2">
<h3 id="maven-dependencies"><a class="anchor" href="#maven-dependencies"></a>2.1. Maven Dependencies</h3>
<div class="paragraph">
<p>Für die Authentifizierung mit einem <code>OAuth 2.0</code>-Client sind die folgenden Abhängigkeiten erforderlich:</p>
</div>
<div id="listing-maven-dep-client-cred" class="listingblock">
<div class="title">Listing 1. Maven Dependencies für Client Credentials</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;de.bund.bva.isyfact&lt;/groupId&gt;
  &lt;artifactId&gt;isy-security&lt;/artifactId&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-oauth2-client&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-webflux&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="konfigurationsparameter"><a class="anchor" href="#konfigurationsparameter"></a>2.2. Konfigurationsparameter</h3>
<div class="paragraph">
<p>Konfigurationsparameter sind essenziell, um Bausteine in technischen Anwendungen anzupassen und zu steuern.
Sie bieten die Möglichkeit, die Funktionalität und das Verhalten eines Bausteins entsprechend spezifischer Anforderungen anzupassen.
In diesem Kapitel werden alle möglichen Optionen der Konfigurationsparameter vorgestellt, um einen umfassenden Überblick über deren Anwendungsmöglichkeiten zu geben.</p>
</div>
<div class="sect3">
<h4 id="spring-oauth2-client-registration"><a class="anchor" href="#spring-oauth2-client-registration"></a>2.2.1. Spring OAuth2 Client Konfigurationsparameter</h4>
<div class="paragraph">
<p>Für die korrekte Anbindung an den <code>IAM-Service</code> ist die Angabe einiger Konfigurationsparameter notwendig, welche in der Konfigurationsdatei der Anwendung eingetragen werden müssen.
Das Präfix sämtlicher Konfigurationsparameter <code>spring.security.oauth2</code> wird zur Vereinfachung in der folgenden Liste weggelassen.</p>
</div>
<table id="table-parameter-client-cred" class="tableblock frame-all grid-all stretch">
<caption class="title">Tabelle 1. Konfigurationsparameter einer Client-Anwendung</caption>
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 15.3846%;">
<col style="width: 61.5385%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Wertebereich</th>
<th class="tableblock halign-left valign-top">Beschreibung</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>client.registration.<em>&lt;registrationId&gt;</em>.client-id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifier der Client-Applikation im Autorisierungsserver.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>client.registration.<em>&lt;registrationId&gt;</em>.client-secret</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secret, das nur der Anwendung und dem Autorisierungsserver bekannt ist.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>client.registration.<em>&lt;registrationId&gt;</em>.authorization-grant-type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Methode, durch welche die Anwendung ein Bearer-Token erhält. Abhängig von dem zu verwendenden Flow auf <code>client_credentials</code> (Client Credentials Flow) oder <code>password</code> (Resource Owner Password Credentials Flow) zu setzen.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>client.registration.<em>&lt;registrationId&gt;</em>.provider</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) ID des zu verwendenden Client-Providers, falls diese nicht mit der Registration-ID übereinstimmt.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>client.provider.<em>&lt;providerId&gt;</em>.issuer-uri</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Der OpenID Connect Issuer Identifier für die Konfiguration des Clients über den Discovery Endpoint, beispielsweise in der Form <code><a href="http://&lt;identity-provider&gt;/auth/realms/&lt;realm&gt" class="bare">http://&lt;identity-provider&gt;/auth/realms/&lt;realm&gt</a>;</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="isyfact-specific-client-registration"><a class="anchor" href="#isyfact-specific-client-registration"></a>2.2.2. Isyfact spezifische Konfigurationsparameter</h4>
<div class="sidebarblock">
<div class="content">
<div class="title"><span class="icon"><i class="fa fa-ban"></i></span> Deprecation</div>
<div class="paragraph">
<p>Dieser Teil der Dokumentation ist veraltet und wird in einem zukünftigen Release entfernt.
Die Inhalte sollten zur Entwicklung neuer Anwendungen nicht mehr berücksichtigt werden.
Stattdessen wird empfohlen, <a href="#client-credential-flow">[client-credential-flow]</a> zu verwenden.</p>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>Anmerkung zur Deprecation</strong></p>
</div>
<div class="paragraph">
<p>Dieser Flow soll gemäß OAuth2.0 Vorgaben nicht mehr verwendet werden und wird in zukünftigen Versionen aus dem OAuth-Standard entfernt.</p>
</div>
<div class="paragraph">
<p>Die folgenden Konfigurationsparameter werden als Übergangslösung für technische Nutzer bereitgestellt.
Der Client-Credentials Flow ist bevorzugt zu nutzen.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Zugangsdaten für technische Nutzer zur Authentifizierung von Tasks und Batches mit dem <em>Resource-Owner-Password-Credential</em> Flow können über die folgenden Parameter konfiguriert werden:</p>
</div>
<table id="table-isyfact-client-registration-extension" class="tableblock frame-all grid-all stretch">
<caption class="title">Tabelle 2. Isyfact spezifische Erweiterung der Spring ClientRegistration</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 13.3333%;">
<col style="width: 13.3333%;">
<col style="width: 53.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Wertebereich</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Beschreibung</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isy.security.oauth2.client.registration.<em>&lt;registrationId&gt;</em>.username</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>null</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Benutzername für Grant-Type <code>password</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isy.security.oauth2.client.registration.<em>&lt;registrationId&gt;</em>.password</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>null</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Benutzerpassword für Grant-Type <code>password</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isy.security.oauth2.client.registration.<em>&lt;registrationId&gt;</em>.bhknz</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>null</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Behördenkennzeichen für Grant-Type <code>password</code>. (optional)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isy.security.oauth2.client.bhknz-header-name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>x-client-cert-bhknz</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Konfigurierbarer Headername für Zwei-Faktor-Authentifizierung.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isy.security.oauth2.client.default-certificate-ou</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>null</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Organisational Unit, die in Verbindung mit bhknz verwendet wird, um den Wert für bhknz-header-name zu bilden.</p>
<p class="tableblock">(Muss gesetzt werden, wenn eine <code>registration</code> mit <code>bhknz</code> konfiguriert ist)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_tokenweitergabe_an_nachbarsysteme"><a class="anchor" href="#_tokenweitergabe_an_nachbarsysteme"></a>2.3. Tokenweitergabe an Nachbarsysteme</h3>
<div class="paragraph">
<p>Für authentifizierte Anwendungen besteht die Möglichkeit der Tokenweitergabe an Nachbarsysteme durch Erweiterung des <code>WebClient</code> um die <code>ServletBearerExchangeFilterFunction</code>.
Diese liest die aktuelle Authentifizierung aus dem SecurityContext und fügt ausgehenden Requests das dort befindliche OAuth 2.0 Token dem Authorization Header hinzu.</p>
</div>
<div id="listing-spring-propagation-webclient-example" class="listingblock">
<div class="title">Listing 2. Konfiguration des Spring WebClient zur Tokenweitergabe</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Configuration
public class ExampleWebClientConfiguration {

  @Bean
  WebClient webClient() {
      ServletBearerExchangeFilterFunction bearer = new ServletBearerExchangeFilterFunction();
      return WebClient.builder()
              .filter(bearer).build();
  }

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_tokenweitergabe_bei_generierten_clients"><a class="anchor" href="#_tokenweitergabe_bei_generierten_clients"></a>2.4. Tokenweitergabe bei generierten Clients</h3>
<div class="paragraph">
<p>Der von Open API Tools generierte <code>ApiClient</code> erlaubt die Initialisierung mit einem Spring <code>WebClient</code> im Konstruktor. Demzufolge kann die oben beschriebene Konfiguration zur Tokenweitergabe analog angewendet werden. Für das folgende Code-Beispiel wird somit unterstellt, dass ein <code>WebClient</code> vorliegt, der die <code>ServletBearerExchangeFunction</code> beinhaltet:</p>
</div>
<div id="listing-openapi-token-propagation-client-example" class="listingblock">
<div class="title">Listing 3. Initialisierung des ApiClient mit WebClient im Konstruktor</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class ExampleClass {
    // ...
    ApiClient apiClient = new ApiClient(webClient);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mögliche_fehler_bei_der_tokenweitergabe"><a class="anchor" href="#_mögliche_fehler_bei_der_tokenweitergabe"></a>2.5. Mögliche Fehler bei der Tokenweitergabe</h3>
<div class="paragraph">
<p>Bei der Tokenweitergabe können verschiedene Fehler auftreten. Im Folgenden werden diesbezüglich die naheliegendsten Fehler beschrieben.</p>
</div>
<div class="sect3">
<h4 id="_ungültigkeit_des_tokens"><a class="anchor" href="#_ungültigkeit_des_tokens"></a>2.5.1. Ungültigkeit des Tokens</h4>
<div class="paragraph">
<p>Wenn das Token im SecurityContext ungültig ist, wird eine <code>InvalidBearerTokenException</code>  geworfen und der Fehlercode <code>401: Unauthorized</code> zurückgegeben. Die Ungültigkeit kann auf verschiedenste Gründe zurückzuführen sein, beispielsweise könnte das Token abgelaufen oder fehlerhaft sein. Eine detaillierte Beschreibung des jeweiligen Fehlers ist unter der <code>Error-URI</code> zu finden:</p>
</div>
<div id="listing-propagation-exception-response-invalid-token" class="listingblock">
<div class="title">Listing 4. Beispielhafte Response bei ungültigem Token</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">HTTP/1.1 401 Unauthorized WWW-Authenticate: Bearer error_code="invalid_token", error_description="Unsupported algorithm of none", error_uri="https://tools.ietf.org/html/rfc6750#section-3.1"</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_kein_token_im_security_context_hinterlegt"><a class="anchor" href="#_kein_token_im_security_context_hinterlegt"></a>2.5.2. Kein Token im Security Context hinterlegt</h4>
<div class="paragraph">
<p>Wenn im SecurityContext kein Token vorliegt, beispielsweise weil die Anwendung nicht authentifiziert ist, hat dies zur Folge, dass der ausgehende Request nicht um Authentifizierungsinformationen im Header ergänzt wird.
Der aufgerufene Server liefert in diesem Fall außer dem Fehlercode <code>401: Unauthorized</code> keine tiefergehenden Fehlerinformationen zurück.</p>
</div>
<div id="listing-propagation-exception-response-no-token" class="listingblock">
<div class="title">Listing 5. Beispielhafte Response ohne Token</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">HTTP/1.1 401 Unauthorized WWW-Authenticate: Bearer realm="example"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="authentifizierungsmanager-authentication"><a class="anchor" href="#authentifizierungsmanager-authentication"></a>2.6. Authentifizierung eines OAuth 2.0 Clients mit dem Authentifizierungsmanager</h3>
<div class="paragraph">
<p>Ein OAuth 2.0 Client kann über den Authentifizierungsmanager authentifiziert werden, welcher entsprechende Methoden zur Verwendung mit und ohne zuvor konfigurierte <code>ClientRegistrations</code> bereitstellt.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Authentifizierung per <code>oauth2ClientRegistrationId</code>.
Die Auswahl des Flows (<em>Client Credentials</em> oder <em>Resource Owner Password Credentials</em>) wird dabei über den <code>authorization-grant-type</code> der vollständig konfigurierten <code>ClientRegistration</code> getroffen (siehe <a href="#listing-client-registrations">Beispiel: Spring Security OAuth 2.0 Client-Registrations</a>).
Diese Methode eignet sich in Anwendungen, wenn die Zugangsdaten für technische Nutzer zur Konfiguration bekannt sind.</p>
</li>
<li>
<p>Authentifizierung per <code>issuerLocation</code>, <code>clientId</code> und <code>clientSecret</code>.
Diese Methode nutzt den <em>Client Credentials</em> Flow und kann verwendet werden, wenn die Zugangsdaten des OAuth 2.0 Clients (<code>clientId</code> und <code>clientSecret</code>) erst zur Laufzeit bekannt sind.
Die <code>issuerLocation</code> verweist auf den OpenID Connect Provider, in dem der für den <em>Client Credentials</em> Flow konfigurierte OAuth 2.0 Client hinterlegt ist und als IAM-Service die Authentifizierung mit den übergebenen <em>Authentifizierungsdaten</em> durchgeführt wird.</p>
</li>
<li>
<p>Authentifizierung per <code>issuerLocation</code>, <code>clientId</code>, <code>clientSecret</code>, <code>username</code> und <code>password</code>.
Diese Methode nutzt den <em>Resource Owner Password Credentials</em> Flow und kann verwendet werden, wenn die Zugangsdaten des technischen Nutzers (<code>username</code> und <code>password</code> des Resource Owners) erst zur Laufzeit bekannt sind.
Die Zugangsdaten des Vermittlers (<code>clientId</code> und <code>clientSecret</code>) werden benötigt, um die Authentifizierungsabfrage selbst zu autorisieren.
Die <code>issuerLocation</code> verweist auf den OpenID Connect Provider, gegen den die Authentifizierung mit dem dort für den <em>Resource Owner Password Credentials</em> Flow konfigurierten OAuth 2.0 Client durchgeführt werden soll.
Die im <a href="#listing-client-registrations">Beispiel: Spring Security OAuth 2.0 Client-Registrations</a> konfigurierten IsyFact-spezifischen ClientRegistration-Properties werden nicht benötigt, da die Zugangsdaten der Methode direkt übergeben werden.</p>
</li>
</ol>
</div>
<div id="listing-client-registrations" class="listingblock">
<div class="title">Listing 6. Beispiel: Spring Security OAuth 2.0 Client-Registrations</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">[...]
spring.security.oauth2.client.provider.testrealm.issuer-uri=http://localhost:9095/auth/realms/testrealm

### Beispiel: ClientRegistration für den Client Credentials Flow
# Spring Security Konfiguration
spring.security.oauth2.client.registration.client1.client-id=client-credentials-client
spring.security.oauth2.client.registration.client1.client-secret=client-credentials-secret
spring.security.oauth2.client.registration.client1.authorization-grant-type=client_credentials
spring.security.oauth2.client.registration.client1.provider=testrealm

### Beispiel: ClientRegistration für den Resource Owner Password Credentials Flow
# Spring Security Konfiguration
spring.security.oauth2.client.registration.client2.client-id=client-credentials-client
spring.security.oauth2.client.registration.client2.client-secret=client-credentials-secret
spring.security.oauth2.client.registration.client2.authorization-grant-type=password
spring.security.oauth2.client.registration.client2.provider=testrealm
# Isyfact spezifische ClientRegistration properties für den Resource Owner Password Credentials Flow
isy.security.oauth2.client.registration.client2.username=testuser
isy.security.oauth2.client.registration.client2.password=testpassword
isy.security.oauth2.client.registration.client2.bhknz=123456
# Organizational Unit zur Verwendung mit bhknz
isy.security.oauth2.client.default-certificate-ou=TESTOU</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="webclient-authentication"><a class="anchor" href="#webclient-authentication"></a>2.7. Automatische Authentifizierung eines WebClient mit Client Credentials</h3>
<div class="paragraph">
<p>Mit dem <code>OAuth 2.0</code>-Grant <code>client_credentials</code> steht eine vereinfachte Zugriffskontrolle für eine Client-Anwendung im Rahmen des <em>Client Credentials</em> Flow zur Verfügung.</p>
</div>
<div class="paragraph">
<p>Spring Security bietet umfassenden Support für <code>OAuth 2.0</code> und unterstützt die Authentifizierung interner Systeme auf Basis des <code>Client Credentials Flow</code>, wobei auf Spring interne Mechanismen zugegriffen wird.</p>
</div>
<div class="paragraph">
<p>Um clientseitig die automatische Konfiguration einer Anwendung zu ermöglichen, werden zunächst die oben aufgeführten Abhängigkeiten eingebunden und eine Client-Registration für den <code>Client Credentials Flow</code> angelegt.
Um im Rahmen des <code>Client Credentials Flows</code> HTTP-Anfragen an einen Ressourcenserver stellen zu können, ist zusätzlich die Konfiguration des reaktiven <code>WebClient</code> erforderlich.
Hierzu wird die Standardimplementierung mit dem Zusatz eines OAuth2-Autorisierungsfilters verwendet.
Die "registrationId" ist hierbei auf die ID der für den <code>Client Credentials Flow</code> konfigurierten Client-Registration zu setzen.</p>
</div>
<div id="listing-spring-webclient-example" class="listingblock">
<div class="title">Listing 7. Spring WebClient Beispiel</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Configuration
public class OAuth2WebClientConfiguration {

    @Bean("webclient")
    WebClient webClient(@Qualifier(ISY_AUTHORIZED_CLIENT_MANAGER_BEAN) OAuth2AuthorizedClientManager authorizedClientManager) {
        ServletOAuth2AuthorizedClientExchangeFilterFunction oauth =
            new ServletOAuth2AuthorizedClientExchangeFilterFunction(authorizedClientManager);
        oauth.setDefaultClientRegistrationId("registrationId");
        return WebClient.builder().filter(oauth).build();
    }

}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="auth_sgw"><a class="anchor" href="#auth_sgw"></a>3. Authentifizierung über das SGW am IAM-Service</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Die Authentifizierung über das Service Gateway (SGW) stellt einen wichtigen Schritt in der Sicherung von Anwendungen dar.
Um diesen Prozess effektiv umzusetzen, empfiehlt sich die Verwendung des neu entwickelten Authentifizierungsmanagers und dessen Methoden.</p>
</div>
<div class="paragraph">
<p>Die Methoden erlauben es technische Nutzer zur Laufzeit mit ihren Zugangsdaten über den IAM-Service zu authentifizieren.
Mit diesem Mechanismus wird sichergestellt, dass nur autorisierte Clients Zugriff auf die Ressourcen erhalten.
Durch die Nutzung dieses speziellen Authentifizierungsmechanismus wird eine robuste und zuverlässige Sicherheitsschicht implementiert, um unautorisierten Zugriff und potenzielle Sicherheitslücken zu verhindern.</p>
</div>
<div class="paragraph">
<p>Weitere Informationen und detaillierte Anleitungen zur Verwendung können im Abschnitt zum <a href="#authentifizierungsmanager-interface">Authentifizierungsmanager</a> gefunden werden.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="absicherung_von_batches_tasks"><a class="anchor" href="#absicherung_von_batches_tasks"></a>4. Absicherung von Batches und Tasks</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Für detaillierte Informationen und Anleitung zur Absicherung von Batches und Tasks wird auf die Dokumentation unter</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../../blaupausen/detailkonzept-komponente-batch/inhalt.html#authentifizierung-und-autorisierung" class="xref page">Authentifizierung und Autorisierung von Batches</a></p>
</li>
<li>
<p>bzw. <a href="../../isy-task/nutzungsvorgaben/inhalt.html#absicherung-von-tasks" class="xref page">Absicherung von Tasks</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>verwiesen. Diese bieten praxisorientierte Richtlinien zur Gewährleistung der Sicherheit von Batches und Tasks.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="absicherung_von_service_schnittstellen"><a class="anchor" href="#absicherung_von_service_schnittstellen"></a>5. Absicherung von Service-Schnittstellen</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Security unterstützt die automatische Absicherung von Endpunkten einer Anwendung und eine feingranulare Autorisierung im Rahmen von <code>OAuth 2.0</code>.</p>
</div>
<div class="sect2">
<h3 id="_maven_dependency"><a class="anchor" href="#_maven_dependency"></a>5.1. Maven Dependency</h3>
<div class="paragraph">
<p>Dazu ist die Einbindung der folgenden Abhängigkeiten notwendig:</p>
</div>
<div id="listing-maven-dep-sst" class="listingblock">
<div class="title">Listing 8. Maven Dependencies für Client Credentials</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;de.bund.bva.isyfact&lt;/groupId&gt;
  &lt;artifactId&gt;isy-security&lt;/artifactId&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
   &lt;artifactId&gt;spring-boot-starter-oauth2-resource-server&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
   &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
   &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="spring-konfiguration"><a class="anchor" href="#spring-konfiguration"></a>5.2. Spring Konfiguration</h3>
<div class="paragraph">
<p>Um eine Anwendung auf Basis von <code>OAuth 2.0</code> und unter Verwendung von JWT-Bearer-Tokens zu sichern, werden die oben aufgeführten Abhängigkeiten eingebunden. Die Verwendung der Abhängigkeit <code>spring-security-oauth2-resource-server</code> führt dazu, dass die anwendungsspezifische <code>SecurityFilterChain</code> um den Filter <code>.oauth2ResourceServer(OAuth2ResourceServerConfigurer::jwt)</code> erweitert wird.
Bietet die Applikation keine <code>SecurityFilterChain</code> an, wird durch Spring Boot automatisch die folgende Konfiguration eingebunden:</p>
</div>
<div id="listing-sst-security-config" class="listingblock">
<div class="title">Listing 9. Beispiel für eine Security Konfiguration zur Absicherung einer Schnittstelle mit Spring Boot</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Configuration
@EnableWebSecurity
public class OAuth2ServerSecurityConfig {

    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http.authorizeHttpRequests(authorize -&gt; authorize.anyRequest().authenticated())
            .oauth2ResourceServer(OAuth2ResourceServerConfigurer::jwt);
        return http.build();
    }

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="konfigurationsparameterservice"><a class="anchor" href="#konfigurationsparameterservice"></a>5.3. Konfigurationsparameter</h3>
<div class="paragraph">
<p>Für die korrekte Anbindung an den <code>IAM-Service</code> ist die Angabe der folgenden Konfigurationsparameter notwendig. Das Präfix sämtlicher Konfigurationsparameter <code>spring.security.oauth2</code> wird zur Vereinfachung in der Liste unten weggelassen.</p>
</div>
<table id="table-parameter-service" class="tableblock frame-all grid-all stretch">
<caption class="title">Tabelle 3. Konfigurationsparameter einer Service-Schnittstelle</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 13.3333%;">
<col style="width: 13.3333%;">
<col style="width: 53.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Wertebereich</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Beschreibung</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>resourceserver.jwt.issuer-uri</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>keiner</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Auto-Konfiguration des IAM-Services zur Validierung des Bearer Tokens, beispielsweise in der Form "http://&lt;identity-provider&gt;/auth/realms/&lt;realm&gt;/protocol/openid-connect/certs"</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Zusätzlich sind folgende Isyfact-spezifischen Konfigurationsparameter notwendig.</p>
</div>
<table id="table-parameter-service-isyfact" class="tableblock frame-all grid-all stretch">
<caption class="title">Tabelle 4. Isyfact-spezifische Konfigurationsparameter einer Service-Schnittstelle</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 13.3333%;">
<col style="width: 13.3333%;">
<col style="width: 53.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Wertebereich</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Beschreibung</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isy.security.rolesClaimName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>roles</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name des Claims im JWT Token der die Rollen enthält</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="konfiguration-von-rollen-und-rechten"><a class="anchor" href="#konfiguration-von-rollen-und-rechten"></a>5.4. Konfiguration von Rollen und Rechten</h3>
<div class="paragraph">
<p>Jede Geschäftsanwendung spezifiziert im Rahmen ihrer Systemspezifikation Rechte und bildet diese auf fachliche und technische Rollen ab.
Bei der technischen Umsetzung müssen alle spezifizierten Rollen und Rechte konfiguriert und korrekt zugeordnet werden.</p>
</div>
<div class="paragraph">
<p>Der Pfad der Datei kann wie folgt angepasst werden:</p>
</div>
<table id="table-pfad-rollen-rechten" class="tableblock frame-all grid-all stretch">
<caption class="title">Tabelle 5. Konfiguration von Rollen und Rechten</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 13.3333%;">
<col style="width: 13.3333%;">
<col style="width: 53.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Wertebereich</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Beschreibung</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isy.security.role-privilege-mapping-file</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Resource</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>classpath:/resources/sicherheit/rollenrechte.xml</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pfad zu der XML-Datei, welche die Rollen-/Berechtigungszuordnungen enthält.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Der Baustein liefert ein <a href="master.html#anhang-rollen-rechte-schema" class="xref page">XML-Schema für den Aufbau der Konfigurationsdatei</a> mit.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
Die Bereitstellung einer Datei mit den erforderlichen Rollen und Rechten erfolgt optional.
Im Falle einer nicht vorhandenen Datei verbleibt die Liste der Rollen und Rechte leer, d. h. eine Absicherung der Anwendung findet nicht statt.
Die Verantwortung zur korrekten Bereitstellung der erforderlichen Rollen und Rechten liegt bei der Anwendung.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Dieser Zusammenhang wird mit einem Beispiel verdeutlicht: Die Geschäftsanwendung X spezifiziert zwei Rechte, <code>DialogA.Aufrufen</code> und <code>DialogB.Aufrufen</code>.
Aus diesen werden zwei fachliche Rollen gebildet:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>FAX_DialogNutzerA</code> darf nur Dialog A aufrufen,</p>
</li>
<li>
<p><code>FAX_DialogNutzerAlle</code> darf Dialog A und Dialog B aufrufen.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Dieses Beispiel führt zu folgender Konfigurationsdatei:</p>
</div>
<div id="listing-rollenrechte" class="listingblock">
<div class="title">Listing 10. Beispielhafte Definition von Rollen und Rechten</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;tns:Anwendung AnwendungsId="GeschäftsanwendungX"
    xmlns:tns="http://www.isyfact.de/RollenRechteSchema"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.isyfact.de/RollenRechteSchema RollenRechteSchema.xsd "&gt;

    &lt;!-- Definition der Rechte --&gt;
    &lt;tns:rechte&gt;
        &lt;tns:rechtId Id="DialogA.Aufrufen" /&gt;
    &lt;/tns:rechte&gt;

    &lt;tns:rechte&gt;
        &lt;tns:rechtId Id="DialogB.Aufrufen" /&gt;
    &lt;/tns:rechte&gt;

    &lt;!-- Definition der Rollen --&gt;
    &lt;tns:rollen RolleId="FAX_DialogNutzerA"&gt;
        &lt;tns:rechtId Id="DialogA.Aufrufen" /&gt;
    &lt;/tns:rollen&gt;

    &lt;tns:rollen RolleId="FAX_DialogNutzerAlle"&gt;
        &lt;tns:rechtId Id="DialogA.Aufrufen" /&gt;
        &lt;tns:rechtId Id="DialogB.Aufrufen"/&gt;
    &lt;/tns:rollen&gt;
&lt;/tns:Anwendung&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="zusammenhang-von-rechten-und-rollen"><a class="anchor" href="#zusammenhang-von-rechten-und-rollen"></a>5.5. Zusammenhang von Rechten und Rollen</h3>
<div class="paragraph">
<p>Innerhalb jeder Rolle werden gemäß Spezifikation die zugeordneten Rechte festgelegt.
Rollen können überlappende Teilmengen von Rechten enthalten.</p>
</div>
<div class="paragraph">
<p>Die Konfiguration muss die folgenden Anforderungen erfüllen:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Es sind alle in der Geschäftsanwendung spezifizierten Rechte definiert.</p>
</li>
<li>
<p>Es sind alle in der Geschäftsanwendung spezifizierten Rollen definiert.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Werden in Überprüfungen Rollen oder Rechte verwendet, die hier nicht definiert sind, wird ein technischer Fehler erzeugt.
Die Konfiguration gibt also verlässlich Auskunft darüber, welche Rollen und Rechte in der Geschäftsanwendung überprüft werden.</p>
</div>
<div class="paragraph">
<p>Der Baustein Security ermöglicht eine Autorisierung nur auf Basis von Rechten, nicht von Rollen.
Jeder Rolle muss also zumindest ein Recht zugeordnet werden, um anhand dessen eine Autorisierung durchführen zu können.
Werden im Lebenszyklus der Geschäftsanwendung weitere Rollen (z.B. für neu hinzukommende Akteure) spezifiziert und mit bestehenden Rechten ausgestattet, sind neben den Änderungen in der Konfigurationsdatei keine weiteren Änderungen notwendig.</p>
</div>
</div>
<div class="sect2">
<h3 id="autorisierung_service_schnittstelle"><a class="anchor" href="#autorisierung_service_schnittstelle"></a>5.6. Autorisierung an einer Service-Schnittstelle</h3>
<div class="paragraph">
<p>Zentral für die Autorisierung ist die von Spring bereitgestellte Annotation <code>@Secured</code>, die alle benötigten Rechte des Aufrufers überprüft.
Eine Autorisierung direkt über die Rollen des Aufrufers ist nicht möglich.</p>
</div>
<div class="paragraph">
<p>Die Annotation kommt in der Service-Schicht zur Anwendung und autorisiert den Zugriff auf eine Service-Methode.
Sollten alle Methoden die gleiche Autorisierung erfordern, kann alternativ die Annotation auch an der Service-Klasse verwendet werden.</p>
</div>
<div class="paragraph">
<p>Folgendes Beispiel (<a href="#listing-absichern-einer-service-methode">Absichern einer Service-Methode</a>) verdeutlicht die Implementierung einer abgesicherten Service-Methode.</p>
</div>
<div id="listing-absichern-einer-service-methode" class="listingblock">
<div class="title">Listing 11. Absichern einer Service-Methode</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Secured({ "PRIV_RechtA", "PRIV_RechtB" })
public void abgesicherteMethode(...) {
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Als Parameter wird ein Array von Rechten übergeben.
Die Rechte sind disjunktiv verknüpft.
Die Autorisierung erfolgt dementsprechend wenn der Nutzer mindestens eins der in der <code>Secured</code> Annotation übergebenen Rechte besitzt.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="attr-token-abfragen"><a class="anchor" href="#attr-token-abfragen"></a>6. Attribute aus dem Bearer Token abfragen</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Bei der Befüllung des Spring Security Context wird das zur Befüllung genutzte Bearer Token ebenfalls im Context abgelegt.
Dadurch ist der Zugriff auf Attribute des Bearer Tokens über den Spring Security Context möglich.
Der Zugriff kann über den Berechtigungsmanager oder direkt über den Spring Security Context erfolgen.</p>
</div>
<div class="paragraph">
<p>Für Zugriff über den Berechtigungsmanager kann die Methode <code>getTokenAttribute(String key)</code> genutzt werden.
Das Beispiel <a href="#listing-berechtigungsmanager-bhknz">Zugriff auf das Behördenkennzeichen</a> veranschaulicht den Zugriff auf das im Attribut <code>bhknz</code> gespeicherte Behördenkennzeichen.</p>
</div>
<div id="listing-berechtigungsmanager-bhknz" class="listingblock">
<div class="title">Listing 12. Zugriff auf das Behördenkennzeichen</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">String bhknz = (String) this.berechtigungsmanager.getTokenAttribute(BEARER_TOKEN_ATTR_BHKNZ);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Für den direkten Zugriff per Security Context kann die <code>Authentication</code> abgefragt und per Cast als ein <code>AbstractOAuth2TokenAuthenticationToken</code> zugegriffen werden.
Detaillierte Informationen hierzu können der Spring Dokumentation entnommen werden.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="annotation-method-auth"><a class="anchor" href="#annotation-method-auth"></a>7. Automatische Authentifizierung innerhalb von Methoden</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Wenn Client Registrations für OAuth 2.0 Clients in der Anwendung angelegt wurden (vgl. <a href="#konfigurationsparameter">Konfigurationsparameter</a>), kann die <code>@Authenticate</code>-Annotation verwendet werden, um anhand dieses Clients automatisch Aufrufe innerhalb der mit der Annotation versehenen Methode zu authentifizieren.
Der dabei verwendete OAuth 2.0 Flow wird anhand der Konfiguration der Client Registration ausgewählt.</p>
</div>
<div class="paragraph">
<p>Dafür muss in der Annotation die Client Registration ID des zu verwendenden OAuth 2.0 Clients angegeben werden.
Dies kann entweder durch Hardcoden der ID oder über die dynamische Auflösung eines Property Placeholders erfolgen.
Die Client Registration ID kann über verschiedene Attribute der Annotation (kein Attribut, <code>value</code>-Attribut, <code>oauth2ClientRegistrationId</code>-Attribut) angegeben werden, welche von der Funktionalität identisch sind.
Die einzige Voraussetzung ist, dass die Client Registration ID in einem dieser Attribute angegeben wurde.</p>
</div>
<div id="annotation-method-auth-example" class="listingblock">
<div class="title">Listing 13. Verwendung der Annotation</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Authenticate("my-auth-client") <i class="conum" data-value="1"></i><b>(1)</b>
void methodThatNeedsAuthentication() {
    ...
}

@Authenticate("${test.auth.client-id}") <i class="conum" data-value="2"></i><b>(2)</b>
void methodThatNeedsAuthentication() {
    ...
}

@Authenticate(oauth2ClientRegistrationId = "my-auth-client") <i class="conum" data-value="3"></i><b>(3)</b>
void methodThatNeedsAuthentication() {
    ...
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Angabe der Client Registration ID ohne Verwendung von Attributnamen</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Auflösung der Client Registration ID aus dem Wert der Property <code>test.auth.client-id</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Angabe der Client Registration ID mit dem Attributnamen <code>oauth2ClientRegistrationId</code></td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testunterstuetzung"><a class="anchor" href="#testunterstuetzung"></a>8. Testunterstützung</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In diesem Abschnitt wird <strong>isy-security-test</strong> beschrieben, das zum Erstellen von (automatisierten) Tests einen OpenId Connect Provider Mock bereitstellt.
Der OpenId Connect Provider Mock wurde mithilfe von WireMock realisiert.
Es werden die folgenden OAuth2 und OpenID Connect Verfahren unterstützt.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Client Credentials Flow</p>
</li>
<li>
<p>Resource Owner Password Credentials Flow</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Das folgende Beispiel zeigt die Initialisierung des EmbeddedOidcProviderMock mit einem Client mit genau einer Rolle und mit einem User mit derselben Rolle:</p>
</div>
<div id="listing-beispiel-oidc-mock" class="listingblock">
<div class="title">Listing 14. Beispiel für die Erstellung des EmbeddedOidcProviderMock</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">EmbeddedOidcProviderMock embeddedOidcProvider = new EmbeddedOidcProviderMock("localhost", 9095, "/auth/realms/testrealm");

embeddedOidcProvider.addClient("client-credentials-client", "supersecretpassword", Collections.singleton("Test_Role"));
embeddedOidcProvider.addUser("ressource-owner-password-credentials-client", "hypersecretpassword", "admin", "adminpassword", Optional.of("123456"), Collections.singleton("Test_Role"));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Detaillierte Informationen zur Verwendung des EmbeddedOidcProviderMock können dem JavaDoc der Klasse entnommen werden.</p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<div class="divFooter"></div>

<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../_/js/isyfact.js"></script>
<script src="../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../_/js/vendor/lunr-languages.js"></script>
<script src="../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../.." data-snippet-length="100" data-stylesheet="../../../../_/css/search.css"></script>
<script async src="../../../../search-index.js"></script>
  </body>
</html>
