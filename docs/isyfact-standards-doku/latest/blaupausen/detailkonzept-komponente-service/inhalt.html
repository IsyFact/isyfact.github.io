<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Detailkonzept Service: Inhalt :: IsyFact Dokumentation</title>
    <link rel="canonical" href="https://github.com/isyfact/isyfact-standards-doku/latest/blaupausen/detailkonzept-komponente-service/inhalt.html">
    <meta name="generator" content="Antora 3.0.1">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <link rel="stylesheet" href="../../../../_/css/font-awesome.min.css">
    <link rel="stylesheet" href="../../../../_/css/isyfact.css">
    <script>var uiRootPath = '../../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://github.com/isyfact">IsyFact Dokumentation</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="isyfact-standards-doku" data-version="2.5-SNAPSHOT">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../einstieg/vorstellung.html">IsyFact Standards</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Einstieg</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../einstieg/vorstellung.html">Vorstellung der IsyFact</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/vorstellung/isyfact-standards.html">IsyFact-Standards</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/vorstellung/isyfact-erweiterungen.html">IsyFact-Erweiterungen</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/vorstellung/rahmenbedingungen.html">Rahmenbedingungen</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/erste-schritte.html">Erste Schritte</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/tutorial/master.html">Tutorial</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/whitepaper/master.html">Whitepaper</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/migrationsleitfaden-if2/master.html">Migrationsleitfaden IsyFact 2</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Blaupausen</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../referenzarchitektur/master.html">Referenzarchitektur</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../referenzarchitektur-it-system/master.html">Referenzarchitektur IT-System</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../detailkonzept-komponente-anwendungskern/master.html">Anwendungskern</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../detailkonzept-komponente-datenzugriff/master.html">Datenzugriff</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="master.html">Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../detailkonzept-komponente-web-gui/master.html">Web GUI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../detailkonzept-komponente-batch/master.html">Batch</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Vorgaben</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../vorgaben-architektur/master.html">Architektur</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../vorgaben-it-sicherheit/master.html">IT-Sicherheit</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Bausteine</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Datum &amp; Zeit</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-datetime/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-datetime/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Fehlerbehandlung</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-exception-core/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-exception-core/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">HttpInvoker</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-serviceapi-core/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-serviceapi-core/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Konfiguration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-konfiguration/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-konfiguration/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Logging</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-logging/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-logging/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Polling</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-polling/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-polling/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">REST</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-service-rest/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-service-rest/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Sicherheit</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sicherheit/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sicherheit/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Sonderzeichen</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sonderzeichen/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sonderzeichen/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Task Scheduling</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-task/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-task/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Ãœberwachung</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-ueberwachung/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-ueberwachung/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Util</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-util/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Methodik</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../methodik/namenskonventionen/master.html">Namenskonventionen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../methodik/versionierung/master.html">Versionierung</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../methodik/java-programmierkonventionen/master.html">Java-Programmierkonventionen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../methodik/diagrammerstellung.html">Diagrammerstellung und Modellierung</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/diagrammerstellung/diagramsnet.html">diagrams.net</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/diagrammerstellung/enterprise-architect.html">Enterprise Architect</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../methodik/vorlagen.html">Vorlagen</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/tailoring/tailoring.html">Tailoring</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/spezifikation/datenflussdiagramme.html">Datenflussdiagramme</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Werkzeuge</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../werkzeuge/einrichtung_entwicklungsumgebung/master.html">Entwicklungsumgebung</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../werkzeuge/versionierungskontrolle/master.html">Versionierungskontrolle</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../werkzeuge/handbuch_dokumentation/master.html">Dokumentation der IsyFact</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../werkzeuge/seitenvorlage.html">Seitenvorlage</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../werkzeuge/kopiervorlage.html">Kopiervorlage fÃ¼r neue Seiten</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../changelog/changelog.html">Changelog</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">IsyFact Standards</span>
    <span class="version">2.5-SNAPSHOT</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../../glossary/latest/glossary/master.html">Glossar</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../glossary/latest/glossary/master.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../../einstieg/vorstellung.html">IsyFact Standards</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../einstieg/vorstellung.html">2.5-SNAPSHOT</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../einstieg/vorstellung.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../einstieg/vorstellung.html">IsyFact Standards</a></li>
    <li><a href="inhalt.html">Detailkonzept Service: Inhalt</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Inhalt" data-levels="3">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Detailkonzept Service: Inhalt</h1>
<div class="sect1">
<h2 id="ueberblick"><a class="anchor" href="#ueberblick"></a>1. Ãœberblick</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Services gliedern sich Ã¼ber eine technische Komponente â€žServiceâ€œ in die T-Architektur von IT-Systemen ein (siehe <a href="#image-IFRefArcITSysServ">Abbildung 1</a>).</p>
</div>
<div id="image-IFRefArcITSysServ" class="imageblock text-center">
<div class="content">
<img src="../_images/detailkonzept-service/IFRefArcITSysServ.png" alt="IFRefArcITSysServ">
</div>
<div class="title">Abbildung 1. Referenzarchitektur eines IT-Systems</div>
</div>
<div class="paragraph">
<p>Diese technische Komponente besteht aus zwei Teilen: dem Service-Framework und der Servicelogik.</p>
</div>
<div class="paragraph">
<p>Das <strong>Service-Framework</strong> bezeichnet die konkrete Technologie, mit der die Services des Anwendungskerns zur VerfÃ¼gung gestellt werden.</p>
</div>
<div class="paragraph">
<p>Die <strong>Servicelogik</strong> enthÃ¤lt Daten und FunktionalitÃ¤t, die fÃ¼r die Bereitstellung des Services relevant sind.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="servicelogik"><a class="anchor" href="#servicelogik"></a>2. Servicelogik</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Die Servicelogik gliedert sich, wie der Anwendungskern, in <strong>Fachkomponenten</strong>.
Die Fachkomponenten setzen im wesentlichen <strong>Service-Schnittstellen</strong> um.
Sie decken vier wesentliche Aufgaben ab.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Transformation</dt>
<dd>
<p>Bei einem Service-Aufruf mÃ¼ssen die Transportobjekte der Service-Schnittstelle in passende Objekte des Anwendungskerns umgewandelt werden.
AuÃŸerdem muss das Ergebnis des Anwendungskerns wieder in ein Transportobjekt der Service-Schnittstelle umgewandelt werden.
Transportobjekte sind Klassen, deren einziger Zweck es ist, Daten zu transportieren.
Sie definieren lediglich eine Datenstruktur.</p>
</dd>
<dt class="hdlist1">Fehlerbehandlung</dt>
<dd>
<p>Ausnahme, die bei der Verarbeitung eines Service-Aufrufs oder im Anwendungskern  auftreten, werden in eine Ausnahme der Service-Schnittstelle umgewandelt.</p>
</dd>
<dt class="hdlist1">Autorisierung</dt>
<dd>
<p>FÃ¼r einen Service-Aufruf muss eine Anwendung Ã¼berprÃ¼fen, ob der Aufrufer autorisiert ist die Service-Operation auszufÃ¼hren.</p>
</dd>
<dt class="hdlist1">Logging</dt>
<dd>
<p>Die Komponente muss die Korrelations-ID in den Logging-Kontext einfÃ¼gen.</p>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Wichtig"></i>
</td>
<td class="content">
Im Normalfall ist der Funktionsumfang der Fachkomponenten viel geringer als der Funktionsumfang der Entsprechungen im Anwendungskern.
Dies liegt darin begrÃ¼ndet, dass die Servicelogik die FunktionalitÃ¤t des Anwendungskerns nutzt, um den Service bereitzustellen, und selbst keinerlei GeschÃ¤ftslogik beinhaltet.
Die Schnittstelle zwischen Fachkomponenten im Service und Anwendungskern ist daher eine interne Schnittstelle.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Die Service-Schnittstellen bestehen aus einer <strong>Service-Fassade</strong> und einer <strong>Exception-Fassade</strong>.</p>
</div>
<div class="sect2">
<h3 id="_service_fassade"><a class="anchor" href="#_service_fassade"></a>2.1. Service-Fassade</h3>
<div class="paragraph">
<p>Die Service-Fassade implementiert die Service-Operationen als Methoden.
Ihre Hauptaufgabe ist die Transformation der Service-Aufrufe in interne Aufrufe des Anwendungskerns sowie die Transformation dessen Antworten in Antworten der Service-Schnittstelle.
Dabei transformiert sie die GeschÃ¤ftsobjekte des Anwendungskerns in Transportobjekte der Service-Schnittstelle und umgekehrt.
Hierzu wird in der Regel ein Bean Mapper verwendet.
In EinzelfÃ¤llen kÃ¶nnen Teile der Transformation auch programmiert werden, sofern der Nutzen daraus den Aufwand nicht Ã¼bersteigt.</p>
</div>
<div class="paragraph">
<p>Die Service-Fassade Ã¼bernimmt auch die Autorisierung des Aufrufs.
Dazu nutzt sie die <a href="../../isy-sicherheit/nutzungsvorgaben/master.html#autorisierung" class="xref page">MÃ¶glichkeiten des Bausteins Sicherheit</a>.
Voraussetzung fÃ¼r die Autorisierung ist die Auswertung des mitgelieferten Aufrufkontextes Ã¼ber die Annotation <code>@StelltAufrufKontextBereit</code> an der Methode oder an der Service-Fassade selbst.
AnschlieÃŸend wird Ã¼ber die Annotation <code>@Gesichert</code> die Berechtigung zum Zugriff auf die Methode anhand der Rechte des Aufrufers geprÃ¼ft.
Alternativ kann die Annotation <code>@Gesichert</code> auch an der Service-Fassade selbst verwendet werden, wenn alle Methoden die gleichen Rechte erfordern.</p>
</div>
</div>
<div class="sect2">
<h3 id="_exception_fassade"><a class="anchor" href="#_exception_fassade"></a>2.2. Exception-Fassade</h3>
<div class="paragraph">
<p>Die Exception-Fassade ist verantwortlich fÃ¼r die Umwandlung der durch den Anwendungskern oder die Service-Fassade geworfenen Exceptions in Exceptions der Service-Schnittstelle.
Dies kann auf mehreren Wegen geschehen.
Je nach gewÃ¤hlter Schnittstellentechnologie werden z.Â B. Annotationen oder eigens dafÃ¼r geschriebene Klassen oder Methoden verwendet.</p>
</div>
<div class="paragraph">
<p>Bevor die Exception-Fassade aufgerufen wird, muss die Korrelations-ID aus dem Aufrufkontext im Logging-Kontext registriert sein.
Dies geschieht durch die Annotation <code>@StelltLoggingKontextBereit</code> an der Methode oder an der Service-Fassade selbst.
Dabei gilt es zu beachten, dass die Annotation standardmÃ¤ÃŸig so konfiguriert ist, dass sie vor den Annotationen ohne Angabe einer PrioritÃ¤t ausgefÃ¼hrt wird, sodass diese immer Zugriff auf die Korrelations-ID haben.
Diese Reihenfolge wird durch EinfÃ¼gen des Orders fÃ¼r den Advisor <code>stelltLoggingKontextBereitAdvisor</code> in der Autokonfiguration <code>IsyServiceApiCoreAutoConfiguration</code> erreicht.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Die weiteren Inhalte zum Aufbau, zur Realisierung und zur Nutzung von Service-Schnittstellen wurden wegen ihrer AbhÃ¤ngigkeit zur konkreten Schnittstellentechnologie HTTP Invoker in den Baustein HTTP Invoker verschoben.
Die Inhalte finden sich in den Dokumenten  <a href="../../isy-serviceapi-core/konzept/master.html#einleitung" class="xref page">Konzept HTTP-Invoker</a> sowie <a href="../../isy-serviceapi-core/nutzungsvorgaben/master.html#einleitung" class="xref page">Nutzungsvorgaben HTTP-Invoker</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="transaktionssteuerung"><a class="anchor" href="#transaktionssteuerung"></a>3. Transaktionssteuerung</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In der Regel geschieht die Transaktionssteuerung im Anwendungskern.
Gibt es allerdings Anforderungen, aus denen heraus die Service-Fassade eine Transaktion Ã¼ber mehrere Aufrufe des Anwendungskerns hinweg bilden muss, so muss diese Transaktion Ã¼ber die Service-Fassade gesteuert werden.
Die Aufgabe fÃ¤llt der Service-Fassade zu, weil es wichtig ist, dass die Fehlerbehandlung auf jeden Fall die Transaktion umschlieÃŸt.
Nur so ist gewÃ¤hrleistet, dass auch Fehler, die beim Commit entstehen, von der Fehlerbehandlung erfasst werden.</p>
</div>
<div class="paragraph">
<p>Die Transaktionssteuerung wird an der jeweiligen Service-Methode angesetzt.
FÃ¼r das obige Beispiel verdeutlicht dies <a href="#listing-service-fassade-tx">Listing 1</a>.</p>
</div>
<div id="listing-service-fassade-tx" class="listingblock">
<div class="title">Listing 1. Transaktionssteuerung in der Service-Fassade</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class BeispielServiceFassade {
    ...
    @StelltAufrufKontextBereit
    @StelltLoggingKontextBereit
    @Gesichert(Rechte.RECHT_ZUGRIFFBEISPIEL)
    @Transactional(rollbackFor = Throwable.class, propagation = Propagation.REQUIRED)
    public BeispielHolenAntwortTo holeBeispiel(
        AufrufKontextTo kontext, BeispielHolenAnfrageTo anfrage)
        throws BeispielException {
        ...
    }
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Eine Sonderstellung nehmen Services ein, die im Fehlerfall keinen Fehler zurÃ¼ckgeben, sondern die Fehler in der Antwortnachricht Ã¼bermitteln.
Der AOP-Transaktionsmanager wird niemals ein Rollback durchfÃ¼hren, da alle Exceptions abgefangen werden, auf die er reagieren kÃ¶nnte.
Um auch in diesem Fall ein Rollback der Transaktion zu erzwingen, ist folgender Aufruf durchzufÃ¼hren:</p>
</div>
<div id="listing-service-fassade-tx-rollback-only" class="listingblock">
<div class="title">Listing 2. Rollback von Transaktionen im Fehlerfall ohne Exceptions</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">TransactionAspectSupport.currentTransactionStatus().setRollbackOnly();</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="versionierung"><a class="anchor" href="#versionierung"></a>4. Versionierung</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Die Notwendigkeit, Services in mehreren Versionen anbieten zu kÃ¶nnen, ist bedingt durch die Vielzahl an Service-Nutzern, die bei Ã„nderung an einem Service nicht alle zeitgleich auf die neue Version eines Service umschalten kÃ¶nnen.
Daher ist es notwendig, dass in einem â€“ mÃ¶glichst klein zu haltenden â€“ Ãœbergangszeitraum mehrere Versionen eines Service parallel betrieben werden kÃ¶nnen.</p>
</div>
<div class="paragraph">
<p>Die Versionierung wird auf der Ebene von Services, nicht Service-Operationen ausgefÃ¼hrt, da diese Ebene von ihrer GranularitÃ¤t zu den Ã¼blichen fachlichen Ã„nderungen passt.</p>
</div>
<div class="paragraph">
<p>Es kann vorkommen, dass in <em>einem</em> Systemrelease neue Versionen von <em>mehreren</em> Services ausgeliefert werden.</p>
</div>
<div class="sect2">
<h3 id="architektur"><a class="anchor" href="#architektur"></a>4.1. Architektur</h3>
<div class="paragraph">
<p>IT-Systeme bieten pro Service-Version eine eigene Service-Schnittstelle an.
Die Services verwenden alle denselben <a href="../../../../glossary/latest/glossary/master.html#glossar-Anwendungskern" class="xref page">Anwendungskerns</a>.
Die fÃ¼r die Versionierung notwendigen Transformationen sind Teil der jeweiligen Service-Schnittstelle (z.B. das EinfÃ¼gen eines Standardwerts fÃ¼r neu hinzugefÃ¼gte Attribute).
In komplexen FÃ¤llen kann es auch notwendig sein, den Anwendungskern zu erweitern und die Versionierung dort zu behandeln.
Die Entscheidung dafÃ¼r ist im Systementwurf zu dokumentieren.</p>
</div>
<div class="paragraph">
<p>Externe Services werden durch Service-Gateways bereitgestellt.
Die Versionierung eines Services muss also auch auf Ebene des Service-Gateways durchgefÃ¼hrt werden.
Ein Service-Gateway ist ein rein technischer Protokoll-Wandler, der Web-Services in interne Schnittstellen konvertiert.
Im Service-Gateway erfolgt daher immer nur ein einfaches Mapping auf die entsprechenden Service-Schnittstellen der angebundenen IT-Systeme.
Der Ausgleich der Versionsunterschiede erfolgt ausschlieÃŸlich im IT-System und nicht im Service-Gateway.
Es ist mÃ¶glich, pro Service-Version ein eigenes Service-Gateway zu erstellen (siehe <a href="#image-archversServ">Abbildung 2</a>).</p>
</div>
<div id="image-archversServ" class="imageblock text-center">
<div class="content">
<img src="../_images/detailkonzept-service/archversServ.png" alt="archversServ" width="60%">
</div>
<div class="title">Abbildung 2. Architektur versionierter Services</div>
</div>
</div>
<div class="sect2">
<h3 id="einfachster-fall-kompatible-erweiterung-eines-services"><a class="anchor" href="#einfachster-fall-kompatible-erweiterung-eines-services"></a>4.2. Einfacher Fall: Kompatible Erweiterung eines Services</h3>
<div class="paragraph">
<p>Ein IT-System stellt einen Service bereit, mit dem Personendaten gemeldet werden kÃ¶nnen.
Parameter dieser Meldung sind Vor- und Nachname sowie das Geburtsdatum.
Dazu gibt es einen Meldung-Service in der Version 1.0. Dieser wird in der Service-Schicht des IT-Systems implementiert.
Ab einem Stichtag soll zusÃ¤tzlich noch das Geschlecht gemeldet werden.
Im bisherigen Datenbestand wird dieses neue Attribut auf den Wert â€žunbekanntâ€œ gesetzt.
Der bestehende Service wird um dieses Attribut erweitert und erhÃ¤lt die Versionsnummer 1.1. Anwendungskern und Datenzugriffsschicht mÃ¼ssen ebenfalls erweitert werden.
Aus GrÃ¼nden der RÃ¼ckwÃ¤rtskompatibilitÃ¤t soll aber weiterhin die Version 1.0 des Service angeboten werden.
Dazu wird ein neuer Service innerhalb der Service-Schicht implementiert, der die Meldung entgegennimmt, das fehlende Attribut mit dem Wert â€žunbekanntâ€œ ergÃ¤nzt und dann den Anwendungskern aufruft.</p>
</div>
<div class="paragraph">
<p>Werden die beiden Services durch ein Service-Gateway nach auÃŸen verfÃ¼gbar gemacht, existieren dort zwei parallele Mappings auf die jeweiligen Services des IT-Systems.
Innerhalb des Service Gateways existiert keine GeschÃ¤ftslogik, d.h. die Abbildung von Version 1.0 auf 1.1 findet erst im IT-System statt.</p>
</div>
</div>
<div class="sect2">
<h3 id="komplexerer-fall-inkompatible-veraenderung-eines-services"><a class="anchor" href="#komplexerer-fall-inkompatible-veraenderung-eines-services"></a>4.3. Komplexerer Fall: Inkompatible VerÃ¤nderung eines Services</h3>
<div class="paragraph">
<p>In einem komplexeren Fall kann es passieren, dass die Service-Schnittstelle einer Anwendung komplett umgestaltet wird, sodass die Aufrufe nicht mehr einfach aufeinander abgebildet werden kÃ¶nnen.
Wird in so einem Fall ein neuer Service eingefÃ¼hrt, wÃ¤hrend der alte Service noch verfÃ¼gbar bleiben muss, mÃ¼ssen die inkompatiblen Verarbeitungslogiken im Anwendungskern parallel erhalten bleiben.
Auch hier enthÃ¤lt das Service-Gateway keine GeschÃ¤ftslogik.</p>
</div>
</div>
<div class="sect2">
<h3 id="_umsetzung"><a class="anchor" href="#_umsetzung"></a>4.4. Umsetzung</h3>
<div class="paragraph">
<p>Die Java-Klassen und -Interfaces eines Services existieren in allen Versionen der Service-Schnittstelle und unterscheiden sich inhaltlich
durch die in der neuen Version durchgefÃ¼hrten Ã„nderungen.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
FÃ¼r die Versionierung von Schnittstellen gelten gesonderte Vorgaben, die in  <a href="../../werkzeuge/versionierungskontrolle/master.html" class="xref page">IsyFact Versionierung</a> definiert sind.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Zur VerÃ¶ffentlichung von API-kompatiblen Ã„nderungen wird im Maven <code>pom.xml</code> eine einstellige Versionsnummer (Minor) gesetzt.
Kompatible Ã„nderungen sind beispielsweise Bugfixes, neue Operationen in der Schnittstelle oder neue, optionale Attribute im Datenmodell.</p>
</div>
<div id="listing-versioning-pom" class="listingblock">
<div class="title">Listing 3. Realisierung der Versionierungsvorgaben fÃ¼r Schnittstellen bei HTTP Invoker</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependencies&gt;
    ...
    &lt;dependency&gt;
        &lt;groupId&gt;${Organisation.DomÃ¤ne.Anwendungsname}&lt;/groupId&gt;
        &lt;artifactId&gt;${Anwendungsname}-${Schnittstellentechnologie}-sst-${Servicename}-v${Major-Version}&lt;/artifactId&gt;
        &lt;version&gt;${Minor-Version}&lt;/version&gt;
    &lt;/dependency&gt;
    ...
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Bei inkompatiblen Ã„nderungen der Schnittstelle wird die zweistellige Versionsnummer angepasst (Major und Minor); diese wird sowohl in der Artefakt-ID als auch in den Paketnamen der Schnittstelle verwendet.
Inkompatible Ã„nderungen der Schnittstelle sind z.Â B. das Entfernen von Attributen oder Operationen oder das HinzufÃ¼gen von Pflichtfeldern.</p>
</div>
<div class="paragraph">
<p>Bei der Implementierung ist zu beachten, dass die Versionsnummer aus dem Package-Namen auch in die Implementierung Ã¼bernommen wird.</p>
</div>
</div>
<div class="sect2">
<h3 id="grenzen"><a class="anchor" href="#grenzen"></a>4.5. Grenzen</h3>
<div class="paragraph">
<p>Eine Versionierung ist nur dann sinnvoll, wenn kleine Ã„nderungen an der Schnittstelle zwischen den Versionen auftreten.
FÃ¼r den Fall, dass sich die Schnittstelle sowohl syntaktisch als auch semantisch grundlegend Ã¤ndert, sollte anstatt einer neuen Version besser eine eigenstÃ¤ndige, neue Schnittstelle entstehen.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="verfuegbarkeit"><a class="anchor" href="#verfuegbarkeit"></a>5. VerfÃ¼gbarkeit</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Die IsyFact berÃ¼cksichtigt die folgenden Anforderungen an die VerfÃ¼gbarkeit von Services in Systemlandschaften.</p>
</div>
<div class="paragraph">
<p><strong>Hohe VerfÃ¼gbarkeit:</strong> Die IT-Systeme der Systemlandschaft mÃ¼ssen eine hohe VerfÃ¼gbarkeit aufweisen.
Die Berechnung der VerfÃ¼gbarkeit einer Anwendung ist komplex.
In die Berechnung flieÃŸen unter anderem betriebliche Aspekte wie HardwareverfÃ¼gbarkeit ein, wÃ¤hrend Wartungsfenster herausgerechnet werden.
Weiter kÃ¶nnte man VerfÃ¼gbarkeit auf der Ebene von angebotenen Services und nicht von IT-Systemen betrachten.
Von der Seite der Software ist zu beachten, dass sich in einer serviceorientierten Systemlandschaft die Ausfallwahrscheinlichkeiten multiplizieren, wenn Systeme einander aufrufen.</p>
</div>
<div class="paragraph">
<p><strong>Schnelles Antwortzeitverhalten im Fehlerfall:</strong> Die NichtverfÃ¼gbarkeit von Services ist ein Ausnahmefall, auf den angemessen reagiert werden muss.
Sollte ein Service nicht verfÃ¼gbar sein, ist es wichtig, dass die aufrufende Anwendung zÃ¼gig eine Fehlermeldung erhÃ¤lt.
Speziell bei Online-Anwendungen ist der schnelle Erhalt einer Fehlermeldung notwendig.
Der Nutzer soll auch im Fehlerfall eine gewohnt schnelle Antwort vom System erhalten.
Die genaue Definition des Zeitrahmens, in dem die Fehlermeldung Ã¼ber die NichtverfÃ¼gbarkeit beim Aufrufer eintreffen muss, ist anwendungsspezifisch.
Die Definition ist dementsprechend durch die jeweiligen Aufrufer vorzunehmen.</p>
</div>
<div class="sect2">
<h3 id="_beispielszenario"><a class="anchor" href="#_beispielszenario"></a>5.1. Beispielszenario</h3>
<div class="paragraph">
<p>FÃ¼r das Szenario gehen wir im Folgenden davon aus, dass ein IT-System eine GesamtverfÃ¼gbarkeit von 98 % aufweisen soll.
Hierbei ist zu beachten, dass IT-Systeme in der Regel andere IT-Systeme und Querschnittsanwendungen aufrufen, um Anfragen zu beantworten.
Die GesamtverfÃ¼gbarkeit sinkt dadurch ab, da zur erfolgreichen Bearbeitung einer Anfrage alle Systeme zeitgleich verfÃ¼gbar sein mÃ¼ssen.
Im Szenario wird fÃ¼r alle Systeme ein Richtwert fÃ¼r die VerfÃ¼gbarkeit von 99,7 % angenommen.
<a href="#table-GMTMT">Tabelle 1</a> zeigt eine Beispielrechnung (die GesamtverfÃ¼gbarkeit ergibt sich aus dem Produkt der EinzelverfÃ¼gbarkeiten).
Durch eine VerfÃ¼gbarkeit von 99,7 % pro System kann im Beispiel also eine GesamtverfÃ¼gbarkeit von Ã¼ber 98 % erreicht werden.</p>
</div>
<div class="paragraph">
<p>Eine Berechnung der GesamtverfÃ¼gbarkeit nach dem Schema von <a href="#table-GMTMT">Tabelle 1</a> muss fÃ¼r jedes IT-System einzeln durchgefÃ¼hrt werden.
Dabei mÃ¼ssen die berechneten oder gemessenen VerfÃ¼gbarkeiten aller IT-Systeme zugrunde gelegt werden, die das IT-System aufruft.</p>
</div>
<table id="table-GMTMT" class="tableblock frame-all grid-all stretch">
<caption class="title">Tabelle 1. Beispielrechnung der VerfÃ¼gbarkeit</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">System</th>
<th class="tableblock halign-left valign-top">VerfÃ¼gbarkeit</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IT-System</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">99,7 %</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Aufgerufenes IT-System 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">99,7 %</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Aufgerufenes IT-System 2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">99,7 %</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Aufgerufene Querschnittsanwendung</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">99,7 %</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Service-Gateway (Infrastruktur)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">99,7 %</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Datenbank (Infrastruktur)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">99,7 %</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GesamtverfÃ¼gbarkeit</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(99,7 %)<sup>6</sup> = <strong>98,21 %</strong></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="ursachen-fuer-nichtverfuegbarkeit"><a class="anchor" href="#ursachen-fuer-nichtverfuegbarkeit"></a>5.2. Ursachen fÃ¼r NichtverfÃ¼gbarkeit</h3>
<div class="paragraph">
<p>Die mÃ¶glichen Ursachen fÃ¼r NichtverfÃ¼gbarkeit sind unter anderem:</p>
</div>
<div id="ausfall-deployment" class="paragraph">
<p><strong>Deployment einer Anwendung:</strong> Bei einem Re-Deployment einer Anwendung kommt es zu einer geplanten Auszeit.</p>
</div>
<div class="paragraph">
<p><strong>Ãœberlastung wÃ¤hrend Lastspitzen:</strong> Im Tagesverlauf variiert die Last, die ein System verarbeiten muss.
Manche Systeme antworten bei Lastspitzen zu langsam.</p>
</div>
<div id="ausfall-von-hw-oder-sw" class="paragraph">
<p><strong>Ausfall von Hard- oder Software:</strong> Auf einem Knoten eines Anwendungsclusters ist eine StÃ¶rung durch einen Hardware- oder Softwareausfall aufgetreten.
Der nicht funktionierende Knoten ist dadurch temporÃ¤r nicht verfÃ¼gbar, wodurch die verbleibenden Knoten die Last des ausgefallenen Knotens mitverarbeiten mÃ¼ssen.</p>
</div>
<div class="paragraph">
<p><strong>Umschaltzeit bei Hard- oder Softwareausfall:</strong> Bei Ausfall von Hard- oder Software sorgt ein Loadbalancer dafÃ¼r, dass alle Anfragen nur an die noch funktionierenden Knoten weitergeleitet werden.
In dem kurzen Zeitraum, bis der Loadbalancer einen Server-Knoten als ausgefallen markiert (â€žUmschaltzeitâ€œ), kommt es jedoch zur NichtverfÃ¼gbarkeit von Services.
In diesem Zeitraum werden Anfragen nicht beantwortet die noch an den ausgefallenen Knoten geleitet werden.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Die Regeln, nach denen der Loadbalancer entscheidet, wann ein Server-Knoten nicht mehr verfÃ¼gbar ist, kÃ¶nnen Ã¼blicherweise konfiguriert werden.
Beispielsweise kann ein Loadbalancer alle paar Sekunden per Script (â€žHealth-Checkâ€œ) Ã¼berprÃ¼fen, ob ein Server-Knoten noch verfÃ¼gbar ist.
Erst nach einer festgelegten Anzahl fehlgeschlagener fachlicher Anfragen und negativem Health-Check leitet dann der Loadbalancer keine Anfragen mehr an diesen Knoten.
UnabhÃ¤ngig von der Konfiguration kann es trotz Loadbalancer und Anwendungscluster zu wenigen nicht beantworteten Anfragen und somit
zu einer NichtverfÃ¼gbarkeit kommen.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>BatchlÃ¤ufe:</strong> Wenn lang laufende Batches in GeschÃ¤ftsanwendungen durchgefÃ¼hrt werden, dÃ¼rfen in dieser Zeit keine Meldungen gemacht werden.
So werden Dateninkonsistenzen vermieden.
Meldungsaufrufe sind in dieser Zeit nicht verfÃ¼gbar und werden von der GeschÃ¤ftsanwendung nicht beantwortet.</p>
</div>
<div id="retries-loadbalancer" class="paragraph">
<p><strong>Retries des Loadbalancers:</strong> Tritt ein Ausfall von Hard- oder Software auf (siehe <em>Ausfall von Hard- oder Software</em> oben), bekommt der Loadbalancer beim Weiterleiten einer Anfrage an einen ausgefallenen Knoten ein Timeout.
Loadbalancer kÃ¶nnen so konfiguriert werden, dass sie in diesem Fall die gleiche Anfrage an einen noch funktionierenden Knoten weiterleiten und nicht sofort eine Fehlermeldung an den Aufrufer zurÃ¼ckgeben.
FÃ¼r den Aufrufer hat der Service dadurch eine lÃ¤ngere Antwortzeit.
Der Aufrufer hat keine MÃ¶glichkeit dieses Timeout/Retry-Verhalten des Loadbalancers zu beeinflussen und auf seine BedÃ¼rfnisse anzupassen.
Die lange Antwortzeit kann aufseiten des Aufrufers leicht zu einem Timeout fÃ¼hren.</p>
</div>
<div class="paragraph">
<p><strong>Verschlimmerung von NichtverfÃ¼gbarkeiten:</strong> Die aufrufende Anwendung reagiert nicht angemessen auf eine NichtverfÃ¼gbarkeit eines Service.
Beispiele:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Der Client versucht Retries, obwohl der Service-Aufruf aus fachlicher Sicht entfallen kÃ¶nnte (optionaler Aufruf).</p>
</li>
<li>
<p>Die fachliche Verarbeitung wird nicht rechtzeitig abgebrochen, obwohl ein verpflichtender Service-Aufruf bereits fehlgeschlagen ist.</p>
</li>
<li>
<p>Die Bearbeitung der Anfrage dauert bekanntermaÃŸen beim Service-Anbieter sehr lange.
Der Aufrufer hat einen sehr knappen Timeout gesetzt und schickt Aufrufwiederholungen.
Dies verschlimmert die Antwortzeiten der Service-Aufrufe und fÃ¼hrt eventuell zu Duplikaten beim Service-Anbieter.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Eine weitere bekannte Ursache fÃ¼r NichtverfÃ¼gbarkeit ist die Umgebungskonfiguration, Firewall-Verbindungen nach einer definierten Zeit automatisch zu schlieÃŸen.
Zustandsbehaftete Verbindungen wie sie bei Datenbank-Clients eingesetzt werden, sind von dieser Restriktion betroffen.
Diese Clients mÃ¼ssen vorsehen, dass Sie eine von der Firewall geschlossene Verbindung erkennen und wieder neu aufbauen.
Dieses Thema wird im entsprechenden Nutzungskonzept <a href="../detailkonzept-komponente-datenzugriff/master.html" class="xref page">Detailkonzept Komponente Datenzugriff</a> behandelt.</p>
</div>
<div class="paragraph">
<p>Die IsyFact setzt als Transportprotokoll fÃ¼r Service-Kommunikation durchgÃ¤ngig HTTP ein.
HTTP ist ein zustandsloses Protokoll und baut bei jeder Anfrage eine neue Verbindung zwischen Client und Server auf.
HTTP 1.1 bietet einen Mechanismus an, mehrere Anfragen Ã¼ber eine TCP-Verbindung zu transportieren.
Wenn eine Schnittstellentechnologie diesen Mechanismus nutzt, mÃ¼ssen die TCP-Verbindungen vor ihrer Verwendung validiert werden.</p>
</div>
</div>
<div class="sect2">
<h3 id="massnahmen"><a class="anchor" href="#massnahmen"></a>5.3. MaÃŸnahmen</h3>
<div class="paragraph">
<p>Folgende MaÃŸnahmen kÃ¶nnen ergriffen werden, um die Anforderungen an die VerfÃ¼gbarkeit zu gewÃ¤hrleisten.</p>
</div>
<div class="sect3">
<h4 id="_anwendungscluster_mit_loadbalancer"><a class="anchor" href="#_anwendungscluster_mit_loadbalancer"></a>5.3.1. Anwendungscluster mit Loadbalancer</h4>
<div class="paragraph">
<p>Die TI-Architektur der IsyFact setzt die hohen VerfÃ¼gbarkeitsanforderungen durch Clustering der Applikations- und Datenbankserver um.
Anwendungen werden redundant auf mehr als einem Server installiert.
Kommt es zu einem <a href="#ausfall-von-hw-oder-sw">Hard- oder Softwareausfall</a> auf einem Server-Knoten, so werden alle Anfragen von einem vorgeschalteten Loadbalancer auf einen anderen Server-Knoten umgeleitet.
Durch die Redundanz wird die VerfÃ¼gbarkeit von Services bei auftretenden Hard- oder SoftwareausfÃ¤llen erhÃ¶ht.
Trotzdem kann es auch hier noch zu NichtverfÃ¼gbarkeit kommen.</p>
</div>
</div>
<div class="sect3">
<h4 id="_knotenweises_deployment"><a class="anchor" href="#_knotenweises_deployment"></a>5.3.2. Knotenweises Deployment</h4>
<div class="paragraph">
<p>Diese MaÃŸnahme hilft bei NichtverfÃ¼gbarkeit aufgrund von <a href="#ausfall-deployment">geplanten Wartungsarbeiten</a>.
Im Clusterbetrieb besteht die MÃ¶glichkeit, diese Knoten fÃ¼r Knoten auszufÃ¼hren.
Bevor das Deployment auf einem Knoten ausgefÃ¼hrt wird, wird dem Loadbalancer mitgeteilt, dass der Knoten nicht mehr verfÃ¼gbar ist.
WÃ¤hrend des Deployments des Knotens verarbeiten die restlichen Knoten alle ankommenden Anfragen.
Nach Abschluss des Deployments des Knotens wird dem Loadbalancer mitgeteilt, dass der Knoten wieder zur VerfÃ¼gung steht.
Dann kann das Deployment des nÃ¤chsten Knotens nach dem gleichen Schema erfolgen.
Dadurch kÃ¶nnen Services im Zeitraum von Wartungsarbeiten voll verfÃ¼gbar gehalten werden.</p>
</div>
</div>
<div class="sect3">
<h4 id="_time_to_live"><a class="anchor" href="#_time_to_live"></a>5.3.3. Time-To-Live</h4>
<div class="paragraph">
<p>Ein Service-Aufruf ist nur fÃ¼r eine bestimmte Zeit gÃ¼ltig.
Diese Zeitspanne wird als Time-To-Live (TTL) bezeichnet.
Der Aufrufer definiert die TTL und legt so fest, wie lange er bei einem Aufruf auf eine Antwort wartet.
Hierdurch wird eine schnelle Antwortzeit gewÃ¤hrleistet.</p>
</div>
</div>
<div class="sect3">
<h4 id="_aufrufwiederholung_retry"><a class="anchor" href="#_aufrufwiederholung_retry"></a>5.3.4. Aufrufwiederholung (Retry)</h4>
<div class="paragraph">
<p>Von <a href="#retries-loadbalancer">Loadbalancern ausgefÃ¼hrte Retries</a> kÃ¶nnen zu einer ErhÃ¶hung der Antwortzeit fÃ¼hren.
Loadbalancer innerhalb der Plattform sind deshalb so zu konfigurieren, dass fehlgeschlagene Anfragen nicht an andere Knoten weitergeleitet werden.
Eine Wiederholung von Aufrufen ist ausschlieÃŸlich vom Aufrufer auszufÃ¼hren.
So kann der Aufrufer je nach Fachlichkeit entscheiden, bei welchen Anfragen Wiederholungen sinnvoll sind.</p>
</div>
<div class="paragraph">
<p>GrundsÃ¤tzlich sind Retries nur mit grÃ¶ÃŸter Vorsicht anzuwenden!
HierfÃ¼r gibt es mehrere GrÃ¼nde:</p>
</div>
<div class="paragraph">
<p>Ruft ein Client einen Service auf und erhÃ¤lt einen technischen Fehler, so kann der Client anhand des technischen Fehlers in der Regel nicht einwandfrei erkennen, ob seine Anfrage nicht doch auf dem Server erfolgreich verarbeitet wurde.
Beispielsweise kann durch einen Netzwerkausfall zwar die Netzwerkverbindung zum Server abgebrochen sein, das hindert den Server aber nicht daran, eine bereits in Verarbeitung befindliche Service-Anfrage weiterzuverarbeiten.
In einem solchen Fall wÃ¼rde ein automatischer Retry dazu fÃ¼hren, dass ein und dieselbe Service-Anfrage zweimal ausgefÃ¼hrt wÃ¼rde.
Dies kann bei nicht-idempotenten Service-Operationen fatale Auswirkungen haben (z.Â B. LÃ¶schen von falschen Daten).</p>
</div>
<div class="paragraph">
<p>Eine automatische Aufrufwiederholung kann im Falle einer echten NichtverfÃ¼gbarkeit zu einer erhÃ¶hten Netzwerklast fÃ¼hren und so die NichtverfÃ¼gbarkeit auch anderer Anwendungen in der Anwendungslandschaft erhÃ¶hen.
Die Situation wird daher durch die Aufrufwiederholung deutlich verschlechtert.</p>
</div>
<div class="paragraph">
<p>Insbesondere bei einem Timeout eines TTL ist jedoch ein Retry mit groÃŸer Vorsicht zu genieÃŸen, da nicht klar ist, ob die Service-Anfrage nicht doch durch den Server bearbeitet wird.
In einem solchen Fall fÃ¼hrt eine Aufrufwiederholung zu einer erhÃ¶hten Last auf dem Server und kann im schlechtesten Fall zu einer echten NichtverfÃ¼gbarkeit des Services bzw. des kompletten Servers fÃ¼hren.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In Anbetracht der potenziellen Probleme der Aufrufwiederholung und der Tatsache, dass eine Aufrufwiederholung nur fÃ¼r idempotente Service-Operationen Ã¼berhaupt zulÃ¤ssig ist, sollte von einer automatischen Aufrufwiederholung als MaÃŸnahme zur ErhÃ¶hung der VerfÃ¼gbarkeit in der Regel abgesehen werden.</p>
</div>
<div class="paragraph">
<p>Ausgenommen davon sind Aufrufe, bei denen nur Daten gelesen werden, wie z.Â B. Suchen im Suchverfahren oder Abfragen von Verzeichnissen wie SchlÃ¼sselverzeichnis, Benutzerverzeichnis oder BehÃ¶rdenverzeichnis.</p>
</div>
<div class="paragraph">
<p>HierfÃ¼r soll grundsÃ¤tzlich eine Aufrufwiederholung durchgefÃ¼hrt werden.
Diese ist sinnvoll Ã¼ber die folgenden Parameter konfigurierbar:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Pause zwischen den Retries,</p>
</li>
<li>
<p>Maximale Anzahl von Retries,</p>
</li>
<li>
<p>Timeout fÃ¼r Anfragen.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Die Parameter sind Bestandteil der betrieblichen Konfiguration (s.  <a href="../../isy-konfiguration/konzept/master.html#einleitung" class="xref page">Konzept Konfiguration</a>).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_deaktivierung_von_services"><a class="anchor" href="#_deaktivierung_von_services"></a>5.3.5. Deaktivierung von Services</h4>
<div class="paragraph">
<p>Aufgrund von WartungsaktivitÃ¤ten oder Batches (z.Â B. einer Datenmigration) in einer Fachanwendung kann es vorkommen, dass der Meldungsservice einer Fachanwendung vorÃ¼bergehend deaktiviert wird.
Andere Services wie z.Â B. eine Auskunft kÃ¶nnen wÃ¤hrend dieser Zeit regulÃ¤r ausgefÃ¼hrt werden.
WÃ¤hrend der Meldungsservice deaktiviert ist, wird dem Aufrufer eine entsprechende Fehlermeldung zurÃ¼ckgesendet.
Da die Anforderung besteht, auch andere Services vorÃ¼bergehend deaktivieren zu kÃ¶nnen, werden generell alle Services deaktivierbar gemacht.</p>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<div class="divFooter"></div>

<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../_/js/isyfact.js"></script>
  </body>
</html>
