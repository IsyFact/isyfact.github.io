<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Nutzungsvorgaben Fehlerbehandlung: Inhalt :: IsyFact Dokumentation</title>
    <link rel="canonical" href="https://github.com/isyfact/isyfact-standards-doku/latest/isy-exception-core/nutzungsvorgaben/inhalt.html">
    <meta name="generator" content="Antora 3.0.1">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <link rel="stylesheet" href="../../../../_/css/font-awesome.min.css">
    <link rel="stylesheet" href="../../../../_/css/isyfact.css">
    <script>var uiRootPath = '../../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://github.com/isyfact">IsyFact Dokumentation</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="isyfact-standards-doku" data-version="2.5-SNAPSHOT">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../einstieg/vorstellung.html">IsyFact Standards</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Einstieg</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../einstieg/vorstellung.html">Vorstellung der IsyFact</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/vorstellung/isyfact-standards.html">IsyFact-Standards</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/vorstellung/isyfact-erweiterungen.html">IsyFact-Erweiterungen</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/vorstellung/rahmenbedingungen.html">Rahmenbedingungen</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/erste-schritte.html">Erste Schritte</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/tutorial/master.html">Tutorial</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/whitepaper/master.html">Whitepaper</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/migrationsleitfaden-if2/master.html">Migrationsleitfaden IsyFact 2</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Blaupausen</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../blaupausen/referenzarchitektur/master.html">Referenzarchitektur</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../blaupausen/referenzarchitektur-it-system/master.html">Referenzarchitektur IT-System</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-anwendungskern/master.html">Anwendungskern</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-datenzugriff/master.html">Datenzugriff</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-service/master.html">Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-web-gui/master.html">Web GUI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-batch/master.html">Batch</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Vorgaben</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/vorgaben-architektur/master.html">Architektur</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/vorgaben-it-sicherheit/master.html">IT-Sicherheit</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Bausteine</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Datum &amp; Zeit</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-datetime/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-datetime/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Fehlerbehandlung</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">HttpInvoker</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-serviceapi-core/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-serviceapi-core/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Konfiguration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-konfiguration/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-konfiguration/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Logging</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-logging/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-logging/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Polling</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-polling/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-polling/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">REST</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-service-rest/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-service-rest/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Sicherheit</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sicherheit/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sicherheit/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Sonderzeichen</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sonderzeichen/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sonderzeichen/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Task Scheduling</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-task/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-task/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Ãœberwachung</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-ueberwachung/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-ueberwachung/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Util</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-util/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Methodik</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../methodik/namenskonventionen/master.html">Namenskonventionen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../methodik/versionierung/master.html">Versionierung</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../methodik/java-programmierkonventionen/master.html">Java-Programmierkonventionen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../methodik/diagrammerstellung.html">Diagrammerstellung und Modellierung</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/diagrammerstellung/diagramsnet.html">diagrams.net</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/diagrammerstellung/enterprise-architect.html">Enterprise Architect</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../methodik/vorlagen.html">Vorlagen</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/tailoring/tailoring.html">Tailoring</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/spezifikation/datenflussdiagramme.html">Datenflussdiagramme</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Werkzeuge</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../werkzeuge/einrichtung_entwicklungsumgebung/master.html">Entwicklungsumgebung</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../werkzeuge/versionierungskontrolle/master.html">Versionierungskontrolle</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../werkzeuge/handbuch_dokumentation/master.html">Dokumentation der IsyFact</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../werkzeuge/seitenvorlage.html">Seitenvorlage</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../werkzeuge/kopiervorlage.html">Kopiervorlage fÃ¼r neue Seiten</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../changelog/changelog.html">Changelog</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">IsyFact Standards</span>
    <span class="version">2.5-SNAPSHOT</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../../glossary/latest/glossary/master.html">Glossar</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../glossary/latest/glossary/master.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../../einstieg/vorstellung.html">IsyFact Standards</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../einstieg/vorstellung.html">2.5-SNAPSHOT</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../einstieg/vorstellung.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../einstieg/vorstellung.html">IsyFact Standards</a></li>
    <li><a href="inhalt.html">Nutzungsvorgaben Fehlerbehandlung: Inhalt</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Inhalt" data-levels="3">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Nutzungsvorgaben Fehlerbehandlung: Inhalt</h1>
<div class="sect1">
<h2 id="implementierung-der-fehlerbehandlung"><a class="anchor" href="#implementierung-der-fehlerbehandlung"></a>1. Implementierung der Fehlerbehandlung</h2>
<div class="sectionbody">
<div class="paragraph">
<p>FÃ¼r die Beschreibung des Konzeptes der Fehlerbehandlung sei auf Dokument <a href="../konzept/master.html" class="xref page">KonzeptFehlerbehandlung</a> verwiesen.</p>
</div>
<div class="sect2">
<h3 id="design-von-fehlerklassen"><a class="anchor" href="#design-von-fehlerklassen"></a>1.1. Design von Fehlerklassen</h3>
<div class="paragraph">
<p>Exceptions werden in erwartete und unerwartete Exceptions unterteilt.
Technisch werden diese beiden Arten in Java als checked (erwartete) bzw. unchecked (unerwartete) Exceptions abgebildet.
Aus Sicht der Anwendung werden Exceptions in fachliche und technische Exceptions unterteilt.</p>
</div>
<div class="paragraph">
<p>Aus der Tatsache, dass fachliche Fehler nie unerwartet sein kÃ¶nnen und behandelt werden mÃ¼ssen, ergibt sich, dass es keine fachlichen unerwarteten Exceptions geben darf.
Technische Fehler sind dagegen nur manchmal sinnvoll behandelbar.
Sie sind somit in der Regel unerwartet.</p>
</div>
<div class="paragraph">
<p>Technische erwartete Exceptions sind einzusetzen, sofern mit einem technischen Fehler zu rechnen ist, welcher sinnvoll behandelt werden kann.</p>
</div>
<div class="paragraph">
<p>Dadurch ergibt sich folgende Exception-Hierarchie:</p>
</div>
<div id="image-004" class="imageblock text-center">
<div class="content">
<img src="../_images/nutzungsvorgaben/fehlerbehandlung004.png" alt="fehlerbehandlung004" width="60%">
</div>
<div class="title">Abbildung 1. Abstrakte Exception Hierarchie</div>
</div>
<div class="paragraph">
<p>GrundsÃ¤tzlich lassen sich also folgende Regeln fÃ¼r die Verwendung festhalten:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Fachliche Exceptions sind immer checked.</p>
</li>
<li>
<p>Behandelbare technische Exceptions sind checked.</p>
</li>
<li>
<p>Nicht behandelbare technische Exceptions sind unchecked.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Neben der oben aufgefÃ¼hrten Hierarchie, in die sich alle Exceptions einteilen lassen, haben alle Exceptions eine gemeinsame Menge an Attributen, siehe <a href="#image-005">Abbildung 2</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Fehlertext, mit der Information was passiert ist.</p>
</li>
<li>
<p>Ausnahme-ID: referenziert den Fehler(-text) und dient als Referenz fÃ¼r die Art des Fehlers.</p>
</li>
<li>
<p>Unique-ID: eineindeutige Nummer in der Anwendungslandschaft und dient als Referenz fÃ¼r die Instanz des Fehlers.
Sie ist eine Referenz auf den aufgetretenen Fehler.</p>
</li>
</ul>
</div>
<div id="image-005" class="imageblock text-center">
<div class="content">
<img src="../_images/nutzungsvorgaben/fehlerbehandlung005.png" alt="fehlerbehandlung005" width="20%">
</div>
<div class="title">Abbildung 2. Attribute von Fehlern</div>
</div>
</div>
<div class="sect2">
<h3 id="erstellen-von-exceptions"><a class="anchor" href="#erstellen-von-exceptions"></a>1.2. Erstellen von Exceptions</h3>
<div class="sect3">
<h4 id="exceptions-des-anwendungskerns"><a class="anchor" href="#exceptions-des-anwendungskerns"></a>1.2.1. Exceptions des Anwendungskerns</h4>
<div class="paragraph">
<p>Aus den Vorgaben zum Design der Fehlerklassen in Abschnitt <a href="#design-von-fehlerklassen">Design von Fehlerklassen</a>, resultiert die folgende Exception-Hierarchie, die beispielhaft Exceptions der Beispiel-Anwendung definiert:</p>
</div>
<div id="image-006" class="imageblock text-center">
<div class="content">
<img src="../_images/nutzungsvorgaben/fehlerbehandlung006.png" alt="fehlerbehandlung006" width="100%">
</div>
<div class="title">Abbildung 3. Exception-Hierarchie innerhalb einer Anwendung</div>
</div>
<div class="paragraph">
<p><a href="#image-006">Abbildung 3</a> zeigt die verschiedenen Hierarchiestufen von Fehlern.
Auf oberster Ebene befinden sich die abstrakten Implementierungen fÃ¼r checked (<code>BaseException</code>) und unchecked (<code>TechnicalRuntimeException</code>) Exceptions.
Diese Oberklassen sind fÃ¼r alle Exceptions innerhalb einer Anwendung zu verwenden.
Diese werden als eigenstÃ¤ndige Bibliothek (<code>isy-exception-core</code>) angeboten und befinden sich im Paket <code>de.bund.bva.isyfact.exception</code>.
Sie verwalten die Ausnahme-ID, generieren eine UUID und laden den Fehlertext.
Die Ausnahme-ID referenziert den Fehler(-text) und unterstÃ¼tzt den Nutzer bzw. den Betrieb beim Erkennen der Fehlerart, da ein bestimmter Fehler immer die gleiche Ausnahme-ID besitzt.
Die generierte UUID ist eine im System eineindeutige Nummer, die beim Erstellen der Exception vergeben wird.
Sie ist, wie die Ausnahme-ID, Teil der Fehlernachricht und dient dazu, einen aufgetretenen Fehler im System eindeutig zu referenzieren.
Tritt nun ein Fehler bei mehreren Nutzern des Systems auf, kann mit Hilfe dieser UUID der Fehler, der bei einem bestimmten Nutzer auftrat, in den Log-Dateien der Anwendung identifiziert werden.</p>
</div>
<div class="paragraph">
<p>Werden in einer Anwendung Exceptions benÃ¶tigt, so mÃ¼ssen zuerst vier eigene abstrakte Oberklassen fÃ¼r die Anwendungs-Exceptions abgeleitet werden.
Hier im Beispiel sind das:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>TerminfindungException</code>: Abstrakte Oberklasse innerhalb einer Anwendung fÃ¼r checked Exceptions</p>
</li>
<li>
<p><code>TerminfindungTechnicalRuntimeException</code>: Abstrakte Oberklasse innerhalb einer Anwendung fÃ¼r unchecked Exceptions</p>
</li>
<li>
<p><code>TerminfindungBusinessException</code>: Kindklasse von <code>TerminfindungException</code> fÃ¼r fachliche Exceptions</p>
</li>
<li>
<p><code>TerminfindungTechnicalException</code>: Kindklasse von <code>TerminfindungException</code> fÃ¼r technische Exceptions</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Die Anwendungsoberklassen besitzen jeweils eine Referenz auf einen anwendungsspezifischen <code>FehlertextProvider</code>.
Dieser wird benÃ¶tigt, um die Fehlertexte zu laden.
Diese vier Exceptions sind ebenfalls abstrakt, da auch diese Exceptions rein zur Unterscheidung der Art der Exception innerhalb der Anwendung dienen.</p>
</div>
<div class="paragraph">
<p>Die letztlich in einer Anwendung eingesetzten Exceptions werden dann von den genannten Klassen <code>TerminfindungBusinessException</code>, <code>TerminfindungTechnicalException</code> und <code>TerminfindungTechnicalRuntimeException</code> abgeleitet.</p>
</div>
<div class="paragraph">
<p>Die gezeigten Basis-Exceptions der <a href="../../../../glossary/latest/literaturextern/inhalt.html#litextern-vorlageanwendung" class="xref page">Vorlageanwendung</a> sind im Paket <code>de.msg.terminfindung.common.exception</code> abgelegt.</p>
</div>
<div class="paragraph">
<p>Eine Anwendung besitzt Exceptions auf zwei Ebenen.
Auf der Anwendungsebene liegen alle Exceptions die querschnittlich, also von mehreren Komponenten, genutzt werden.
Diese Exceptions gehÃ¶ren in das Paket:</p>
</div>
<div class="paragraph">
<p><code>&lt;organisation&gt;.&lt;domÃ¤ne&gt;.&lt;anwendung&gt;.common.exception</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
&lt;organisation&gt; z.B. de.bund.bva
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Die zweite Ebene der Exceptions ist die Komponentenebene.
Hier liegen alle Exceptions die komponentenspezifisch sind, also nur von einer einzigen Komponente genutzt werden.
Diese Exceptions gehÃ¶ren in das Paket:</p>
</div>
<div class="paragraph">
<p><code>&lt;organisation&gt;.&lt;domÃ¤ne&gt;.&lt;anwendung&gt;.core.&lt;komponente&gt;</code></p>
</div>
<div class="paragraph">
<p><strong>Konstruktoren</strong></p>
</div>
<div class="paragraph">
<p>Die abstrakten Exceptions einer Anwendung mÃ¼ssen alle vier Konstruktoren implementieren.
Die letztlich eingesetzten Exceptions implementieren nur die Konstruktoren, die benÃ¶tigt werden.
Eine Beispiel-Implementierung hierfÃ¼r befindet sich in der <a href="../../../../glossary/latest/literaturextern/inhalt.html#litextern-vorlageanwendung" class="xref page">Vorlageanwendung</a>.
Dies ist sinnvoll, um AufwÃ¤nde bei der Erstellung von Exceptions zu sparen, da in diesem Fall lediglich der Konstruktor der Oberklasse aufgerufen werden muss.</p>
</div>
<div class="paragraph">
<p>Beispiel fÃ¼r eine fachliche Exception Hierarchie:</p>
</div>
<div id="image-007" class="imageblock text-center">
<div class="content">
<img src="../_images/nutzungsvorgaben/fehlerbehandlung007.png" alt="fehlerbehandlung007" width="50%">
</div>
<div class="title">Abbildung 4. Beispiel fachliche Exception Hierarchie</div>
</div>
<div class="paragraph">
<p>Das Beispiel in <a href="#image-007">Abbildung 4</a> zeigt eine fachliche Exception der Vorlageanwendung.
Die fachliche Exception <code>TerminfindungNichtGefundenException</code> besitzt in diesem Beispiel nicht alle mÃ¶glichen Konstruktoren.
Dies dient lediglich der Veranschaulichung.
Wie oben erwÃ¤hnt ist es nicht notwendig, immer alle Konstruktoren zu implementieren.
Voraussetzung fÃ¼r das Erstellen dieser Exception sind die Basis-Exceptions der Anwendung (hier <code>TerminfindungException</code> und <code>TerminfindungBusinessException</code>).</p>
</div>
<div class="paragraph">
<p>Die <a href="#table-001">Tabelle 1</a> erlÃ¤utert die Bedeutung der Argumente der Konstruktoren.</p>
</div>
<table id="table-001" class="tableblock frame-all grid-all stretch">
<caption class="title">Tabelle 1. Argumente der Konstruktoren von Exceptions des Anwendungskerns</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Exception</th>
<th class="tableblock halign-left valign-top">String</th>
<th class="tableblock halign-left valign-top">Throwable (optional)</th>
<th class="tableblock halign-left valign-top">String&#8230;&#8203; (optional)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TerminfindungNichtGefundenException</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ausnahme-ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Original-Exception, die gefangen wurde.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String oder String-Array mit Variablenwerten, fÃ¼r Platzhalter in parametrisierten Fehlertexten.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Beispiel fÃ¼r eine technische Runtime-Exception Hierarchie:</p>
</div>
<div id="image-008" class="imageblock text-center">
<div class="content">
<img src="../_images/nutzungsvorgaben/fehlerbehandlung008.png" alt="fehlerbehandlung008" width="45%">
</div>
<div class="title">Abbildung 5. Beispiel technische Runtime-Exception Hierarchie</div>
</div>
<div class="paragraph">
<p>Die <a href="#image-008">Abbildung 5</a> zeigt die technische Runtime-Exception <code>KonfigurationException</code>.
Diese Exception kÃ¶nnte dafÃ¼r verwendet werden, um bei einem Konfigurationsfehler z.B. "Konfigurationsparameter nicht gesetzt" geworfen zu werden.
Die Exception ist eine <code>RuntimeException</code>, da ein solcher Fehler nicht behandelbar wÃ¤re.
Um nun eine solche Klasse zu erstellen, muss zuvor nach obigem Schema (siehe <a href="#image-006">Abbildung 3</a>) die entsprechende Oberklasse erstellt worden sein.</p>
</div>
<div class="paragraph">
<p>Das Beispiel enthÃ¤lt wiederum alle mÃ¶glichen Konstruktoren.
Dies dient jedoch auch hier nur der Veranschaulichung.
Es ist fÃ¼r Exceptions im <a href="../../../../glossary/latest/glossary/master.html#glossar-Anwendungskern" class="xref page">Anwendungskern</a> nicht notwendig, alle Konstruktoren zur VerfÃ¼gung zu stellen.
Eine Beschreibung der Argumente der Konstruktoren befindet sich in <a href="#table-001">Tabelle 1</a>.</p>
</div>
<div class="paragraph">
<p>Die unter <a href="#image-007">Abbildung 4</a> und <a href="#image-008">Abbildung 5</a> dargestellten Konstruktoren sind notwendig, um zu gewÃ¤hrleisten, dass alle Exceptions immer eine Ausnahme-ID besitzen, die den Fehlertext identifiziert, d.h. andere Konstruktoren sind nicht gestattet.</p>
</div>
<div class="paragraph">
<p><strong>Dokumentation</strong></p>
</div>
<div class="paragraph">
<p>Checked Exceptions sind in Methoden-Signaturen zu deklarieren und im JavaDoc-Kommentar mittels <code>@throws</code> zu dokumentieren.
Unchecked Exceptions sind nicht in den Methoden-Signaturen zu deklarieren, aber mittels <code>@throws</code> im JavaDoc-Kommentar zu dokumentieren.</p>
</div>
</div>
<div class="sect3">
<h4 id="werfen-einer-exception"><a class="anchor" href="#werfen-einer-exception"></a>1.2.2. Werfen einer Exception</h4>
<div class="paragraph">
<p>Der folgende Abschnitt beschreibt das Werfen einer technischen checked Exception.
Das Vorgehen wird nur fÃ¼r technische checked Exceptions beschrieben, da das Vorgehen fÃ¼r alle Arten von Exceptions gleich ist.</p>
</div>
<div class="paragraph">
<p>GemÃ¤ÃŸ der Anforderungen aus <a href="../konzept/inhalt.html#anforderungen-an-die-fehlerbehandlung" class="xref page">Anforderungen an die Fehlerbehandlung</a> sollte die Fehlerbehandlung Ã¼bersichtlich sein.
Zur Sicherstellung der Ãœbersichtlichkeit darf die Anzahl der verwendeten Exceptions die Anzahl mÃ¶glicher Behandlungen nicht Ã¼berschreiten.
Es sollte also fÃ¼r jede mÃ¶gliche Fehlerbehandlung auch nur eine Exception geworfen werden.
Sofern sie nicht behandelbar sind, sind hierfÃ¼r technische unchecked Exceptions zu verwenden.
Wenn mehrere Exceptions zur gleichen Fehlerbehandlung fÃ¼hren, macht es keinen Sinn, mehr als eine Exception hierfÃ¼r zu deklarieren.</p>
</div>
<div class="paragraph">
<p>In einer Anwendung gibt es nun unter UmstÃ¤nden aber eine grÃ¶ÃŸere Anzahl an technischen Fehlern, die die Anwendung nie verlassen.
Dies wÃ¼rde zu einer entsprechenden groÃŸen Anzahl an Fehlertexten fÃ¼hren, die nicht mehr verwaltbar wÃ¤re.
Daher muss es in jeder Anwendung eine Ausnahme-ID geben mit einem generischen Fehlertext, der einen Platzhalter besitzt.
Als feste Nummer wird fÃ¼r alle Anwendungen die <code>0001</code> festgelegt.
Ein Aufruf einer solchen Exception mit einem generischen Fehlertext sieht dann wie folgt aus:</p>
</div>
<div id="listing-ExceptionGenerischerFehlertext" class="listingblock">
<div class="title">Listing 1. Erstellen einer Exception mit generischem Fehlertext</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">new MeineTechnischeException(FehlerSchluessel.MSG_ALLGEMEINER_FEHLER, "XYZ");</code></pre>
</div>
</div>
<div class="paragraph">
<p>Die Konstante <code>FehlerSchluessel.MSG_ALLGEMEINER_FEHLER</code> referenziert einen generischen Fehlerstring, welcher einen Platzhalter besitzt:</p>
</div>
<div id="listing-KonstanteGenerischerFehlertext" class="listingblock">
<div class="title">Listing 2. Konstante fÃ¼r den generischen Fehlertext</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/** Generische Exception fÃ¼r alle unbekannten Fehler. */

public static final String MSG_ALLGEMEINER_FEHLER = "TRMIN90001";</code></pre>
</div>
</div>
<div id="listing-GenerischerFehlertext" class="listingblock">
<div class="title">Listing 3. Generischer Fehlertext</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">TRMIN90001 = Es ist ein allgemeiner Fehler im Modul Terminfindung aufgetreten.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Beim Einsatz von Exceptions muss immer eine Konstante zur Referenzierung von Fehlern verwendet werden.
Die Fehlertexte dÃ¼rfen nicht direkt mit dem String referenziert werden (z.Â B. hier <code>TRMIN90001</code>).</p>
</div>
<div class="paragraph">
<p>Beim Aufruf einer Exception wird im einfachsten Fall lediglich eine Ausnahme-ID Ã¼bergeben, welche den Fehlertext identifiziert:</p>
</div>
<div id="listing-UebergabeAusnahmeId" class="listingblock">
<div class="title">Listing 4. Ãœbergabe einer Ausnahme-ID</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">new TerminfindungNichtGefundenException(
    FehlerSchluessel.MSG_TERMINFINDUNG_NICHT_GEFUNDEN);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Der Konstruktor der Exception ruft den Konstruktor der abstrakten Eltern-Klasse auf (hier <code>TerminfindungBusinessException</code>):</p>
</div>
<div id="listing-Konstruktur" class="listingblock">
<div class="title">Listing 5. Konstruktor</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public TerminfindungNichtGefundenException(String ausnahmeID) {
    super(ausnahmeID);
}

protected TerminfindungBusinessException(String ausnahmeID) {
    super(ausnahmeID);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Dieser Konstruktor wiederum ruft den Konstruktor seiner Eltern-Klasse auf (hier <code>TerminfindungException</code>), welcher die oberste Exception-Hierarchie-Stufe einer Anwendung darstellt:</p>
</div>
<div id="listing-ObersterKonstruktur" class="listingblock">
<div class="title">Listing 6. Konstruktor der obersten Exception</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">protected TerminfindungException(String ausnahmeID) {
    super(ausnahmeID, FEHLERTEXT_PROVIDER);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Die weitere Kommunikation bis zur Erstellung des eigentlichen Fehlertextes ist in der <a href="#image-009">Abbildung 6</a> skizziert.</p>
</div>
<div id="image-009" class="imageblock text-center">
<div class="content">
<img src="../_images/nutzungsvorgaben/fehlerbehandlung009.png" alt="fehlerbehandlung009">
</div>
<div class="title">Abbildung 6. Abstrakter Ablauf der Erstellung einer Exception</div>
</div>
<div class="paragraph">
<p>Die <code>TerminfindungException</code> hÃ¤lt eine Referenz zu einem FehlertextProvider (siehe <a href="#fehlertextprovider">Fehlertextprovider</a>), welcher die MÃ¶glichkeit bietet Fehlertexte auszulesen.
Diese Referenz und die Ã¼bergebene <code>Ausnahme-ID</code> werden an den Konstruktor der <code>BaseException</code> Ã¼bergeben, welcher nun den Fehlertext lÃ¤dt.
Hierzu ruft er auf dem <code>FehlertextProvider</code> die <code>getMessage()</code>-Methode auf und bekommt den Fehlertext zurÃ¼ckgeliefert.
Durch einen Aufruf des Konstruktors der Oberklasse <code>Exception</code> wird der Fehlertext gesetzt.</p>
</div>
<div class="paragraph">
<p>Bis dato hat der Text den Aufbau:</p>
</div>
<div class="paragraph">
<p><strong>Fehlertext</strong></p>
</div>
<div class="paragraph">
<p>Die IsyFact-Exception-Klassen Ã¼berschreiben aber die <code>getMessage()</code>-Methoden von <code>Exception</code> und erweitern den Fehlertext bei einem lesenden Zugriff.
Der Fehlertext wird um die Ausnahme-ID und die UUID erweitert.
Dies geschieht Ã¼ber die Klasse <code>FehlertextUtil</code>, damit die Formatierung der Fehlertexte an einer zentralen Stelle gekapselt ist.</p>
</div>
<div class="paragraph">
<p>Der Text hat dann folgenden Aufbau:</p>
</div>
<div id="listing-AufbauFehlertext" class="listingblock">
<div class="title">Listing 7. Aufbau des Fehlertexts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">#AusnahmeId Fehlertext #UUID</code></pre>
</div>
</div>
<div class="paragraph">
<p>Der Fehlertext wird in dieser Form aufbereitet, um sicherzustellen, dass sowohl die Ausnahme-ID als auch die UUID</p>
</div>
<div class="ulist">
<ul>
<li>
<p>beim Loggen der Exception immer in die Log-Datei der Anwendung geschrieben werden, ohne dass eine spezielle Implementierung des Loggings notwendig ist,</p>
</li>
<li>
<p>beim Loggen der Exception durch den Aufrufer einer Schnittstelle immer in die Log-Datei der aufrufenden Anwendung geschrieben werden, ohne dass eine spezielle Implementierung des Loggings notwendig ist und</p>
</li>
<li>
<p>der Anwender, sofern er den Fehlertext angezeigt bekommt, auch immer die Ausnahme-ID und die UUID sieht, um diese gegebenenfalls direkt weitergeben zu kÃ¶nnen.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="exceptions-fuer-anwendungsschnittstellen"><a class="anchor" href="#exceptions-fuer-anwendungsschnittstellen"></a>1.2.3. Exceptions fÃ¼r Anwendungsschnittstellen</h4>
<div class="paragraph">
<p>In den vorhergehenden Kapiteln wurde das Werfen von Fehlern in der Anwendung beschrieben.
In diesem Kapitel geht es um Exceptions, die zur Schnittstelle einer Anwendung gehÃ¶ren und vom Aufrufer verarbeitet werden.
Diese werden in IsyFact als Transport-Exceptions bezeichnet.</p>
</div>
<div class="paragraph">
<p>Neben den Vorgaben zum Design der Fehlerklassen in <a href="#design-von-fehlerklassen">Design von Fehlerklassen</a> gelten fÃ¼r Transport-Exceptions noch weitere Vorgaben, da diese an die Aufrufer weitergereicht werden.</p>
</div>
<div class="paragraph">
<p>FÃ¼r Exceptions an den Anwendungsschnittstellen gelten weitere Vorgaben:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Sie erben immer von <code>BusinessToException</code> oder <code>TechnicalToException</code> und implementieren somit immer <code>Serializable</code>,</p>
</li>
<li>
<p>stellen die Felder Ausnahme-ID, UUID und Fehlernachricht zur VerfÃ¼gung und</p>
</li>
<li>
<p>erben nicht von internen Anwendungsexceptions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Daraus ergibt sich fÃ¼r Transport-Exceptions folgende Hierarchie:</p>
</div>
<div id="image-010" class="imageblock text-center">
<div class="content">
<img src="../_images/nutzungsvorgaben/fehlerbehandlung010.png" alt="fehlerbehandlung010">
</div>
<div class="title">Abbildung 7. Exception Hierarchie fÃ¼r Transport-Exceptions</div>
</div>
<div class="paragraph">
<p>Weiterhin werden fÃ¼r die genannten Technologien, welche fÃ¼r die
Anwendungsschnittstellen verwendet werden, folgende Vorgaben gemacht:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>SOAP</strong> (pro Operation)</p>
<div class="ulist">
<ul>
<li>
<p>Definition von 0..1 technischen Exceptions (gleich fÃ¼r alle Operationen einer Schnittstelle)</p>
</li>
<li>
<p>Definition von 0..n fachlichen Exceptions</p>
</li>
<li>
<p>Ãœbermittlung der Ausnahme-ID</p>
</li>
<li>
<p>Ãœbermittlung der UUID</p>
</li>
<li>
<p>Ãœbermittlung des Fehler-Typs (â€žNameâ€œ der Exception)</p>
</li>
<li>
<p>Ãœbermittlung der Fehlernachricht (kein Stack-Trace)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>REST</strong> (keine Exceptions)</p>
<div class="ulist">
<ul>
<li>
<p>Ãœbermittlung der Ausnahme-ID</p>
</li>
<li>
<p>Ãœbermittlung der UUID</p>
</li>
<li>
<p>Ãœbermittlung von Fehler-Kategorie (technisch/Art des fachlichen Fehlers)</p>
</li>
<li>
<p>Ãœbermittlung von Fehlernachricht (kein Stack-Trace!)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Die Vorgaben fÃ¼r HTTP Invoker sind im <a href="../../isy-serviceapi-core/nutzungsvorgaben/master.html" class="xref page">Nutzungsvorgaben HttpInvoker</a> beschrieben.</p>
</div>
<div class="paragraph">
<p>UnabhÃ¤ngig von der eingesetzten Technologie gelten fÃ¼r die Antworten an das aufrufende Nachbarsystem folgende Anforderungen:</p>
</div>
<div class="paragraph">
<p><strong>Technische Exeptions</strong></p>
</div>
<div class="paragraph">
<p>Technische Exceptions sind mit einer allgemeinen Fehler-Nachricht an das aufrufende Nachbarsystem zurÃ¼ckzugeben.
Zudem muss die Ausnahme-ID und die UUID Ã¼bermittelt werden, damit der Fehler in der aufgerufenen Anwendung gefunden werden kann.
Der tatsÃ¤chliche Fehler wird im Error-Log der aufgerufenden Anwendung gespeichert und muss nachvollziehbar sein, sodass eine Fehlerbehebung mÃ¶glich ist.</p>
</div>
<div class="paragraph">
<p><strong>Fachliche Exceptions</strong></p>
</div>
<div class="paragraph">
<p>Fachliche Exceptions sind mit einer ausfÃ¼hrlichen und fÃ¼r den Fehler spezifischen Fehler-Nachricht an das aufrufende Nachbarsystem zurÃ¼ckzugeben.
Die Fehler-Nachricht muss fÃ¼r den Anwender verstÃ¤ndlich sein und sollte zur LÃ¶sung/Vermeidung des Fehlers beitragen.</p>
</div>
</div>
<div class="sect3">
<h4 id="isyfact-bibliotheken-fuer-fehlerbehandlung"><a class="anchor" href="#isyfact-bibliotheken-fuer-fehlerbehandlung"></a>1.2.4. IsyFact-Bibliotheken fÃ¼r Fehlerbehandlung</h4>
<div class="paragraph">
<p>Die in den vorigen Abschnitten beschriebenen abstrakten Oberklassen, die zur Umsetzung der Exception-Hierarchie notwendig sind, werden Ã¼ber die IsyFact-Bibliotheken <code>isy-exception-core</code> und <code>isy-exception-sst</code> in neue Anwendungen integriert.</p>
</div>
<div class="paragraph">
<p>Dabei enthÃ¤lt die Bibliothek <code>isy-exception-core</code> die notwendigen Klassen fÃ¼r den Anwendungskern, die Bibliothek <code>isy-exception-sst</code> die Klassen fÃ¼r die Schnittstellen (Transport-Exceptions).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="behandlung-von-exceptions"><a class="anchor" href="#behandlung-von-exceptions"></a>1.3. Behandlung von Exceptions</h3>
<div class="paragraph">
<p>Die in <a href="#exceptions-des-anwendungskerns">Exceptions des Anwendungskerns</a> aufgefÃ¼hrten Fehlerarten mÃ¼ssen (irgendwann) behandelt werden.
Der Zeitpunkt hÃ¤ngt von den MÃ¶glichkeiten der Fehlerbehandlung ab, die zum Zeitpunkt des Auftretens des Fehlers existieren.</p>
</div>
<div class="paragraph">
<p>GrundsÃ¤tzlich gilt, dass der Aufrufer alle Fehler behandelt, die er behandeln kann, und alle Ã¼brigen weiterreicht.</p>
</div>
<div class="paragraph">
<p>Die Fehlerbehandlung besitzt folgende AusprÃ¤gungen:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Protokollieren und Ignorieren</p>
</li>
<li>
<p>Protokollieren und Schaden begrenzen, z.B. DB-Verbindung freigeben</p>
</li>
<li>
<p>Protokollieren, Warten und erneut Versuchen</p>
</li>
<li>
<p>Original-Exception weiterwerfen</p>
</li>
<li>
<p>Protokollieren und endgÃ¼ltige Exception erzeugen</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Wann bzw. ob ein Fehler behandelt werden kann, ist im Einzelfall zu entscheiden.
Die ersten vier AusprÃ¤gungen sind MÃ¶glichkeiten innerhalb einer Komponente oder einer Anwendung.
Die Fehlerbehandlung entspricht den gÃ¤ngigen <code>try-catch</code>-BlÃ¶cken mit entsprechender Verarbeitung der Exception, z.Â B. Weiterreichen oder Behandeln und Loggen.
<a href="#listing-Weiterwerfen">Listing 8</a> zeigt das Weiterwerfen der Original-Exception:</p>
</div>
<div id="listing-Weiterwerfen" class="listingblock">
<div class="title">Listing 8. Weiterwerfen der Original-Exception</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">try {
    verwaltung.leseTerminfindung(terminfindungsRefNr);
} catch (TerminfindungNichtGefundenException ex) {
    // Exception kann nicht behandelt werden, also wird sie weitergereicht
    throw ex;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Die letzte Variante ist die endgÃ¼ltige Fehlerbehandlung, die meistens in einer Komponente der Nutzungsschicht geschieht: GUI, Batch oder Service.
Beschreibungen dazu finden sich in den jeweiligen Detailkonzepten oder den Bausteinen zur Umsetzung der Komponenten, d.h. zu GUI- oder Service-Frameworks.</p>
</div>
</div>
<div class="sect2">
<h3 id="fehlertexte-und-deren-einsatz"><a class="anchor" href="#fehlertexte-und-deren-einsatz"></a>1.4. Fehlertexte und deren Einsatz</h3>
<div class="paragraph">
<p>Fehlertexte mÃ¼ssen in <code>ResourceBundles</code> abgelegt werden.
Die Ablage der Fehlertexte wird durch das <a href="../../isy-ueberwachung/konzept/master.html" class="xref page">Konzept Ãœberwachung</a> vorgegeben, das Laden der Dateien wird in Spring durch Holder-Klassen realisiert.</p>
</div>
<div class="paragraph">
<p>Als SchlÃ¼ssel werden die Ausnahme-IDs verwendet.
Diese setzen sich aus fÃ¼nf Buchstaben und fÃ¼nf numerischen Zeichen zusammen:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">[A-Z]\{5}[0-9]\{5}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ausnahme-IDs der GeschÃ¤ftsanwendung â€žABCDEâ€œ kÃ¶nnten dann z.B. wie folgt aussehen: <code>ABCDE10034</code></p>
</div>
<div class="paragraph">
<p>Die Ausnahme-IDs sind in Nummernkreise fÃ¼r die einzelnen Komponenten unterteilt.
Ein Nummernkreis umfasst immer 1000 Nummern, d.Â h. es gibt die Kreise 00xxx bis 99xxx.
Bei der Erstellung einer neuen Anwendung ist in der Spezifikations- bzw.
Konstruktionsphase festzulegen, welche Komponente welchen Nummernkreis verwenden muss.</p>
</div>
<div class="paragraph">
<p>Die Ausnahme-IDs referenzieren immer einen Fehlertext.
Die referenzierten Fehlertexte kÃ¶nnen mit Platzhaltern versehen werden (<code>{1}</code>, <code>{2}</code> etc.), um den Text um kontextbezogene Daten zu erweitern, z.Â B.</p>
</div>
<table class="tableblock frame-none grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Der Konfigurationsparameter {0} enthÃ¤lt ungÃ¼ltigen Wert {1}.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Hierzu wird dem Konstruktor der zugehÃ¶rigen Exception ein String oder String-Array mit den Werten fÃ¼r die Platzhalter Ã¼bergeben (<a href="#listing-UebergabePlatzhalter">Listing 9</a>).</p>
</div>
<div id="listing-UebergabePlatzhalter" class="listingblock">
<div class="title">Listing 9. Ãœbergabe von Werten fÃ¼r Platzhalter</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">new TerminfindungNichtGefundenException(
    VerwaltungFehlerSchluessel.MSG_TERMINFINDUNG_NICHT-GEFUNDEN,
    terminfindungRef.toString());</code></pre>
</div>
</div>
<div class="paragraph">
<p>Die Verwendung der Fehlertexte geschieht Ã¼ber Konstanten der Klassen.
Jede Komponente besitzt eine eigene SchlÃ¼sselklasse, welche die komponentenspezifischen Ausnahme-IDs beinhaltet.
Diese Klasse ist abstrakt, muss dem Namensschema <code>&lt;Komponente&gt;FehlerSchluessel</code> entsprechen und im Paket</p>
</div>
<div class="paragraph">
<p><code>&lt;organisation&gt;.&lt;domÃ¤ne&gt;.&lt;anwendung&gt;.core.&lt;komponente&gt;.konstanten</code></p>
</div>
<div class="paragraph">
<p>abgelegt werden.
Die Klasse erbt auÃŸerdem noch von der SchlÃ¼sselklasse fÃ¼r die gesamte Anwendung, um Zugriff auf allgemeine Ausnahme-IDs, wie z.Â B. Datenbank-Fehler zu haben, da diese in der Anwendungsklasse spezifiziert sind und fÃ¼r alle Komponenten gleich sind.
Die Anwendungsklasse ist im Paket</p>
</div>
<div class="paragraph">
<p><code>&lt;organisation&gt;.&lt;domÃ¤ne&gt;.&lt;anwendung&gt;.common.konstanten</code></p>
</div>
<div class="paragraph">
<p>abzulegen und muss in jeder Anwendung <code>FehlerSchluessel</code> heiÃŸen.</p>
</div>
<div class="paragraph">
<p>Kommen neue Fehlertexte hinzu, so mÃ¼ssen die SchlÃ¼ssel in einer der oben genannten Klassen als Konstanten hinzugefÃ¼gt werden.
Ausnahme-IDs fÃ¼r allgemeine Fehler mÃ¼ssen in die Anwendungsklasse, komponentenspezifische in die Komponentenklasse.
Wie in <a href="#listing-FehlerSchluessel">Listing 10</a> gezeigt, mÃ¼ssen die Konstanten einen sprechenden Namen tragen und z.B. immer mit <code>MSG_</code> beginnen.</p>
</div>
<div id="listing-FehlerSchluessel" class="listingblock">
<div class="title">Listing 10. FehlerschlÃ¼ssel</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/** Die im Parameter {0} Ã¼bergebene Liste ist leer. */
public static final String MSG_LISTE_LEER = "TRMIN90004";</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="fehlertextprovider"><a class="anchor" href="#fehlertextprovider"></a>1.4.1. Fehlertextprovider</h4>
<div class="paragraph">
<p>Das Auslesen von Fehlertexten wird durch einen <code>FehlertextProvider</code> implementiert.
Dieser <code>FehlertextProvider</code> ist pro Anwendung zu implementieren und befindet sich im Paket:</p>
</div>
<div class="paragraph">
<p><code>&lt;organisation&gt;.&lt;domÃ¤ne&gt;.&lt;anwendung&gt;.common.exception</code></p>
</div>
<div class="paragraph">
<p>Zu implementieren sind die zwei <code>getMessage()</code>-Methoden des Interfaces <code>FehlertextProvider</code> aus der Bbliothek <code>isy-exception-core</code>, siehe <a href="#image-014">Abbildung 8</a>.</p>
</div>
<div id="image-014" class="imageblock text-center">
<div class="content">
<img src="../_images/nutzungsvorgaben/fehlerbehandlung014.png" alt="fehlerbehandlung014" width="40%">
</div>
<div class="title">Abbildung 8. Fehlertextprovider</div>
</div>
<div class="paragraph">
<p>Die Implementierung muss Spring-Mechanismen verwenden, um die Fehlertexte aus einem <code>ResourceBundle</code> auszulesen.
Dies fÃ¼hrt zu einer Vereinheitlichung der Fehlerbehandlung, da sich das Laden von Fehlertexten in den einzelnen Anwendungen nicht unterscheidet.
Eine Beispiel-Implementierung hierfÃ¼r befindet sich in der <a href="../../../../glossary/latest/literaturextern/inhalt.html#litextern-vorlageanwendung" class="xref page">Vorlageanwendung</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dos-und-donts"><a class="anchor" href="#dos-und-donts"></a>2. DO&#8217;s und DON&#8217;Ts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Im Folgenden werden Vorgaben gemacht, wie Fehler behandelt werden mÃ¼ssen und wie Fehler nicht behandelt werden dÃ¼rfen.</p>
</div>
<div class="sect2">
<h3 id="dos"><a class="anchor" href="#dos"></a>2.1. DO&#8217;s</h3>
<div class="paragraph">
<p><strong>Log it or throw it</strong><br>
Exceptions sind in der Regel zu behandeln und zu loggen.
Ist es nicht mÃ¶glich die Exception zu behandeln, muss sie an den Aufrufer weitergegeben werden.
Die Exception wird im Fall eines Weiterwerfens nicht geloggt.
Details zum Logging befinden sich im <a href="../../isy-logging/konzept/master.html" class="xref page">Konzept Logging</a>.</p>
</div>
<div class="paragraph">
<p><strong>Nur vorkommende Exceptions verwenden</strong><br>
Nur Exceptions in Methodensignaturen verwenden, die auch vorkommen kÃ¶nnen.
Dies fÃ¼hrt sonst zu leeren <code>catch</code>-BlÃ¶cken oder der Behandlung aller Fehler Ã¼ber das Fangen einer globalen Exception.</p>
</div>
<div class="paragraph">
<p><strong>Rollback durch Besitzer der Transaktionsklammer</strong><br>
Das Rollback geschieht durch die Schnittstelle, den Dialog oder den Batch, welcher die Transaktionsklammer bildet.</p>
</div>
<div class="paragraph">
<p><strong>AufrÃ¤umen</strong><br>
Bei der Behandlung von Fehlern ist ein geordneter Systemzustand herzustellen, z.Â B. das SchlieÃŸen der Datenbankverbindung Ã¼ber einen <code>finally</code>-Block.</p>
</div>
<div class="paragraph">
<p><strong>Throw Early / Failing fast</strong><br>
Fehler sollten frÃ¼h erkannt werden und zu entsprechenden Ausnahmen fÃ¼hren, bevor sich der Aufruf in tieferen Schichten befindet.
Beispiel: Ãœbergibt man <code>null</code> an <code>FileInputStream</code> wird eine <code>NullPointerException</code> in <code>java.io</code> geworfen.
Passender wÃ¤re es aber gleich in der Methode, die <code>FileInputStream</code> verwendet auf <code>null</code> zu prÃ¼fen und eine <code>Exception</code> zu werfen.</p>
</div>
</div>
<div class="sect2">
<h3 id="donts"><a class="anchor" href="#donts"></a>2.2. DON&#8217;Ts</h3>
<div class="paragraph">
<p>Neben den oben genannten Punkten, wie man Exceptions richtig verwendet, gibt es auch eine Liste von Anti-Patterns, die bei der Verwendung von Exceptions zu Problemen fÃ¼hren und daher vermieden werden sollten:</p>
</div>
<div class="paragraph">
<p><strong>Interne Exceptions in der Schnittstelle</strong><br>
Interne Exceptions dÃ¼rfen in der Schnittstelle nicht vorkommen, da diese ansonsten dem Aufrufer bekannt sein mÃ¼ssen.
Dies wÃ¼rde zu einer engeren Kopplung von Aufrufer und Aufgerufenem fÃ¼hren und dem Komponentengeheimnis widersprechen.</p>
</div>
<div class="paragraph">
<p><strong>Flusssteuerung Ã¼ber Exceptions</strong><br>
Catch-BlÃ¶cke dienen der Fehlerbehandlung und dÃ¼rfen nicht als <code>else</code>-Zweig genutzt werden.</p>
</div>
<div id="listing-FlusssteuerungExceptions" class="listingblock">
<div class="title">Listing 11. DON&#8217;T: Flusssteuerung Ã¼ber Exceptions</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">try {
    obj = mgr.getObject(id);
} catch (NotFoundException e) {
    obj = mgr.createObject(id);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ebenso sind GoTos Ã¼ber <code>catch</code>/<code>throw</code>-Konstrukte zu vermeiden.</p>
</div>
<div id="listing-FlusssteuerungExceptions2" class="listingblock">
<div class="title">Listing 12. DON&#8217;T: GoTo Ã¼ber catch/throw</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public void useExceptionsForFlowControl() {
try {
    while(true) {
        increaseCount();
    }
} catch (MaximumCountReachedException ex) {}
   //weitere Verarbeitung
}

public void increaseCount() throws MaximumCountReachedException {
    if (count &gt;= 5000) throw new MaximumCountReachedException();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Leere catch-BlÃ¶cke</strong><br>
Wenn dies der Fall ist, dann ist die Exception unnÃ¶tig oder die Ausnahme muss behandelt werden.
Siehe auch <a href="#isyfact-bibliotheken-fuer-fehlerbehandlung">IsyFact-Bibliotheken fÃ¼r Fehlerbehandlung</a>.</p>
</div>
<div id="listing-LeererCatchBlock2" class="listingblock">
<div class="title">Listing 13. DON&#8217;T: Leerer catch-Block</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">try {
    myMethod();
} catch (MyException me) {}
//weitere Verarbeitung</code></pre>
</div>
</div>
<div class="paragraph">
<p>In AusnahmefÃ¤llen, (z.Â B. <code>InterruptedException</code>) kann ein leerer <code>catch</code>-Block durchaus sinnvoll sein.
In diesem Fall ist ein entsprechender Kommentar im <code>catch</code>-Block zu hinterlegen, warum die Exception nicht behandelt wird.</p>
</div>
<div class="paragraph">
<p><strong>Destruktives Wrappen</strong><br>
Das destruktive Wrappen einer Exception zerstÃ¶rt den StackTrace und ist nur fÃ¼r Exceptions an den AuÃŸen-Schnittstellen sinnvoll.
Destruktiv gewrappte Exceptions sind in jedem Fall vor dem Wrappen zu loggen.</p>
</div>
<div id="listing-DestruktivesWrappen" class="listingblock">
<div class="title">Listing 14. DON&#8217;T: Destruktives Wrappen</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">catch (NoSuchMethodException e) {
    throw new MyServiceException("Fehlernachricht: " + e.getMessage());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Catch Exception</strong><br>
Global die Elternklasse einer Exception zu fangen ist zu unspezifisch.
Dadurch entfÃ¤llt die MÃ¶glichkeit, auf verschiedene Ausnahmen unterschiedlich reagieren zu kÃ¶nnen.</p>
</div>
<div id="listing-CatchException" class="listingblock">
<div class="title">Listing 15. DON&#8217;T: Elternklasse einer Exception fangen</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">try {
    foo();
} catch (Exception e) {
    LOG.error("Foo failed", e);
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Wenn so etwas sinnvoll ist, dann ist die Signatur der aufgerufenen Methode zu Ã¼berdenken.
Ist es nicht mÃ¶glich die Exceptions der Methode (<code>foo()</code>) unterschiedlich zu behandeln, so ist die Methode auf sinnvoll behandelbare Exceptions einzuschrÃ¤nken.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Exception Flut</strong><br>
Nur Exceptions werfen, die auch sinnvoll zu behandeln sind.</p>
</div>
<div id="listing-ExceptionFlut" class="listingblock">
<div class="title">Listing 16. DON&#8217;T: Exception Flut</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public void zuViel() throws
    MeineException,
    NeAndereException,
    AuchNeAndereException,
    NochNeAndereException {
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Throw Exception</strong><br>
Es sollten aussagekrÃ¤ftige Exceptions verwendet werden, um dem Aufrufer eine adÃ¤quate Fehlerbehandlung zu ermÃ¶glichen.</p>
</div>
<div id="listing-ThrowException" class="listingblock">
<div class="title">Listing 17. DON&#8217;T: Throw Exception</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public void eineMethode() throws Exception {
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Log and throw</strong><br>
Das Loggen und Weiterwerfen von Exceptions fÃ¼hrt zu unbrauchbaren Log-Dateien.
Tritt eine Exception in einer tiefen Aufrufhierarchie auf, wird ein und dieselbe Exception mehrmals in einer Log-Dateien gespeichert.
Dies behindert bei der Fehlersuche.
Daher gilt die Regel aus <a href="#dos">DO&#8217;s</a> (<em>Log it or throw it</em>), d.Â h. entweder man behandelt und loggt die Exception oder man reicht sie weiter.</p>
</div>
<div id="listing-LogAndThrow" class="listingblock">
<div class="title">Listing 18. DON&#8217;T: Log and throw</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">catch (NoSuchMethodException e) {
    LOG.error("Foo", e); throw e;
}

catch (NoSuchMethodException e) {
    LOG.error("Blah", e);
    throw new MyServiceException("Foo", e);
}

catch (NoSuchMethodException e) {
    e.printStackTrace();
    throw new MyServiceException("Foo", e);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Log and return null / Catch and Ignore</strong><br>
Das Ignorieren von Fehlern ist zu vermeiden, da der Aufrufer sonst keinen Fehler bemerkt, den man unter UmstÃ¤nden in der weiteren Verarbeitung berÃ¼cksichtigen mÃ¼sste.</p>
</div>
<div id="listing-LogAndReturnNull" class="listingblock">
<div class="title">Listing 19. DON&#8217;T: Log and return null / Catch and Ignore</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">catch (NoSuchMethodException e) { return null; }

catch (NoSuchMethodException e) { LOG.error("Foo", e); return null; }</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
Exceptions sollten weitergereicht werden, auÃŸer es handelt sich nicht um eine Ausnahme, z.Â B. <code>return null</code> fÃ¼r den Fall, dass nichts gefunden wurde.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>throw im finally-Block</strong><br>
Exceptions in <code>finally</code>-BlÃ¶cken fÃ¼hren zu einem Verlust des Original-Fehlers:</p>
</div>
<div id="listing-ThrowInFinally" class="listingblock">
<div class="title">Listing 20. DON&#8217;T: throw im finally-Block</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">try { myMethod(); } finally { cleanUp(); }</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
<div class="literalblock">
<div class="content">
<pre> Wirft `cleanUp()` eine Exception, ist die original Exception von `myMethod()` verloren.
Es ist somit nicht gestattet in `finally`-BlÃ¶cken Methoden aufzurufen, welche potentiell Exceptions werfen.</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Nicht unterstÃ¼tzte Methode gibt null zurÃ¼ck</strong><br>
Null als RÃ¼ckgabewert einer Methode, sofern sie nicht unterstÃ¼tzt wird, deckt sich mit dem oben aufgefÃ¼hrten Punkt "Catch and Ignore".
Der Aufrufer hat in diesem Fall nicht mitbekommen, dass die Methode eigentlich gar nicht unterstÃ¼tzt wird.
Im einfachsten Fall tritt eine <code>NullPointerException</code> auf, welche aber nicht den eigentlichen Fehlergrund widerspiegelt.</p>
</div>
<div id="listing-ThrowNotSupported" class="listingblock">
<div class="title">Listing 21. DON&#8217;T: Nicht unterstÃ¼tzte Methode gibt null zurÃ¼ck</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public String myMethod() { // Nicht unterstÃ¼tzt.
    return null;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In diesem Fall sollte eine entsprechende <code>UnsupportedOperationException</code> geworfen werden:</p>
</div>
<div id="listing-ThrowUnsupported" class="listingblock">
<div class="title">Listing 22. DO: Nicht unterstÃ¼tzte Methode wirft UnsupportedOperationException</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public String myMethod() { // Nicht unterstÃ¼tzt.
    throw new UnsupportedOperationException();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Sich auf getCause() verlassen</strong><br>
Dies fÃ¼hrt zu Problemen bei gewrappten Exceptions (<code>getCause().getCause()</code> notwendig).
Exceptions sollten zu einer eindeutigen Behandlung fÃ¼hren.
Das Code-Fragment in <a href="#listing-GetCause">Listing 23</a> unterscheidet die Fehlerbehandlung anhand des Grundes der gefangenen Exception.</p>
</div>
<div id="listing-GetCause" class="listingblock">
<div class="title">Listing 23. DON&#8217;T: Sich auf getCause() verlassen</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">catch (MyException e) {if (e.getCause() instanceof FooException) {</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Dies funktioniert nur, sofern eine Exception nicht mehrmals gewrappt wurde.
Es dÃ¼rfen nur die fÃ¼r die Schnittstelle spezifizierten Exceptions behandelt werden.
Ist auf der Aufruferseite eine Auswertung mittels <code>getCause()</code> notwendig, so ist die Schnittstelle zu Ã¼berarbeiten.
Der Grund hierfÃ¼r ist die Anforderung des Aufrufers an die Schnittstelle, die Fehler genauer unterscheiden und unterschiedlich behandeln zu kÃ¶nnen.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Technische checked Exceptions zur Schnittstelle durchreichen</strong><br>
Technische checked Exceptions sind zu verwenden, um den Aufrufer zur Fehlerbehandlung zu zwingen.
Der Aufrufer muss den Fehler behandeln und nicht in eine technische unchecked Exception wrappen.
In EinzelfÃ¤llen mag dies notwendig sein, muss dann aber mit dem Chefarchitekt abgestimmt werden.</p>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<div class="divFooter"></div>

<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../_/js/isyfact.js"></script>
  </body>
</html>
