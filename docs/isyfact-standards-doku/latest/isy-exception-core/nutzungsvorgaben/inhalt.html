<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Nutzungsvorgaben Fehlerbehandlung: Inhalt :: IsyFact Dokumentation</title>
    <link rel="canonical" href="https://isyfact.github.io/isyfact-standards-doku/latest/isy-exception-core/nutzungsvorgaben/inhalt.html">
    <meta name="generator" content="Antora 3.0.1">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <link rel="stylesheet" href="../../../../_/css/font-awesome.min.css">
    <link rel="stylesheet" href="../../../../_/css/isyfact.css">
    <script>var uiRootPath = '../../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://isyfact.github.io">IsyFact Dokumentation</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="isyfact-standards-doku" data-version="2.5.0-SNAPSHOT">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../einstieg/einstieg.html">IsyFact Standards</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../einstieg/einstieg.html">Einstieg</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../einstieg/vorstellung.html">Vorstellung der IsyFact</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/vorstellung/isyfact-standards.html">IsyFact-Standards</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/vorstellung/isyfact-erweiterungen.html">IsyFact-Erweiterungen</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/vorstellung/rahmenbedingungen.html">Rahmenbedingungen</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/erste-schritte.html">Erste Schritte</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/produkte.html">Eingesetzte Produkte</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/tutorial/master.html">Tutorial</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/whitepaper.html">Whitepaper</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/migrationsleitfaden-if2/master.html">Migrationsleitfaden IsyFact 2</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../blaupausen/blaupausen.html">Blaupausen</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../blaupausen/referenzarchitektur/master.html">Referenzarchitektur</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../blaupausen/referenzarchitektur-it-system/master.html">Referenzarchitektur IT-System</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-anwendungskern/master.html">Anwendungskern</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-datenzugriff/master.html">Datenzugriff</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-service/master.html">Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-web-gui/master.html">Web GUI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-batch/master.html">Batch</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Vorgaben</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/vorgaben-architektur/master.html">Architektur</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/vorgaben-it-sicherheit/master.html">IT-Sicherheit</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../bausteine/bausteine.html">Bausteine</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Datum &amp; Zeit</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-datetime/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-datetime/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Fehlerbehandlung</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">HttpInvoker</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-serviceapi-core/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-serviceapi-core/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Konfiguration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-konfiguration/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-konfiguration/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Logging</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-logging/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-logging/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Polling</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-polling/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-polling/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">REST</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-service-rest/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-service-rest/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Sicherheit</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sicherheit/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sicherheit/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Sonderzeichen</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sonderzeichen/konzept/sonderzeichen.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sonderzeichen/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Task Scheduling</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-task/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-task/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Überwachung</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-ueberwachung/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-ueberwachung/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Util</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-util/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Styleguide</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../../isyfact-style-doku/latest/isy-style/styleguide.html">Styleguide</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../../isyfact-style-doku/latest/isy-style/nutzungsvorgaben/nutzungsvorgaben.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">JSF</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../../isyfact-jsf-doku/latest/isy-web/konzept/konzept.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../../isyfact-jsf-doku/latest/isy-web/nutzungsvorgaben/nutzungsvorgaben.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../plattform/plattform.html">Plattform</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../methodik/methodik.html">Methodik</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../methodik/namenskonventionen/master.html">Namenskonventionen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../methodik/versionierung/master.html">Versionierung</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../methodik/java-programmierkonventionen/master.html">Java-Programmierkonventionen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../methodik/diagrammerstellung.html">Diagrammerstellung und Modellierung</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/diagrammerstellung/diagramsnet.html">diagrams.net</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/diagrammerstellung/enterprise-architect.html">Enterprise Architect</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../methodik/vorlagen.html">Vorlagen</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/vorlagen/bearbeitung.html">Bearbeitung der AsciiDoc-Vorlagen</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../werkzeuge/werkzeuge.html">Werkzeuge</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../werkzeuge/dokumentation/einleitung/einfuehrung.html">Dokumentation gemäß IsyFact</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../werkzeuge/dokumentation/master-antora.html">Projektseite mit Antora (empfohlen)</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../werkzeuge/seitenvorlage.html">Seitenvorlage</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../werkzeuge/kopiervorlage.html">Kopiervorlage für neue Seiten</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../werkzeuge/dokumentation/master-asciidoctorJ.html">Dokumente mit AsciidoctorJ Extensions</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../werkzeuge/entwicklungsumgebung/master.html">Entwicklungsumgebung</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../werkzeuge/versionierungskontrolle/master.html">Versionierungskontrolle</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../changelog/changelog.html">Changelog</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">IsyFact Standards</span>
    <span class="version">2.5 (DEV)</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../../glossary/latest/glossary/master.html">Glossar</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../glossary/latest/glossary/master.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../../einstieg/einstieg.html">IsyFact Standards</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../einstieg/einstieg.html">2.5 (DEV)</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../isyfact-jsf-doku/latest/isy-web/konzept/konzept.html">JavaServer Faces (JSF)</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../isyfact-jsf-doku/latest/isy-web/konzept/konzept.html">5.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../isyfact-style-doku/latest/isy-style/styleguide.html">Styleguide</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../isyfact-style-doku/latest/isy-style/styleguide.html">5.4</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../einstieg/vorstellung.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../einstieg/einstieg.html">IsyFact Standards</a></li>
    <li><a href="inhalt.html">Nutzungsvorgaben Fehlerbehandlung: Inhalt</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Inhalt" data-levels="3">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Nutzungsvorgaben Fehlerbehandlung: Inhalt</h1>
<div class="sect1">
<h2 id="implementierung-der-fehlerbehandlung"><a class="anchor" href="#implementierung-der-fehlerbehandlung"></a>1. Implementierung der Fehlerbehandlung</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Für die Beschreibung des Konzeptes der Fehlerbehandlung sei auf Dokument <a href="../konzept/master.html" class="xref page">KonzeptFehlerbehandlung</a> verwiesen.</p>
</div>
<div class="sect2">
<h3 id="design-von-fehlerklassen"><a class="anchor" href="#design-von-fehlerklassen"></a>1.1. Design von Fehlerklassen</h3>
<div class="paragraph">
<p>Exceptions werden in erwartete und unerwartete Exceptions unterteilt.
Technisch werden diese beiden Arten in Java als checked (erwartete) bzw. unchecked (unerwartete) Exceptions abgebildet.
Aus Sicht der Anwendung werden Exceptions in fachliche und technische Exceptions unterteilt.</p>
</div>
<div class="paragraph">
<p>Aus der Tatsache, dass fachliche Fehler nie unerwartet sein können und behandelt werden müssen, ergibt sich, dass es keine fachlichen unerwarteten Exceptions geben darf.
Technische Fehler sind dagegen nur manchmal sinnvoll behandelbar.
Sie sind somit in der Regel unerwartet.</p>
</div>
<div class="paragraph">
<p>Technische erwartete Exceptions sind einzusetzen, sofern mit einem technischen Fehler zu rechnen ist, welcher sinnvoll behandelt werden kann.</p>
</div>
<div class="paragraph">
<p>Dadurch ergibt sich folgende Exception-Hierarchie:</p>
</div>
<div id="image-004" class="imageblock text-center">
<div class="content">
<img src="../_images/nutzungsvorgaben/fehlerbehandlung004.png" alt="fehlerbehandlung004" width="60%">
</div>
<div class="title">Abbildung 1. Abstrakte Exception Hierarchie</div>
</div>
<div class="paragraph">
<p>Grundsätzlich lassen sich also folgende Regeln für die Verwendung festhalten:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Fachliche Exceptions sind immer checked.</p>
</li>
<li>
<p>Behandelbare technische Exceptions sind checked.</p>
</li>
<li>
<p>Nicht behandelbare technische Exceptions sind unchecked.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Neben der oben aufgeführten Hierarchie, in die sich alle Exceptions einteilen lassen, haben alle Exceptions eine gemeinsame Menge an Attributen, siehe <a href="#image-005">Abbildung 2</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Fehlertext, mit der Information was passiert ist.</p>
</li>
<li>
<p>Ausnahme-ID: referenziert den Fehler(-text) und dient als Referenz für die Art des Fehlers.</p>
</li>
<li>
<p>Unique-ID: eineindeutige Nummer in der Anwendungslandschaft und dient als Referenz für die Instanz des Fehlers.
Sie ist eine Referenz auf den aufgetretenen Fehler.</p>
</li>
</ul>
</div>
<div id="image-005" class="imageblock text-center">
<div class="content">
<img src="../_images/nutzungsvorgaben/fehlerbehandlung005.png" alt="fehlerbehandlung005" width="20%">
</div>
<div class="title">Abbildung 2. Attribute von Fehlern</div>
</div>
</div>
<div class="sect2">
<h3 id="erstellen-von-exceptions"><a class="anchor" href="#erstellen-von-exceptions"></a>1.2. Erstellen von Exceptions</h3>
<div class="sect3">
<h4 id="exceptions-des-anwendungskerns"><a class="anchor" href="#exceptions-des-anwendungskerns"></a>1.2.1. Exceptions des Anwendungskerns</h4>
<div class="paragraph">
<p>Aus den Vorgaben zum Design der Fehlerklassen in Abschnitt <a href="#design-von-fehlerklassen">Design von Fehlerklassen</a>, resultiert die folgende Exception-Hierarchie, die beispielhaft Exceptions der Beispiel-Anwendung definiert:</p>
</div>
<div id="image-006" class="imageblock text-center">
<div class="content">
<img src="../_images/nutzungsvorgaben/fehlerbehandlung006.png" alt="fehlerbehandlung006" width="100%">
</div>
<div class="title">Abbildung 3. Exception-Hierarchie innerhalb einer Anwendung</div>
</div>
<div class="paragraph">
<p><a href="#image-006">Abbildung 3</a> zeigt die verschiedenen Hierarchiestufen von Fehlern.
Auf oberster Ebene befinden sich die abstrakten Implementierungen für checked (<code>BaseException</code>) und unchecked (<code>TechnicalRuntimeException</code>) Exceptions.
Diese Oberklassen sind für alle Exceptions innerhalb einer Anwendung zu verwenden.
Diese werden als eigenständige Bibliothek (<code>isy-exception-core</code>) angeboten und befinden sich im Paket <code>de.bund.bva.isyfact.exception</code>.
Sie verwalten die Ausnahme-ID, generieren eine UUID und laden den Fehlertext.
Die Ausnahme-ID referenziert den Fehler(-text) und unterstützt den Nutzer bzw. den Betrieb beim Erkennen der Fehlerart, da ein bestimmter Fehler immer die gleiche Ausnahme-ID besitzt.
Die generierte UUID ist eine im System eineindeutige Nummer, die beim Erstellen der Exception vergeben wird.
Sie ist, wie die Ausnahme-ID, Teil der Fehlernachricht und dient dazu, einen aufgetretenen Fehler im System eindeutig zu referenzieren.
Tritt nun ein Fehler bei mehreren Nutzern des Systems auf, kann mit Hilfe dieser UUID der Fehler, der bei einem bestimmten Nutzer auftrat, in den Log-Dateien der Anwendung identifiziert werden.</p>
</div>
<div class="paragraph">
<p>Werden in einer Anwendung Exceptions benötigt, so müssen zuerst vier eigene abstrakte Oberklassen für die Anwendungs-Exceptions abgeleitet werden.
Hier im Beispiel sind das:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>TerminfindungException</code>: Abstrakte Oberklasse innerhalb einer Anwendung für checked Exceptions</p>
</li>
<li>
<p><code>TerminfindungTechnicalRuntimeException</code>: Abstrakte Oberklasse innerhalb einer Anwendung für unchecked Exceptions</p>
</li>
<li>
<p><code>TerminfindungBusinessException</code>: Kindklasse von <code>TerminfindungException</code> für fachliche Exceptions</p>
</li>
<li>
<p><code>TerminfindungTechnicalException</code>: Kindklasse von <code>TerminfindungException</code> für technische Exceptions</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Die Anwendungsoberklassen besitzen jeweils eine Referenz auf einen anwendungsspezifischen <code>FehlertextProvider</code>.
Dieser wird benötigt, um die Fehlertexte zu laden.
Diese vier Exceptions sind ebenfalls abstrakt, da auch diese Exceptions rein zur Unterscheidung der Art der Exception innerhalb der Anwendung dienen.</p>
</div>
<div class="paragraph">
<p>Die letztlich in einer Anwendung eingesetzten Exceptions werden dann von den genannten Klassen <code>TerminfindungBusinessException</code>, <code>TerminfindungTechnicalException</code> und <code>TerminfindungTechnicalRuntimeException</code> abgeleitet.</p>
</div>
<div class="paragraph">
<p>Die gezeigten Basis-Exceptions der <a href="../../../../glossary/latest/literaturextern/inhalt.html#litextern-vorlageanwendung" class="xref page">Vorlageanwendung</a> sind im Paket <code>de.msg.terminfindung.common.exception</code> abgelegt.</p>
</div>
<div class="paragraph">
<p>Eine Anwendung besitzt Exceptions auf zwei Ebenen.
Auf der Anwendungsebene liegen alle Exceptions die querschnittlich, also von mehreren Komponenten, genutzt werden.
Diese Exceptions gehören in das Paket:</p>
</div>
<div class="paragraph">
<p><code>&lt;organisation&gt;.&lt;domäne&gt;.&lt;anwendung&gt;.common.exception</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
&lt;organisation&gt; z.B. de.bund.bva
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Die zweite Ebene der Exceptions ist die Komponentenebene.
Hier liegen alle Exceptions die komponentenspezifisch sind, also nur von einer einzigen Komponente genutzt werden.
Diese Exceptions gehören in das Paket:</p>
</div>
<div class="paragraph">
<p><code>&lt;organisation&gt;.&lt;domäne&gt;.&lt;anwendung&gt;.core.&lt;komponente&gt;</code></p>
</div>
<div class="paragraph">
<p><strong>Konstruktoren</strong></p>
</div>
<div class="paragraph">
<p>Die abstrakten Exceptions einer Anwendung müssen alle vier Konstruktoren implementieren.
Die letztlich eingesetzten Exceptions implementieren nur die Konstruktoren, die benötigt werden.
Eine Beispiel-Implementierung hierfür befindet sich in der <a href="../../../../glossary/latest/literaturextern/inhalt.html#litextern-vorlageanwendung" class="xref page">Vorlageanwendung</a>.
Dies ist sinnvoll, um Aufwände bei der Erstellung von Exceptions zu sparen, da in diesem Fall lediglich der Konstruktor der Oberklasse aufgerufen werden muss.</p>
</div>
<div class="paragraph">
<p>Beispiel für eine fachliche Exception Hierarchie:</p>
</div>
<div id="image-007" class="imageblock text-center">
<div class="content">
<img src="../_images/nutzungsvorgaben/fehlerbehandlung007.png" alt="fehlerbehandlung007" width="50%">
</div>
<div class="title">Abbildung 4. Beispiel fachliche Exception Hierarchie</div>
</div>
<div class="paragraph">
<p>Das Beispiel in <a href="#image-007">Abbildung 4</a> zeigt eine fachliche Exception der Vorlageanwendung.
Die fachliche Exception <code>TerminfindungNichtGefundenException</code> besitzt in diesem Beispiel nicht alle möglichen Konstruktoren.
Dies dient lediglich der Veranschaulichung.
Wie oben erwähnt ist es nicht notwendig, immer alle Konstruktoren zu implementieren.
Voraussetzung für das Erstellen dieser Exception sind die Basis-Exceptions der Anwendung (hier <code>TerminfindungException</code> und <code>TerminfindungBusinessException</code>).</p>
</div>
<div class="paragraph">
<p>Die <a href="#table-001">Tabelle 1</a> erläutert die Bedeutung der Argumente der Konstruktoren.</p>
</div>
<table id="table-001" class="tableblock frame-all grid-all stretch">
<caption class="title">Tabelle 1. Argumente der Konstruktoren von Exceptions des Anwendungskerns</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Exception</th>
<th class="tableblock halign-left valign-top">String</th>
<th class="tableblock halign-left valign-top">Throwable (optional)</th>
<th class="tableblock halign-left valign-top">String&#8230;&#8203; (optional)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TerminfindungNichtGefundenException</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ausnahme-ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Original-Exception, die gefangen wurde.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String oder String-Array mit Variablenwerten, für Platzhalter in parametrisierten Fehlertexten.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Beispiel für eine technische Runtime-Exception Hierarchie:</p>
</div>
<div id="image-008" class="imageblock text-center">
<div class="content">
<img src="../_images/nutzungsvorgaben/fehlerbehandlung008.png" alt="fehlerbehandlung008" width="45%">
</div>
<div class="title">Abbildung 5. Beispiel technische Runtime-Exception Hierarchie</div>
</div>
<div class="paragraph">
<p>Die <a href="#image-008">Abbildung 5</a> zeigt die technische Runtime-Exception <code>KonfigurationException</code>.
Diese Exception könnte dafür verwendet werden, um bei einem Konfigurationsfehler z.B. "Konfigurationsparameter nicht gesetzt" geworfen zu werden.
Die Exception ist eine <code>RuntimeException</code>, da ein solcher Fehler nicht behandelbar wäre.
Um nun eine solche Klasse zu erstellen, muss zuvor nach obigem Schema (siehe <a href="#image-006">Abbildung 3</a>) die entsprechende Oberklasse erstellt worden sein.</p>
</div>
<div class="paragraph">
<p>Das Beispiel enthält wiederum alle möglichen Konstruktoren.
Dies dient jedoch auch hier nur der Veranschaulichung.
Es ist für Exceptions im <a href="../../../../glossary/latest/glossary/master.html#glossar-anwendungskern" class="xref page">Anwendungskern</a> nicht notwendig, alle Konstruktoren zur Verfügung zu stellen.
Eine Beschreibung der Argumente der Konstruktoren befindet sich in <a href="#table-001">Tabelle 1</a>.</p>
</div>
<div class="paragraph">
<p>Die unter <a href="#image-007">Abbildung 4</a> und <a href="#image-008">Abbildung 5</a> dargestellten Konstruktoren sind notwendig, um zu gewährleisten, dass alle Exceptions immer eine Ausnahme-ID besitzen, die den Fehlertext identifiziert, d.h. andere Konstruktoren sind nicht gestattet.</p>
</div>
<div class="paragraph">
<p><strong>Dokumentation</strong></p>
</div>
<div class="paragraph">
<p>Checked Exceptions sind in Methoden-Signaturen zu deklarieren und im JavaDoc-Kommentar mittels <code>@throws</code> zu dokumentieren.
Unchecked Exceptions sind nicht in den Methoden-Signaturen zu deklarieren, aber mittels <code>@throws</code> im JavaDoc-Kommentar zu dokumentieren.</p>
</div>
</div>
<div class="sect3">
<h4 id="werfen-einer-exception"><a class="anchor" href="#werfen-einer-exception"></a>1.2.2. Werfen einer Exception</h4>
<div class="paragraph">
<p>Der folgende Abschnitt beschreibt das Werfen einer technischen checked Exception.
Das Vorgehen wird nur für technische checked Exceptions beschrieben, da das Vorgehen für alle Arten von Exceptions gleich ist.</p>
</div>
<div class="paragraph">
<p>Gemäß der Anforderungen aus <a href="../konzept/inhalt.html#anforderungen-an-die-fehlerbehandlung" class="xref page">Anforderungen an die Fehlerbehandlung</a> sollte die Fehlerbehandlung übersichtlich sein.
Zur Sicherstellung der Übersichtlichkeit darf die Anzahl der verwendeten Exceptions die Anzahl möglicher Behandlungen nicht überschreiten.
Es sollte also für jede mögliche Fehlerbehandlung auch nur eine Exception geworfen werden.
Sofern sie nicht behandelbar sind, sind hierfür technische unchecked Exceptions zu verwenden.
Wenn mehrere Exceptions zur gleichen Fehlerbehandlung führen, macht es keinen Sinn, mehr als eine Exception hierfür zu deklarieren.</p>
</div>
<div class="paragraph">
<p>In einer Anwendung gibt es nun unter Umständen aber eine größere Anzahl an technischen Fehlern, die die Anwendung nie verlassen.
Dies würde zu einer entsprechenden großen Anzahl an Fehlertexten führen, die nicht mehr verwaltbar wäre.
Daher muss es in jeder Anwendung eine Ausnahme-ID geben mit einem generischen Fehlertext, der einen Platzhalter besitzt.
Als feste Nummer wird für alle Anwendungen die <code>0001</code> festgelegt.
Ein Aufruf einer solchen Exception mit einem generischen Fehlertext sieht dann wie folgt aus:</p>
</div>
<div id="listing-ExceptionGenerischerFehlertext" class="listingblock">
<div class="title">Listing 1. Erstellen einer Exception mit generischem Fehlertext</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">new MeineTechnischeException(FehlerSchluessel.MSG_ALLGEMEINER_FEHLER, "XYZ");</code></pre>
</div>
</div>
<div class="paragraph">
<p>Die Konstante <code>FehlerSchluessel.MSG_ALLGEMEINER_FEHLER</code> referenziert einen generischen Fehlerstring, welcher einen Platzhalter besitzt:</p>
</div>
<div id="listing-KonstanteGenerischerFehlertext" class="listingblock">
<div class="title">Listing 2. Konstante für den generischen Fehlertext</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/** Generische Exception für alle unbekannten Fehler. */

public static final String MSG_ALLGEMEINER_FEHLER = "TRMIN90001";</code></pre>
</div>
</div>
<div id="listing-GenerischerFehlertext" class="listingblock">
<div class="title">Listing 3. Generischer Fehlertext</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">TRMIN90001 = Es ist ein allgemeiner Fehler im Modul Terminfindung aufgetreten.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Beim Einsatz von Exceptions muss immer eine Konstante zur Referenzierung von Fehlern verwendet werden.
Die Fehlertexte dürfen nicht direkt mit dem String referenziert werden (z. B. hier <code>TRMIN90001</code>).</p>
</div>
<div class="paragraph">
<p>Beim Aufruf einer Exception wird im einfachsten Fall lediglich eine Ausnahme-ID übergeben, welche den Fehlertext identifiziert:</p>
</div>
<div id="listing-UebergabeAusnahmeId" class="listingblock">
<div class="title">Listing 4. Übergabe einer Ausnahme-ID</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">new TerminfindungNichtGefundenException(
    FehlerSchluessel.MSG_TERMINFINDUNG_NICHT_GEFUNDEN);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Der Konstruktor der Exception ruft den Konstruktor der abstrakten Eltern-Klasse auf (hier <code>TerminfindungBusinessException</code>):</p>
</div>
<div id="listing-Konstruktur" class="listingblock">
<div class="title">Listing 5. Konstruktor</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public TerminfindungNichtGefundenException(String ausnahmeID) {
    super(ausnahmeID);
}

protected TerminfindungBusinessException(String ausnahmeID) {
    super(ausnahmeID);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Dieser Konstruktor wiederum ruft den Konstruktor seiner Eltern-Klasse auf (hier <code>TerminfindungException</code>), welcher die oberste Exception-Hierarchie-Stufe einer Anwendung darstellt:</p>
</div>
<div id="listing-ObersterKonstruktur" class="listingblock">
<div class="title">Listing 6. Konstruktor der obersten Exception</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">protected TerminfindungException(String ausnahmeID) {
    super(ausnahmeID, FEHLERTEXT_PROVIDER);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Die weitere Kommunikation bis zur Erstellung des eigentlichen Fehlertextes ist in der <a href="#image-009">Abbildung 6</a> skizziert.</p>
</div>
<div id="image-009" class="imageblock text-center">
<div class="content">
<img src="../_images/nutzungsvorgaben/fehlerbehandlung009.png" alt="fehlerbehandlung009">
</div>
<div class="title">Abbildung 6. Abstrakter Ablauf der Erstellung einer Exception</div>
</div>
<div class="paragraph">
<p>Die <code>TerminfindungException</code> hält eine Referenz zu einem FehlertextProvider (siehe <a href="#fehlertextprovider">Fehlertextprovider</a>), welcher die Möglichkeit bietet Fehlertexte auszulesen.
Diese Referenz und die übergebene <code>Ausnahme-ID</code> werden an den Konstruktor der <code>BaseException</code> übergeben, welcher nun den Fehlertext lädt.
Hierzu ruft er auf dem <code>FehlertextProvider</code> die <code>getMessage()</code>-Methode auf und bekommt den Fehlertext zurückgeliefert.
Durch einen Aufruf des Konstruktors der Oberklasse <code>Exception</code> wird der Fehlertext gesetzt.</p>
</div>
<div class="paragraph">
<p>Bis dato hat der Text den Aufbau:</p>
</div>
<div class="paragraph">
<p><strong>Fehlertext</strong></p>
</div>
<div class="paragraph">
<p>Die IsyFact-Exception-Klassen überschreiben aber die <code>getMessage()</code>-Methoden von <code>Exception</code> und erweitern den Fehlertext bei einem lesenden Zugriff.
Der Fehlertext wird um die Ausnahme-ID und die UUID erweitert.
Dies geschieht über die Klasse <code>FehlertextUtil</code>, damit die Formatierung der Fehlertexte an einer zentralen Stelle gekapselt ist.</p>
</div>
<div class="paragraph">
<p>Der Text hat dann folgenden Aufbau:</p>
</div>
<div id="listing-AufbauFehlertext" class="listingblock">
<div class="title">Listing 7. Aufbau des Fehlertexts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">#AusnahmeId Fehlertext #UUID</code></pre>
</div>
</div>
<div class="paragraph">
<p>Der Fehlertext wird in dieser Form aufbereitet, um sicherzustellen, dass sowohl die Ausnahme-ID als auch die UUID</p>
</div>
<div class="ulist">
<ul>
<li>
<p>beim Loggen der Exception immer in die Log-Datei der Anwendung geschrieben werden, ohne dass eine spezielle Implementierung des Loggings notwendig ist,</p>
</li>
<li>
<p>beim Loggen der Exception durch den Aufrufer einer Schnittstelle immer in die Log-Datei der aufrufenden Anwendung geschrieben werden, ohne dass eine spezielle Implementierung des Loggings notwendig ist und</p>
</li>
<li>
<p>der Anwender, sofern er den Fehlertext angezeigt bekommt, auch immer die Ausnahme-ID und die UUID sieht, um diese gegebenenfalls direkt weitergeben zu können.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="exceptions-fuer-anwendungsschnittstellen"><a class="anchor" href="#exceptions-fuer-anwendungsschnittstellen"></a>1.2.3. Exceptions für Anwendungsschnittstellen</h4>
<div class="paragraph">
<p>In den vorhergehenden Kapiteln wurde das Werfen von Fehlern in der Anwendung beschrieben.
In diesem Kapitel geht es um Exceptions, die zur Schnittstelle einer Anwendung gehören und vom Aufrufer verarbeitet werden.
Diese werden in IsyFact als Transport-Exceptions bezeichnet.</p>
</div>
<div class="paragraph">
<p>Neben den Vorgaben zum Design der Fehlerklassen in <a href="#design-von-fehlerklassen">Design von Fehlerklassen</a> gelten für Transport-Exceptions noch weitere Vorgaben, da diese an die Aufrufer weitergereicht werden.</p>
</div>
<div class="paragraph">
<p>Für Exceptions an den Anwendungsschnittstellen gelten weitere Vorgaben:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Sie erben immer von <code>BusinessToException</code> oder <code>TechnicalToException</code> und implementieren somit immer <code>Serializable</code>,</p>
</li>
<li>
<p>stellen die Felder Ausnahme-ID, UUID und Fehlernachricht zur Verfügung und</p>
</li>
<li>
<p>erben nicht von internen Anwendungsexceptions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Daraus ergibt sich für Transport-Exceptions folgende Hierarchie:</p>
</div>
<div id="image-010" class="imageblock text-center">
<div class="content">
<img src="../_images/nutzungsvorgaben/fehlerbehandlung010.png" alt="fehlerbehandlung010">
</div>
<div class="title">Abbildung 7. Exception Hierarchie für Transport-Exceptions</div>
</div>
<div class="paragraph">
<p>Weiterhin werden für die genannten Technologien, welche für die
Anwendungsschnittstellen verwendet werden, folgende Vorgaben gemacht:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>SOAP</strong> (pro Operation)</p>
<div class="ulist">
<ul>
<li>
<p>Definition von 0..1 technischen Exceptions (gleich für alle Operationen einer Schnittstelle)</p>
</li>
<li>
<p>Definition von 0..n fachlichen Exceptions</p>
</li>
<li>
<p>Übermittlung der Ausnahme-ID</p>
</li>
<li>
<p>Übermittlung der UUID</p>
</li>
<li>
<p>Übermittlung des Fehler-Typs („Name“ der Exception)</p>
</li>
<li>
<p>Übermittlung der Fehlernachricht (kein Stack-Trace)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>REST</strong> (keine Exceptions)</p>
<div class="ulist">
<ul>
<li>
<p>Übermittlung der Ausnahme-ID</p>
</li>
<li>
<p>Übermittlung der UUID</p>
</li>
<li>
<p>Übermittlung von Fehler-Kategorie (technisch/Art des fachlichen Fehlers)</p>
</li>
<li>
<p>Übermittlung von Fehlernachricht (kein Stack-Trace!)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Die Vorgaben für HTTP Invoker sind im <a href="../../isy-serviceapi-core/nutzungsvorgaben/master.html" class="xref page">Nutzungsvorgaben HttpInvoker</a> beschrieben.</p>
</div>
<div class="paragraph">
<p>Unabhängig von der eingesetzten Technologie gelten für die Antworten an das aufrufende Nachbarsystem folgende Anforderungen:</p>
</div>
<div class="paragraph">
<p><strong>Technische Exeptions</strong></p>
</div>
<div class="paragraph">
<p>Technische Exceptions sind mit einer allgemeinen Fehler-Nachricht an das aufrufende Nachbarsystem zurückzugeben.
Zudem muss die Ausnahme-ID und die UUID übermittelt werden, damit der Fehler in der aufgerufenen Anwendung gefunden werden kann.
Der tatsächliche Fehler wird im Error-Log der aufgerufenden Anwendung gespeichert und muss nachvollziehbar sein, sodass eine Fehlerbehebung möglich ist.</p>
</div>
<div class="paragraph">
<p><strong>Fachliche Exceptions</strong></p>
</div>
<div class="paragraph">
<p>Fachliche Exceptions sind mit einer ausführlichen und für den Fehler spezifischen Fehler-Nachricht an das aufrufende Nachbarsystem zurückzugeben.
Die Fehler-Nachricht muss für den Anwender verständlich sein und sollte zur Lösung/Vermeidung des Fehlers beitragen.</p>
</div>
</div>
<div class="sect3">
<h4 id="isyfact-bibliotheken-fuer-fehlerbehandlung"><a class="anchor" href="#isyfact-bibliotheken-fuer-fehlerbehandlung"></a>1.2.4. IsyFact-Bibliotheken für Fehlerbehandlung</h4>
<div class="paragraph">
<p>Die in den vorigen Abschnitten beschriebenen abstrakten Oberklassen, die zur Umsetzung der Exception-Hierarchie notwendig sind, werden über die IsyFact-Bibliotheken <code>isy-exception-core</code> und <code>isy-exception-sst</code> in neue Anwendungen integriert.</p>
</div>
<div class="paragraph">
<p>Dabei enthält die Bibliothek <code>isy-exception-core</code> die notwendigen Klassen für den Anwendungskern, die Bibliothek <code>isy-exception-sst</code> die Klassen für die Schnittstellen (Transport-Exceptions).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="behandlung-von-exceptions"><a class="anchor" href="#behandlung-von-exceptions"></a>1.3. Behandlung von Exceptions</h3>
<div class="paragraph">
<p>Die in <a href="#exceptions-des-anwendungskerns">Exceptions des Anwendungskerns</a> aufgeführten Fehlerarten müssen (irgendwann) behandelt werden.
Der Zeitpunkt hängt von den Möglichkeiten der Fehlerbehandlung ab, die zum Zeitpunkt des Auftretens des Fehlers existieren.</p>
</div>
<div class="paragraph">
<p>Grundsätzlich gilt, dass der Aufrufer alle Fehler behandelt, die er behandeln kann, und alle übrigen weiterreicht.</p>
</div>
<div class="paragraph">
<p>Die Fehlerbehandlung besitzt folgende Ausprägungen:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Protokollieren und Ignorieren</p>
</li>
<li>
<p>Protokollieren und Schaden begrenzen, z.B. DB-Verbindung freigeben</p>
</li>
<li>
<p>Protokollieren, Warten und erneut Versuchen</p>
</li>
<li>
<p>Original-Exception weiterwerfen</p>
</li>
<li>
<p>Protokollieren und endgültige Exception erzeugen</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Wann bzw. ob ein Fehler behandelt werden kann, ist im Einzelfall zu entscheiden.
Die ersten vier Ausprägungen sind Möglichkeiten innerhalb einer Komponente oder einer Anwendung.
Die Fehlerbehandlung entspricht den gängigen <code>try-catch</code>-Blöcken mit entsprechender Verarbeitung der Exception, z. B. Weiterreichen oder Behandeln und Loggen.
<a href="#listing-Weiterwerfen">Listing 8</a> zeigt das Weiterwerfen der Original-Exception:</p>
</div>
<div id="listing-Weiterwerfen" class="listingblock">
<div class="title">Listing 8. Weiterwerfen der Original-Exception</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">try {
    verwaltung.leseTerminfindung(terminfindungsRefNr);
} catch (TerminfindungNichtGefundenException ex) {
    // Exception kann nicht behandelt werden, also wird sie weitergereicht
    throw ex;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Die letzte Variante ist die endgültige Fehlerbehandlung, die meistens in einer Komponente der Nutzungsschicht geschieht: GUI, Batch oder Service.
Beschreibungen dazu finden sich in den jeweiligen Detailkonzepten oder den Bausteinen zur Umsetzung der Komponenten, d.h. zu GUI- oder Service-Frameworks.</p>
</div>
</div>
<div class="sect2">
<h3 id="fehlertexte-und-deren-einsatz"><a class="anchor" href="#fehlertexte-und-deren-einsatz"></a>1.4. Fehlertexte und deren Einsatz</h3>
<div class="paragraph">
<p>Fehlertexte müssen in <code>ResourceBundles</code> abgelegt werden.
Die Ablage der Fehlertexte wird durch das <a href="../../isy-ueberwachung/konzept/master.html" class="xref page">Konzept Überwachung</a> vorgegeben, das Laden der Dateien wird in Spring durch Holder-Klassen realisiert.</p>
</div>
<div class="paragraph">
<p>Als Schlüssel werden die Ausnahme-IDs verwendet.
Diese setzen sich aus fünf Buchstaben und fünf numerischen Zeichen zusammen:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">[A-Z]\{5}[0-9]\{5}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ausnahme-IDs der Geschäftsanwendung „ABCDE“ könnten dann z.B. wie folgt aussehen: <code>ABCDE10034</code></p>
</div>
<div class="paragraph">
<p>Die Ausnahme-IDs sind in Nummernkreise für die einzelnen Komponenten unterteilt.
Ein Nummernkreis umfasst immer 1000 Nummern, d. h. es gibt die Kreise 00xxx bis 99xxx.
Bei der Erstellung einer neuen Anwendung ist in der Spezifikations- bzw.
Konstruktionsphase festzulegen, welche Komponente welchen Nummernkreis verwenden muss.</p>
</div>
<div class="paragraph">
<p>Die Ausnahme-IDs referenzieren immer einen Fehlertext.
Die referenzierten Fehlertexte können mit Platzhaltern versehen werden (<code>{1}</code>, <code>{2}</code> etc.), um den Text um kontextbezogene Daten zu erweitern, z. B.</p>
</div>
<table class="tableblock frame-none grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">Der Konfigurationsparameter {0} enthält ungültigen Wert {1}.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Hierzu wird dem Konstruktor der zugehörigen Exception ein String oder String-Array mit den Werten für die Platzhalter übergeben (<a href="#listing-UebergabePlatzhalter">Listing 9</a>).</p>
</div>
<div id="listing-UebergabePlatzhalter" class="listingblock">
<div class="title">Listing 9. Übergabe von Werten für Platzhalter</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">new TerminfindungNichtGefundenException(
    VerwaltungFehlerSchluessel.MSG_TERMINFINDUNG_NICHT-GEFUNDEN,
    terminfindungRef.toString());</code></pre>
</div>
</div>
<div class="paragraph">
<p>Die Verwendung der Fehlertexte geschieht über Konstanten der Klassen.
Jede Komponente besitzt eine eigene Schlüsselklasse, welche die komponentenspezifischen Ausnahme-IDs beinhaltet.
Diese Klasse ist abstrakt, muss dem Namensschema <code>&lt;Komponente&gt;FehlerSchluessel</code> entsprechen und im Paket</p>
</div>
<div class="paragraph">
<p><code>&lt;organisation&gt;.&lt;domäne&gt;.&lt;anwendung&gt;.core.&lt;komponente&gt;.konstanten</code></p>
</div>
<div class="paragraph">
<p>abgelegt werden.
Die Klasse erbt außerdem noch von der Schlüsselklasse für die gesamte Anwendung, um Zugriff auf allgemeine Ausnahme-IDs, wie z. B. Datenbank-Fehler zu haben, da diese in der Anwendungsklasse spezifiziert sind und für alle Komponenten gleich sind.
Die Anwendungsklasse ist im Paket</p>
</div>
<div class="paragraph">
<p><code>&lt;organisation&gt;.&lt;domäne&gt;.&lt;anwendung&gt;.common.konstanten</code></p>
</div>
<div class="paragraph">
<p>abzulegen und muss in jeder Anwendung <code>FehlerSchluessel</code> heißen.</p>
</div>
<div class="paragraph">
<p>Kommen neue Fehlertexte hinzu, so müssen die Schlüssel in einer der oben genannten Klassen als Konstanten hinzugefügt werden.
Ausnahme-IDs für allgemeine Fehler müssen in die Anwendungsklasse, komponentenspezifische in die Komponentenklasse.
Wie in <a href="#listing-FehlerSchluessel">Listing 10</a> gezeigt, müssen die Konstanten einen sprechenden Namen tragen und z.B. immer mit <code>MSG_</code> beginnen.</p>
</div>
<div id="listing-FehlerSchluessel" class="listingblock">
<div class="title">Listing 10. Fehlerschlüssel</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/** Die im Parameter {0} übergebene Liste ist leer. */
public static final String MSG_LISTE_LEER = "TRMIN90004";</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="fehlertextprovider"><a class="anchor" href="#fehlertextprovider"></a>1.4.1. Fehlertextprovider</h4>
<div class="paragraph">
<p>Das Auslesen von Fehlertexten wird durch einen <code>FehlertextProvider</code> implementiert.
Dieser <code>FehlertextProvider</code> ist pro Anwendung zu implementieren und befindet sich im Paket:</p>
</div>
<div class="paragraph">
<p><code>&lt;organisation&gt;.&lt;domäne&gt;.&lt;anwendung&gt;.common.exception</code></p>
</div>
<div class="paragraph">
<p>Zu implementieren sind die zwei <code>getMessage()</code>-Methoden des Interfaces <code>FehlertextProvider</code> aus der Bbliothek <code>isy-exception-core</code>, siehe <a href="#image-014">Abbildung 8</a>.</p>
</div>
<div id="image-014" class="imageblock text-center">
<div class="content">
<img src="../_images/nutzungsvorgaben/fehlerbehandlung014.png" alt="fehlerbehandlung014" width="40%">
</div>
<div class="title">Abbildung 8. Fehlertextprovider</div>
</div>
<div class="paragraph">
<p>Die Implementierung muss Spring-Mechanismen verwenden, um die Fehlertexte aus einem <code>ResourceBundle</code> auszulesen.
Dies führt zu einer Vereinheitlichung der Fehlerbehandlung, da sich das Laden von Fehlertexten in den einzelnen Anwendungen nicht unterscheidet.
Eine Beispiel-Implementierung hierfür befindet sich in der <a href="../../../../glossary/latest/literaturextern/inhalt.html#litextern-vorlageanwendung" class="xref page">Vorlageanwendung</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dos-und-donts"><a class="anchor" href="#dos-und-donts"></a>2. DO&#8217;s und DON&#8217;Ts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Im Folgenden werden Vorgaben gemacht, wie Fehler behandelt werden müssen und wie Fehler nicht behandelt werden dürfen.</p>
</div>
<div class="sect2">
<h3 id="dos"><a class="anchor" href="#dos"></a>2.1. DO&#8217;s</h3>
<div class="paragraph">
<p><strong>Log it or throw it</strong><br>
Exceptions sind in der Regel zu behandeln und zu loggen.
Ist es nicht möglich die Exception zu behandeln, muss sie an den Aufrufer weitergegeben werden.
Die Exception wird im Fall eines Weiterwerfens nicht geloggt.
Details zum Logging befinden sich im <a href="../../isy-logging/konzept/master.html" class="xref page">Konzept Logging</a>.</p>
</div>
<div class="paragraph">
<p><strong>Nur vorkommende Exceptions verwenden</strong><br>
Nur Exceptions in Methodensignaturen verwenden, die auch vorkommen können.
Dies führt sonst zu leeren <code>catch</code>-Blöcken oder der Behandlung aller Fehler über das Fangen einer globalen Exception.</p>
</div>
<div class="paragraph">
<p><strong>Rollback durch Besitzer der Transaktionsklammer</strong><br>
Das Rollback geschieht durch die Schnittstelle, den Dialog oder den Batch, welcher die Transaktionsklammer bildet.</p>
</div>
<div class="paragraph">
<p><strong>Aufräumen</strong><br>
Bei der Behandlung von Fehlern ist ein geordneter Systemzustand herzustellen, z. B. das Schließen der Datenbankverbindung über einen <code>finally</code>-Block.</p>
</div>
<div class="paragraph">
<p><strong>Throw Early / Failing fast</strong><br>
Fehler sollten früh erkannt werden und zu entsprechenden Ausnahmen führen, bevor sich der Aufruf in tieferen Schichten befindet.
Beispiel: Übergibt man <code>null</code> an <code>FileInputStream</code> wird eine <code>NullPointerException</code> in <code>java.io</code> geworfen.
Passender wäre es aber gleich in der Methode, die <code>FileInputStream</code> verwendet auf <code>null</code> zu prüfen und eine <code>Exception</code> zu werfen.</p>
</div>
</div>
<div class="sect2">
<h3 id="donts"><a class="anchor" href="#donts"></a>2.2. DON&#8217;Ts</h3>
<div class="paragraph">
<p>Neben den oben genannten Punkten, wie man Exceptions richtig verwendet, gibt es auch eine Liste von Anti-Patterns, die bei der Verwendung von Exceptions zu Problemen führen und daher vermieden werden sollten:</p>
</div>
<div class="paragraph">
<p><strong>Interne Exceptions in der Schnittstelle</strong><br>
Interne Exceptions dürfen in der Schnittstelle nicht vorkommen, da diese ansonsten dem Aufrufer bekannt sein müssen.
Dies würde zu einer engeren Kopplung von Aufrufer und Aufgerufenem führen und dem Komponentengeheimnis widersprechen.</p>
</div>
<div class="paragraph">
<p><strong>Flusssteuerung über Exceptions</strong><br>
Catch-Blöcke dienen der Fehlerbehandlung und dürfen nicht als <code>else</code>-Zweig genutzt werden.</p>
</div>
<div id="listing-FlusssteuerungExceptions" class="listingblock">
<div class="title">Listing 11. DON&#8217;T: Flusssteuerung über Exceptions</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">try {
    obj = mgr.getObject(id);
} catch (NotFoundException e) {
    obj = mgr.createObject(id);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ebenso sind GoTos über <code>catch</code>/<code>throw</code>-Konstrukte zu vermeiden.</p>
</div>
<div id="listing-FlusssteuerungExceptions2" class="listingblock">
<div class="title">Listing 12. DON&#8217;T: GoTo über catch/throw</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public void useExceptionsForFlowControl() {
try {
    while(true) {
        increaseCount();
    }
} catch (MaximumCountReachedException ex) {}
   //weitere Verarbeitung
}

public void increaseCount() throws MaximumCountReachedException {
    if (count &gt;= 5000) throw new MaximumCountReachedException();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Leere catch-Blöcke</strong><br>
Wenn dies der Fall ist, dann ist die Exception unnötig oder die Ausnahme muss behandelt werden.
Siehe auch <a href="#isyfact-bibliotheken-fuer-fehlerbehandlung">IsyFact-Bibliotheken für Fehlerbehandlung</a>.</p>
</div>
<div id="listing-LeererCatchBlock2" class="listingblock">
<div class="title">Listing 13. DON&#8217;T: Leerer catch-Block</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">try {
    myMethod();
} catch (MyException me) {}
//weitere Verarbeitung</code></pre>
</div>
</div>
<div class="paragraph">
<p>In Ausnahmefällen, (z. B. <code>InterruptedException</code>) kann ein leerer <code>catch</code>-Block durchaus sinnvoll sein.
In diesem Fall ist ein entsprechender Kommentar im <code>catch</code>-Block zu hinterlegen, warum die Exception nicht behandelt wird.</p>
</div>
<div class="paragraph">
<p><strong>Destruktives Wrappen</strong><br>
Das destruktive Wrappen einer Exception zerstört den StackTrace und ist nur für Exceptions an den Außen-Schnittstellen sinnvoll.
Destruktiv gewrappte Exceptions sind in jedem Fall vor dem Wrappen zu loggen.</p>
</div>
<div id="listing-DestruktivesWrappen" class="listingblock">
<div class="title">Listing 14. DON&#8217;T: Destruktives Wrappen</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">catch (NoSuchMethodException e) {
    throw new MyServiceException("Fehlernachricht: " + e.getMessage());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Catch Exception</strong><br>
Global die Elternklasse einer Exception zu fangen ist zu unspezifisch.
Dadurch entfällt die Möglichkeit, auf verschiedene Ausnahmen unterschiedlich reagieren zu können.</p>
</div>
<div id="listing-CatchException" class="listingblock">
<div class="title">Listing 15. DON&#8217;T: Elternklasse einer Exception fangen</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">try {
    foo();
} catch (Exception e) {
    LOG.error("Foo failed", e);
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Wenn so etwas sinnvoll ist, dann ist die Signatur der aufgerufenen Methode zu überdenken.
Ist es nicht möglich die Exceptions der Methode (<code>foo()</code>) unterschiedlich zu behandeln, so ist die Methode auf sinnvoll behandelbare Exceptions einzuschränken.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Exception Flut</strong><br>
Nur Exceptions werfen, die auch sinnvoll zu behandeln sind.</p>
</div>
<div id="listing-ExceptionFlut" class="listingblock">
<div class="title">Listing 16. DON&#8217;T: Exception Flut</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public void zuViel() throws
    MeineException,
    NeAndereException,
    AuchNeAndereException,
    NochNeAndereException {
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Throw Exception</strong><br>
Es sollten aussagekräftige Exceptions verwendet werden, um dem Aufrufer eine adäquate Fehlerbehandlung zu ermöglichen.</p>
</div>
<div id="listing-ThrowException" class="listingblock">
<div class="title">Listing 17. DON&#8217;T: Throw Exception</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public void eineMethode() throws Exception {
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Log and throw</strong><br>
Das Loggen und Weiterwerfen von Exceptions führt zu unbrauchbaren Log-Dateien.
Tritt eine Exception in einer tiefen Aufrufhierarchie auf, wird ein und dieselbe Exception mehrmals in einer Log-Dateien gespeichert.
Dies behindert bei der Fehlersuche.
Daher gilt die Regel aus <a href="#dos">DO&#8217;s</a> (<em>Log it or throw it</em>), d. h. entweder man behandelt und loggt die Exception oder man reicht sie weiter.</p>
</div>
<div id="listing-LogAndThrow" class="listingblock">
<div class="title">Listing 18. DON&#8217;T: Log and throw</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">catch (NoSuchMethodException e) {
    LOG.error("Foo", e); throw e;
}

catch (NoSuchMethodException e) {
    LOG.error("Blah", e);
    throw new MyServiceException("Foo", e);
}

catch (NoSuchMethodException e) {
    e.printStackTrace();
    throw new MyServiceException("Foo", e);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Log and return null / Catch and Ignore</strong><br>
Das Ignorieren von Fehlern ist zu vermeiden, da der Aufrufer sonst keinen Fehler bemerkt, den man unter Umständen in der weiteren Verarbeitung berücksichtigen müsste.</p>
</div>
<div id="listing-LogAndReturnNull" class="listingblock">
<div class="title">Listing 19. DON&#8217;T: Log and return null / Catch and Ignore</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">catch (NoSuchMethodException e) { return null; }

catch (NoSuchMethodException e) { LOG.error("Foo", e); return null; }</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
Exceptions sollten weitergereicht werden, außer es handelt sich nicht um eine Ausnahme, z. B. <code>return null</code> für den Fall, dass nichts gefunden wurde.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>throw im finally-Block</strong><br>
Exceptions in <code>finally</code>-Blöcken führen zu einem Verlust des Original-Fehlers:</p>
</div>
<div id="listing-ThrowInFinally" class="listingblock">
<div class="title">Listing 20. DON&#8217;T: throw im finally-Block</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">try { myMethod(); } finally { cleanUp(); }</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
<div class="literalblock">
<div class="content">
<pre> Wirft `cleanUp()` eine Exception, ist die original Exception von `myMethod()` verloren.
Es ist somit nicht gestattet in `finally`-Blöcken Methoden aufzurufen, welche potentiell Exceptions werfen.</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Nicht unterstützte Methode gibt null zurück</strong><br>
Null als Rückgabewert einer Methode, sofern sie nicht unterstützt wird, deckt sich mit dem oben aufgeführten Punkt "Catch and Ignore".
Der Aufrufer hat in diesem Fall nicht mitbekommen, dass die Methode eigentlich gar nicht unterstützt wird.
Im einfachsten Fall tritt eine <code>NullPointerException</code> auf, welche aber nicht den eigentlichen Fehlergrund widerspiegelt.</p>
</div>
<div id="listing-ThrowNotSupported" class="listingblock">
<div class="title">Listing 21. DON&#8217;T: Nicht unterstützte Methode gibt null zurück</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public String myMethod() { // Nicht unterstützt.
    return null;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In diesem Fall sollte eine entsprechende <code>UnsupportedOperationException</code> geworfen werden:</p>
</div>
<div id="listing-ThrowUnsupported" class="listingblock">
<div class="title">Listing 22. DO: Nicht unterstützte Methode wirft UnsupportedOperationException</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public String myMethod() { // Nicht unterstützt.
    throw new UnsupportedOperationException();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Sich auf getCause() verlassen</strong><br>
Dies führt zu Problemen bei gewrappten Exceptions (<code>getCause().getCause()</code> notwendig).
Exceptions sollten zu einer eindeutigen Behandlung führen.
Das Code-Fragment in <a href="#listing-GetCause">Listing 23</a> unterscheidet die Fehlerbehandlung anhand des Grundes der gefangenen Exception.</p>
</div>
<div id="listing-GetCause" class="listingblock">
<div class="title">Listing 23. DON&#8217;T: Sich auf getCause() verlassen</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">catch (MyException e) {if (e.getCause() instanceof FooException) {</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Dies funktioniert nur, sofern eine Exception nicht mehrmals gewrappt wurde.
Es dürfen nur die für die Schnittstelle spezifizierten Exceptions behandelt werden.
Ist auf der Aufruferseite eine Auswertung mittels <code>getCause()</code> notwendig, so ist die Schnittstelle zu überarbeiten.
Der Grund hierfür ist die Anforderung des Aufrufers an die Schnittstelle, die Fehler genauer unterscheiden und unterschiedlich behandeln zu können.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Technische checked Exceptions zur Schnittstelle durchreichen</strong><br>
Technische checked Exceptions sind zu verwenden, um den Aufrufer zur Fehlerbehandlung zu zwingen.
Der Aufrufer muss den Fehler behandeln und nicht in eine technische unchecked Exception wrappen.
In Einzelfällen mag dies notwendig sein, muss dann aber mit dem Chefarchitekt abgestimmt werden.</p>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<div class="divFooter"></div>

<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../_/js/isyfact.js"></script>
  </body>
</html>
