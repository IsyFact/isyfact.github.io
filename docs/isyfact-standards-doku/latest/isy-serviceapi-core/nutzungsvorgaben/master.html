<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>HTTP Invoker :: IsyFact Dokumentation</title>
    <link rel="canonical" href="https://github.com/isyfact/isyfact-standards-doku/latest/isy-serviceapi-core/nutzungsvorgaben/master.html">
    <meta name="generator" content="Antora 3.0.1">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <link rel="stylesheet" href="../../../../_/css/font-awesome.min.css">
    <link rel="stylesheet" href="../../../../_/css/isyfact.css">
    <script>var uiRootPath = '../../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://github.com/isyfact">IsyFact Dokumentation</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="isyfact-standards-doku" data-version="2.5-SNAPSHOT">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../einstieg/vorstellung.html">IsyFact Standards</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Einstieg</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../einstieg/vorstellung.html">Vorstellung der IsyFact</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/vorstellung/isyfact-standards.html">IsyFact-Standards</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/vorstellung/isyfact-erweiterungen.html">IsyFact-Erweiterungen</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/vorstellung/rahmenbedingungen.html">Rahmenbedingungen</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/erste-schritte.html">Erste Schritte</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/tutorial/master.html">Tutorial</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/whitepaper/master.html">Whitepaper</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/migrationsleitfaden-if2/master.html">Migrationsleitfaden IsyFact 2</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Blaupausen</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../blaupausen/referenzarchitektur/master.html">Referenzarchitektur</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../blaupausen/referenzarchitektur-it-system/master.html">Referenzarchitektur IT-System</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-anwendungskern/master.html">Anwendungskern</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-datenzugriff/master.html">Datenzugriff</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-service/master.html">Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-web-gui/master.html">Web GUI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-batch/master.html">Batch</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Vorgaben</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/vorgaben-architektur/master.html">Architektur</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/vorgaben-it-sicherheit/master.html">IT-Sicherheit</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Bausteine</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Datum &amp; Zeit</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-datetime/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-datetime/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Fehlerbehandlung</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-exception-core/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-exception-core/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">HttpInvoker</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Konfiguration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-konfiguration/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-konfiguration/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Logging</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-logging/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-logging/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Polling</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-polling/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-polling/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">REST</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-service-rest/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-service-rest/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Sicherheit</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sicherheit/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sicherheit/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Sonderzeichen</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sonderzeichen/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sonderzeichen/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Task Scheduling</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-task/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-task/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Ãœberwachung</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-ueberwachung/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-ueberwachung/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Util</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-util/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Methodik</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../methodik/namenskonventionen/master.html">Namenskonventionen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../methodik/versionierung/master.html">Versionierung</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../methodik/java-programmierkonventionen/master.html">Java-Programmierkonventionen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../methodik/diagrammerstellung.html">Diagrammerstellung und Modellierung</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/diagrammerstellung/diagramsnet.html">diagrams.net</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/diagrammerstellung/enterprise-architect.html">Enterprise Architect</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../methodik/vorlagen.html">Vorlagen</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/tailoring/tailoring.html">Tailoring</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/spezifikation/datenflussdiagramme.html">Datenflussdiagramme</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Werkzeuge</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../werkzeuge/einrichtung_entwicklungsumgebung/master.html">Entwicklungsumgebung</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../werkzeuge/versionierungskontrolle/master.html">Versionierungskontrolle</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../werkzeuge/handbuch_dokumentation/master.html">Dokumentation der IsyFact</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../werkzeuge/seitenvorlage.html">Seitenvorlage</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../werkzeuge/kopiervorlage.html">Kopiervorlage fÃ¼r neue Seiten</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../changelog/changelog.html">Changelog</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">IsyFact Standards</span>
    <span class="version">2.5-SNAPSHOT</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../../glossary/latest/glossary/master.html">Glossar</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../glossary/latest/glossary/master.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../../einstieg/vorstellung.html">IsyFact Standards</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../einstieg/vorstellung.html">2.5-SNAPSHOT</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../einstieg/vorstellung.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../einstieg/vorstellung.html">IsyFact Standards</a></li>
    <li>Bausteine</li>
    <li>HttpInvoker</li>
    <li><a href="master.html">Nutzungsvorgaben</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Inhalt" data-levels="3">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">HTTP Invoker</h1>
<div id="preamble">
<div class="sectionbody">
<h3 id="_nutzungsvorgaben" class="discrete">Nutzungsvorgaben</h3>
<div class="paragraph">
<p><span class="image left"><img src="../../../../glossary/latest/licence/_images/IFS-Logo.png" alt="IFS-Logo" width="150"></span> Dieses Dokument ist ein Teil der IsyFact-Standards. Alle Inhalte dieses Dokuments, insbesondere Texte und Grafiken, sind urheberrechtlich geschÃ¼tzt. Alle urheberrechtlichen Nutzungs- und Verwertungsrechte liegen beim Bundesverwaltungsamt.</p>
</div>
<div class="paragraph">
<p><span class="image right"><img src="../../../../glossary/latest/licence/_images/CC-BY.png" alt="Creative Commons Namensnennung" width="100"></span>
Die Nutzung ist unter den Lizenzbedingungen der Creative Commons Namensnennung 4.0 International gestattet.
Die Lizenzbestimmungen sind unter folgender URL erhÃ¤ltlich:</p>
</div>
<div class="paragraph">
<p><a href="../../../../glossary/latest/literaturextern/inhalt.html#litextern-cc-licence" class="xref page">Creative-Commons-Lizenz</a></p>
</div>
<div class="paragraph">
<p><strong>Java Bibliothek / IT-System</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 20%;">
<col style="width: 30%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Art</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Version</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isy-serviceapi-core</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bibliothek</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">siehe <code>isyfact-bom</code> v2.5-SNAPSHOT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isy-serviceapi-sst</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bibliothek</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">siehe <code>isyfact-bom</code> v2.5-SNAPSHOT</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="einleitung"><a class="anchor" href="#einleitung"></a>1. Einleitung</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Dieses Dokument ist aus mehreren Quellen entstanden und fasst die vorhandene Dokumentation zum Thema HTTP Invoker zusammen.
Der Baustein HTTP Invoker steht unter Bestandsschutz und wird nicht mehr aktiv weiterentwickelt.
Er wird in einem der nÃ¤chsten Major Releases aus der IsyFact entfernt.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Das Dokument <a href="../konzept/master.html" class="xref page">KonzeptHttpInvoker</a> konzentriert sich auf die konzeptionellen Aspekte von Services mit HTTP Invoker.</p>
</div>
<div class="paragraph">
<p>Dieses Dokument beschreibt, wie diese Services konkret umgesetzt werden.
Es richtet sich an Entwickler, die ein <a href="../../../../glossary/latest/glossary/master.html#glossar-IT-System" class="xref page">IT-System</a> gemÃ¤ÃŸ den Vorgaben der IsyFact mit der FÃ¤higkeit zur Kommunikation mit anderen IT-Systemen ausstatten mÃ¼ssen und beschreibt, was bei der Umsetzung zu bedenken ist.</p>
</div>
<div class="paragraph">
<p>Dazu beschreibt das Kapitel <a href="inhalt.html#maven-konfiguration" class="xref page">Maven-Konfiguration</a> zunÃ¤chst die grundlegende Konfiguration, um den Baustein in ein IT-System einzubinden.
Danach beschreibt das Dokument die Realisierung eines Services in den Kapiteln:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="inhalt.html#realisierung-remote-bean" class="xref page">Realisierung des Remote-Beans</a>,</p>
</li>
<li>
<p><a href="inhalt.html#realisierung-exception-fassade" class="xref page">Realisierung der Exception-Fassade</a>,</p>
</li>
<li>
<p><a href="inhalt.html#realisierung-service-fassade" class="xref page">Realisierung der Service-Fassade</a>,</p>
</li>
<li>
<p><a href="inhalt.html#realisierung-to" class="xref page">Realisierung von Transportobjekten</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Danach geht es um die <a href="inhalt.html#paketierung" class="xref page">Paketierung einer Service-Schnittstelle</a> und die <a href="inhalt.html#nutzung" class="xref page">Nutzung einer Service-Schnittstelle</a> durch ein anderes IT-System.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="maven-konfiguration"><a class="anchor" href="#maven-konfiguration"></a>2. Maven-Konfiguration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Zur Verwendung des Bausteins HTTP Invoker genÃ¼gt es, die folgenden zwei Bibliotheken aus der IsyFact als Maven-AbhÃ¤ngigkeiten einzubinden.</p>
</div>
<div id="listing-pom" class="listingblock">
<div class="title">Listing 1. Einbindung des Bausteins HTTP Invoker</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependencyManagement&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;de.bund.bva.isyfact&lt;/groupId&gt;
            &lt;artifactId&gt;isy-serviceapi-core&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;de.bund.bva.isyfact&lt;/groupId&gt;
            &lt;artifactId&gt;isy-serviceapi-sst&lt;/artifactId&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/dependencyManagement&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="realisierung-der-service-schnittstelle"><a class="anchor" href="#realisierung-der-service-schnittstelle"></a>3. Realisierung der Service-Schnittstelle</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Die folgenden Abschnitte fÃ¼hren durch die Realisierung einer Service-Schnittstelle mit HTTP Invoker.
Sie behandeln die folgenden Bestandteile: das Remote-Bean, die Exception-Fassade, die Service-Fassade und schlieÃŸlich die Transportobjekte.
Die letzten Abschnitte beschreiben dann die Integration anderer Bausteine zur Realisierung querschnittlicher Aspekte: Fehlerbehandlung, Logging und die Absicherung von Service-Methoden.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Wichtige ergÃ¤nzende Hinweise sowie eine sehr umfangreiche Anleitung zur Erstellung von Service-Schnittstellen mit HTTP Invoker bietet das <a href="../../einstieg/tutorial/master.html" class="xref page">IsyFact Tutorial</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="realisierung-remote-bean"><a class="anchor" href="#realisierung-remote-bean"></a>3.1. Realisierung des Remote-Beans</h3>
<div class="paragraph">
<p>Das Remote-Bean wird als Java-Schnittstelle realisiert.
Jede Methode entspricht dabei einem mÃ¶glichen Service-Aufruf.
Jede Methode der RemoteBean-Schnittstelle muss als ersten Parameter ein Objekt der Klasse <code>AufrufKontextTo</code> bzw. <code>ClientAufrufKontextTo</code> verwenden.
Dieser Parameter dient dazu, Meta-Informationen zum jeweiligen Aufruf zu Ã¼bergeben.
Daneben enthÃ¤lt die Schnittstelle natÃ¼rlich noch weitere, fachliche Parameter, die frei definiert werden kÃ¶nnen.</p>
</div>
<div class="paragraph">
<p>Die Verwendung von Parametern in einer Schnittstelle ist im folgenden Beispiel dargestellt:</p>
</div>
<div id="listing-BSPRemoteBean" class="listingblock">
<div class="title">Listing 2. Beispiel fÃ¼r ein Remote-Bean</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class BeispielRemoteBean {
     public BeispielHolenAntwortTo holeBeispielAnfrage(
         AufrufKontextTo kontext, BeispielHolenAnfrageTo anfrage)
         throws BeispielTechnicalToException;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Im Folgenden werden die beiden Klassen <code>AufrufKontextTo</code> und <code>ClientAufrufKontextTo</code> nÃ¤her beschrieben.</p>
</div>
<div class="paragraph">
<p><strong>AufrufKontextTo:</strong> Die Klasse <code>AufrufKontextTo</code> wird fÃ¼r HTTP Invoker Schnittstellen verwendet, die durch IT-Systeme definiert werden.
Die Klasse kapselt die Informationen, mit denen andere IT-Systeme aufgerufen wurde:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>BehÃ¶rde:</strong> Das BehÃ¶rdenkennzeichen der aufrufenden BehÃ¶rde,</p>
</li>
<li>
<p><strong>Kennung:</strong> Die Kennung des aufrufenden Benutzers oder des aufrufenden Fremdprogramms,</p>
</li>
<li>
<p><strong>Kennwort:</strong> Das Passwort des aufrufenden Benutzers oder des aufrufenden Fremdprogramms,</p>
</li>
<li>
<p><strong>Rollen:</strong> Die Rollen des aufrufenden Benutzers oder des aufrufenden Fremdprogramms,</p>
</li>
<li>
<p><strong>Korrelations-ID:</strong> Die ID, um den Service-Aufruf eindeutig zu identifizieren.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>ClientAufrufKontextTo:</strong> Die Klasse <code>ClientAufrufKontextTo</code> wird fÃ¼r HTTP Invoker Schnittstellen verwendet, die durch Service-Consumer definiert werden.
Im Gegensatz zu <code>AufrufKontextTo</code> kapselt diese Klasse die Informationen, um sich bei einem externen Service zu authentifizieren und zu autorisieren:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Kennung:</strong> Die Kennung mit welcher der externe Service aufgerufen wird,</p>
</li>
<li>
<p><strong>Kennwort:</strong> Das Passwort mit welchem der externe Service aufgerufen wird,</p>
</li>
<li>
<p><strong>Zertifikat:</strong> Das Zertifikat, um sich beim externen Service zu authentifizieren,</p>
</li>
<li>
<p><strong>Zertifikat-Kennwort:</strong> Das Passwort des Zertifikats fÃ¼r die Authentifizierung.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Sowohl <code>AufrufKontextTo</code> als auch <code>ClientAufrufKontextTo</code> sind in der Bibliothek <code>isy-serviceapi-sst</code> definiert.</p>
</div>
</div>
<div class="sect2">
<h3 id="realisierung-exception-fassade"><a class="anchor" href="#realisierung-exception-fassade"></a>3.2. Realisierung der Exception-Fassade</h3>
<div class="paragraph">
<p>Die Exception-Fassade implementiert das Remote-Bean-Interface und definiert in jeder Methode einen <code>try</code>-<code>catch</code>-Block, der alle Fehler des Anwendungskerns abfÃ¤ngt und in Fehler der Service-Schnittstelle umwandelt.</p>
</div>
<div class="paragraph">
<p>In <a href="#listing-BSPExceptionFassade">Listing 3</a> ist ein Beispiel fÃ¼r eine Exception-Fassade eines IT-Systems angegeben.
Die Service-Operationen sind in diesem Fall die Methoden des Interfaces <code>BeispielRemoteBean</code>.
Konkret handelt es sich lediglich um die Service-Operation <code>holeBeispielAnfrage</code>.
Die Service-Operation ist mit der Annotation <code>@StelltLoggingKontextBereit</code> versehen, die eine mit dem <code>AufrufKontext</code> Ã¼bergebene Korrelations-ID im Logging-Kontext registriert und diesen beim Verlassen der Methode wieder aufrÃ¤umt.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
Falls im AufrufKontext keine Korrelations-ID vorhanden ist, so erzeugt die Annotation eine neue Korrelations-ID.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Es ist wichtig den Logging-Kontext zu setzen, bevor die Exception-Fassade aktiv wird.
Die Implementierung der Service-Operation reicht den Methodenaufruf an die implementierende Klasse (<code>BeispielService</code>) weiter, fÃ¤ngt auftretende Fehler jedoch Ã¼ber einen <code>try</code>-<code>catch</code>-Block ab.
Der <code>try</code>-<code>catch</code>-Block unterscheidet zwischen Exceptions der Datenbankzugriffsschicht (<code>DataAccessException</code>) und allen anderen Exceptions (<code>Throwable</code>), um einen passenden Fehlertext in die Log-Dateien zu schreiben.</p>
</div>
<div id="listing-BSPExceptionFassade" class="listingblock">
<div class="title">Listing 3. Beispiel fÃ¼r eine Exception-Fassade</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class BeispielExceptionFassade implements BeispielRemoteBean
{
    private static final IsyLoggerStandard logger = ...;
    private BeispielServiceFassade beispielService;
    ...
    @StelltLoggingKontextBereit
    public BeispielHolenAntwortTo holeBeispielAnfrage
        (AufrufKontextTo kontext, BeispielHolenAnfrageTo anfrage)
        throws BeispielTechnicalToException {
        try {
            return beispielService.holeBeispielAnfrage(kontext,anfrage);
        } catch (DataAccessException e) {
            logger.error("Fehler bei Transaktion", e);
            throw new BeispielTechnicalToException(...);
        } catch (Throwable t) {
            logger.error("...", t);
             throw new BeispielTechnicalToException(...);
        }
    }
    ...
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="realisierung-service-fassade"><a class="anchor" href="#realisierung-service-fassade"></a>3.3. Realisierung der Service-Fassade</h3>
<div class="paragraph">
<p>Die Service-Fassade Ã¼bernimmt die restlichen Aufgaben der Service-Logik, d.h. Transformation der Transportobjekte in Objekte des Anwendungskerns und umgekehrt, sowie die Autorisierung des Aufrufs.</p>
</div>
<div class="paragraph">
<p>In <a href="#listing-BSPServiceFassade">Listing 4</a> ist ein Beispiel fÃ¼r eine Service-Fassade angegeben.
Die Implementierung der Service-Fassade erfolgt analog zur Implementierung der Exception-Fassade.
Die nach auÃŸen angebotene Service-Operation (<code>holeBeispielAnfrage</code>) wird jedoch nicht eins-zu-eins an die implementierende Klasse weitergeleitet, da sich die Parameter und der RÃ¼ckgabewert des Aufrufs unterscheiden.
Nach auÃŸen hin werden Transportobjekte angeboten.
Intern arbeitet die Anwendung mit ihren eigenen EntitÃ¤ten.
Diese kÃ¶nnen sich von den nach auÃŸen hin angebotenen Transportobjekten unterscheiden, z.B. weil sie zusÃ¤tzliche Attribute enthalten, einzelne Attribute anders benennen oder die Daten in irgendeiner Form anders reprÃ¤sentieren als die Transportobjekte.</p>
</div>
<div class="paragraph">
<p>In der Service-Fassade erfolgt auch die Autorisierung eines Zugriffs auf eine Service-Methode.
Voraussetzung fÃ¼r die Autorisierung ist die Auswertung des mitgelieferten AufrufKontextes Ã¼ber die Annotation <code>@StelltAufrufKontextBereit</code> aus der Bibliothek <code>isy-serviceapi-core</code> an der Service-Methode.
AnschlieÃŸend kann Ã¼ber die Annotation <code>@Gesichert</code> der Bibliothek <code>isy-sicherheit</code> die Berechtigung zum Zugriff auf die Methode geprÃ¼ft werden.
Hier werden alle benÃ¶tigten Rechte des Aufrufers Ã¼berprÃ¼ft.
Alternativ kann die Annotation <code>@Gesichert</code> auch an der Service-Klasse verwendet werden, wenn alle Methoden die gleiche Autorisierung erfordern.</p>
</div>
<div class="paragraph">
<p>Das Mapping im Beispiel wird durch einen Bean Mapper umgesetzt.
Vor dem Aufruf werden die Parameter gemappt (Klasse <code>BeispielHolenAnfrageTo</code> auf Klasse <code>BeispielHolenAnfrage</code>), nach dem Aufruf der RÃ¼ckgabewert (Klasse <code>BeispielHolenAntwort</code> auf Klasse <code>BeispielHolenAntwortTo</code>).</p>
</div>
<div class="paragraph">
<p>Die Komponente Service-Logik wird durch eine entsprechende Spring-Konfigurationsklasse verschaltet.</p>
</div>
<div id="listing-BSPServiceFassade" class="listingblock">
<div class="title">Listing 4. Beispiel fÃ¼r eine Service-Fassade</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class BeispielServiceFassade {
    private static final IsyLoggerStandard logger = ...;

    private MapperFacade beanMapper;
    private Beispiel beispiel;

    @StelltAufrufKontextBereit
    @Gesichert(Rechte.RECHT_ZUGRIFFBEISPIEL)
    public BeispielHolenAntwortTo holeBeispielAnfrage(
        AufrufKontextTo kontext, BeispielHolenAnfrageTo anfrage) {

        try {
            BeispielHolenAnfrage anfrageAwk = beanMapper.map(anfrage, BeispielHolenAnfrage.class);
            BeispielHolenAntwort antwortAwk = beispiel.holeBeispielAnfrage(anfrageAwk);

            return beanMapper.map(antwortAwk, BeispielHolenAntwortTo.class);
        } catch (MappingException e) {
            logger.error("...", e);
            throw new TechnicalException(...);
        }
	...
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="realisierung-to"><a class="anchor" href="#realisierung-to"></a>3.4. Realisierung von Transportobjekten</h3>
<div class="paragraph">
<p>Transportobjekte dÃ¼rfen keine externen AbhÃ¤ngigkeiten haben, da sie Teil der ausgelieferten Schnittstelle sind.
Bei Transportobjekten ist zu beachten, dass die UID stets 0 ist (s. <a href="#listing-to-uid">Listing 5</a>).</p>
</div>
<div id="listing-to-uid" class="listingblock">
<div class="title">Listing 5. Definition der UID an Transportobjekten</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class BeispielTransportobjekt {
    private static final long serialVersionUID = 0L;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="fehlerbehandlung"><a class="anchor" href="#fehlerbehandlung"></a>3.5. Fehlerbehandlung</h3>
<div class="paragraph">
<p>HTTP Invoker Schnittstellen besitzen, wie bereits beschrieben, eigene Exceptions, die nur zur Kommunikation mit anderen IT-Systemen dienen.
FÃ¼r diese Transport-Exceptions gilt Ã¼ber die Vorgaben des <a href="../../isy-exception-core/konzept/master.html" class="xref page">Konzept Fehlerbehandlung</a> hinaus noch:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Sie erben immer von <code>BusinessToException</code> oder <code>TechnicalToException</code> und implementieren somit immer <code>Serializable</code>.</p>
</li>
<li>
<p>Sie stellen die Felder Ausnahme-ID, UUID und Fehlernachricht zur VerfÃ¼gung.</p>
</li>
<li>
<p>Sie erben nicht von internen Exceptions des IT-Systems.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Daraus ergibt sich fÃ¼r Transport-Exceptions folgende Hierarchie:</p>
</div>
<div id="image-010" class="imageblock text-center">
<div class="content">
<img src="../_images/nutzungsvorgaben/fehlerbehandlung010.png" alt="fehlerbehandlung010">
</div>
<div class="title">Abbildung 1. Vererbungshierarchie fÃ¼r Transport-Exceptions</div>
</div>
<div class="paragraph">
<p>Weiterhin gelten pro Service-Methode folgende Vorgaben:</p>
</div>
<div class="paragraph">
<p><strong>Definition von technischen Exceptions:</strong> Service-Methoden deklarieren keine oder eine technische Exception.
Die technische Exception muss fÃ¼r alle Service-Methoden einer Service-Schnittstelle gleich sein.</p>
</div>
<div class="paragraph">
<p><strong>Definition von fachlichen Exceptions:</strong> Service-Methoden kÃ¶nnen beliebig viele fachliche Exceptions deklarieren.
Diese kÃ¶nnen spezifisch fÃ¼r jede Service-Methode sein.</p>
</div>
<div class="paragraph">
<p><strong>Ãœbermittlung von Daten:</strong> Die Felder Ausnahme-ID, UUID und Fehlernachricht mÃ¼ssen stets Ã¼bertragen werden.
Weiterhin darf kein Stack-Trace Ã¼bertragen werden.</p>
</div>
<div class="paragraph">
<p>Die Fehlerbehandlung geschieht in der Exception-Fassade, die einen Service-Aufruf nach auÃŸen hin kapselt (siehe <a href="#image-011">Abbildung 2</a>).</p>
</div>
<div id="image-011" class="imageblock text-center">
<div class="content">
<img src="../_images/nutzungsvorgaben/fehlerbehandlung011.png" alt="fehlerbehandlung011" width="80%">
</div>
<div class="title">Abbildung 2. Aufrufkette von der Service-Schnittstelle zum Anwendungskern</div>
</div>
<div class="paragraph">
<p>Die Exception-Fassade bildet die Klammer um einen Aufruf an die Anwendung und ist fÃ¼r die Top-Level Fehlerbehandlung zustÃ¤ndig.
Sie leitet den Aufruf an die Service-Fassade weiter, die wiederum den Anwendungskern aufruft.
Dieser zweistufige Prozess ist notwendig, falls es unerwartete Exceptions in der Service-Fassade selbst gibt (z.B. falls diese die Transaktionsklammer um mehrere Aufrufe des Anwendungskerns bildet).
Solche unerwartete Exceptions treten auÃŸerhalb der eigentlichen Anwendung auf und kÃ¶nnten die Fehlerbehandlung an der Schnittstelle selbst stÃ¶ren.
Daher liegt die Exception-Fassade noch vor der Service-Fassade, um auch diese Fehler abzufangen, zu loggen, in Transport-Exceptions umzuwandeln und an den Aufrufer weiterzureichen.</p>
</div>
<div class="paragraph">
<p><a href="#listing-FehlerbehandlungExceptionFassade">Listing 6</a> zeigt die Fehlerbehandlung in der Exception-Fassade fÃ¼r das Beispiel-Remote-Bean.</p>
</div>
<div id="listing-FehlerbehandlungExceptionFassade" class="listingblock">
<div class="title">Listing 6. Fehlerbehandlung in der Exception-Fassade</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class BeispielExceptionFassade implements BeispielRemoteBean {
    private static final IsyLoggerStandard LOG = ...;

    private final BeispielServiceFassade service;

    ...

    @StelltLoggingKontextBereit
    public BeispielHolenAntwortTo holeBeispielAnfrage(
        AufrufKontextTo kontext, BeispielHolenAnfrageTo anfrage) {
        throws BeispielBusinessToException, BeispielTechnicalToException {

    try {
        return service.holeBeispielAnfrage(kontext, anfrage);
    } catch (InternalBusinessException ex) {
        LOG.debug("...", ex);
        // Exceptions in Schnittstellen-Exceptions transformieren.
        throw (BeispielBusinessToException)ExceptionMapper.mapException(
                ex, BeispielBusinessToException.class);
    } catch (InternalTechnicalRuntimeException ex) {
        LOG.error("...", ex);
        throw (BeispielTechnicalToException)ExceptionMapper.mapException(
            ex, BeispielTechnicalToException.class);
    } catch (Throwable t) {
        LOG.error("...", t);
        // Unbekannte Exceptions in Schnittstellen-Exceptions transformieren.
        BeispielTechnicalToException ex = ExceptionMapper.createToException(
                AusnahmeIdUtil.getAusnahmeId(t),
                new FehlertextProviderImpl(),
                BeispielTechnicalToException.class);
        LOG.error("Ãœbergebener Fehler: " + ex.getMessage());
        throw ex;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Das Code-Beispiel in <a href="#listing-FehlerbehandlungExceptionFassade">Listing 6</a> fÃ¤ngt alle Exceptions und wandelt diese in entsprechende Transport-Exceptions um.
Als erwartete Exceptions gibt es hier die Exception <code>InternalBusinessException</code>.
Diese wird, sofern sie auftritt, in eine <code>BeispielBusinessToException</code> umgewandelt und weitergereicht.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warnung"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Zu beachten ist, dass in das Error-Log nur betrieblich relevante Fehler geschrieben werden sollen.
Fachliche Fehler sind in der Regel irrelevant fÃ¼r den Betrieb.
Daher wird die <code>InternalBusinessException</code> ins Debug-Log geschrieben.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Weitere erwartete Fehler gibt es nicht, somit wird nun eine Fehlerbehandlung fÃ¼r unerwartete Fehler der Anwendung durchgefÃ¼hrt (alle Exceptions vom Typ <code>InternalTechnicalRuntimeException</code>).
Als letzte mÃ¶gliche Fehlerbehandlung werden alle unerwarteten Exceptions vom Typ <code>Throwable</code> gefangen.</p>
</div>
<div class="paragraph">
<p>Der erste Block in diesem Beispiel behandelt eine fachliche Exception.
Die restlichen BlÃ¶cke behandeln unerwartete, technische Exceptions.
Fachliche Exceptions mÃ¼ssen immer in fachliche Transport-Exceptions umgewandelt werden, alle anderen Exceptions sind in technische Transport-Exceptions umzuwandeln.</p>
</div>
<div class="paragraph">
<p>Alle BlÃ¶cke einer solchen Fassade auf der Anwendungsgrenze verwenden die Klasse <code>ExceptionMapper</code> (siehe <a href="#mapping-von-exceptions">Mapping von Exceptions</a>) zur Umwandlung der fachlichen und technischen Exceptions in Transport-Exceptions und zur Erstellung von Transport-Exceptions.
Letzteres wird im letzten <code>catch</code>-Block des obigen Code-Beispiels genutzt, da in diesem Fall keine gemÃ¤ÃŸ <a href="../../isy-exception-core/konzept/master.html" class="xref page">Konzept Fehlerbehandlung</a> aufgebaute Exception und somit weder Ausnahme-ID, UUID noch Fehlernachricht vorhanden sind.
In diesem Fall ist die benÃ¶tigte Ausnahme-ID zu berechnen, mithilfe der Schnittstelle <code>AusnahmeIdErmittler</code> (siehe <a href="#mapping-von-exceptions">Mapping von Exceptions</a>).</p>
</div>
<div class="paragraph">
<p>Die <code>catch</code>-BlÃ¶cke fÃ¼r interne Runtime-Exceptions (hier vom Typ <code>InternalTechnicalRuntimeException</code>) und alle Ã¼brigen unerwarteten Exceptions (<code>Throwable</code>) mÃ¼ssen immer implementiert werden.
Hierdurch wird verhindert, dass die Schnittstelle nicht spezifizierte Exceptions weiterreicht.</p>
</div>
<div class="sect3">
<h4 id="mapping-von-exceptions"><a class="anchor" href="#mapping-von-exceptions"></a>3.5.1. Mapping von Exceptions</h4>
<div class="paragraph">
<p>Zur Umwandlung von internen Exceptions in Transport-Exceptions stellt die Bibliothek <code>isy-serviceapi-core</code> eine eigene Klasse zur VerfÃ¼gung: <code>ExceptionMapper</code> (siehe <a href="#image-012">Abbildung 3</a>).</p>
</div>
<div id="image-012" class="imageblock text-center">
<div class="content">
<img src="../_images/nutzungsvorgaben/fehlerbehandlung012.png" alt="fehlerbehandlung012" width="50%">
</div>
<div class="title">Abbildung 3. Methoden der Klasse ExceptionMapper</div>
</div>
<div class="paragraph">
<p>Die Klasse <code>ExceptionMapper</code> bietet zwei statische Methoden an, um aus fachlichen oder technischen Exceptions entsprechende Transport-Exceptions zu erstellen.
HierfÃ¼r muss lediglich die umzuwandelnde Exception und die Klasse der gewÃ¼nschten Transport-Exception mitgegeben werden.
<a href="#listing-MappingExceptionNachToException">Listing 7</a> zeigt ein Beispiel fÃ¼r die Umwandlung einer technischen Exception in eine technische Transport-Exception.</p>
</div>
<div id="listing-MappingExceptionNachToException" class="listingblock">
<div class="title">Listing 7. Mappen einer BaseException in eine technische Transport-Exception</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ExceptionMapper.mapException(ex, BeispielTechnicalToException.class)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Es kÃ¶nnen jedoch weitere Exceptions auftreten, die nicht gemÃ¤ÃŸ <a href="../../isy-exception-core/konzept/master.html" class="xref page">Konzept Fehlerbehandlung</a> aufgebaut sind.
Diese besitzen keine Ausnahme-ID oder eine UUID, z.B. Runtime-Exceptions aus Frameworks von Drittherstellern.
Auch diese Exceptions mÃ¼ssen in Transport-Exceptions umgewandelt werden.
<a href="#listing-createToException">Listing 8</a> zeigt ein Beispiel fÃ¼r eine solche Umwandlung.</p>
</div>
<div id="listing-createToException" class="listingblock">
<div class="title">Listing 8. Erstellen von Transport-Exceptions</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Throwable t = ...;
AusnahmeIdErmittler a = ...;
BeispielTechnicalToException ex = ExceptionMapper.createToException(
                                    a.ermittleAusnahmeId(t),
                                    new FehlertextProviderImpl(),
                                    BeispielTechnicalToException.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Dazu muss die Schnittstelle <code>AusnahmeIdErmittler</code> implementiert werden.
Sie bietet eine Methode, <code>String getAusnahmeId(Throwable)</code>, zur Analyse einer Ã¼bergebenen Exception und zur RÃ¼ckgabe der zur Exception passenden Ausnahme-ID.
Diese Klasse ist anwendungsspezifisch und fÃ¼r jede Anwendung zu implementieren.</p>
</div>
<div class="paragraph">
<p><a href="#listing-MappingExceptions">Listing 9</a> zeigt eine mÃ¶gliche Implementierung fÃ¼r das Mapping von Exceptions auf Ausnahme-IDs.</p>
</div>
<div id="listing-MappingExceptions" class="listingblock">
<div class="title">Listing 9. Beispielhaftes Mapping von Exceptions auf Ausnahme-IDs</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Bean
public class BeispielAusnahmeIdErmittler implements AusnahmeIdErmittler {

    public String ermittleAusnahmeId(Throwable e) {
        if (throwable instanceof DataAccessException) {
            // generische Datenbank-Fehlermeldung
            return FehlerSchluessel.MSG_GENERISCHER_DB_FEHLER;
        } else if (throwable instanceof JmxException) {
            // generische JMX-Fehlermeldung
            return FehlerSchluessel.MSG_GENERISCHER_JMX_FEHLER;
        } else if (throwable instanceof InternalBusinessException) {
            // Bei Exceptions mit Ausnahme-ID: diese auslesen
            return ((InternalBusinessException) throwable).getAusnahmeID();
        }
        // Kein Mapping MÃ¶glich: generische Fehlermeldung
        return FehlerSchluessel.MSG_GENERISCHER_FEHLER;
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Die Ermittlung der Ausnahme-ID sollte auch auf die internen Exceptions der Anwendung prÃ¼fen, auch wenn es nie zu einer positiven PrÃ¼fung dieser Bedingungen kommen sollte.
Sollte hier also ein Treffer fÃ¼r interne Exceptions auftreten, so wurden die <code>catch</code>-BlÃ¶cke nicht sauber implementiert (z.B. wurde einfach nur <code>catch Throwable</code> verwendet).
Dies wÃ¼rde dazu fÃ¼hren, dass die Original-Nachricht Ã¼berschrieben wÃ¼rde, was besonders bei fachlichen Exceptions zu einem Informationsverlust fÃ¼r den Aufrufer fÃ¼hrt.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="service-absicherung"><a class="anchor" href="#service-absicherung"></a>3.6. Absicherung von Service-Methoden</h3>
<div class="paragraph">
<p>In HTTP Invoker Schnittstellen werden in der Regel einzelne Methoden der Service-Fassade (hinter der Exception-Fassade) abgesichert.
Zur Autorisierung von Aufrufen sind Informationen aus dem Aufrufkontext nÃ¶tig.
Dieser wird als erster Schnittstellenparameter in Form eines Transportobjekts mit jedem Aufruf Ã¼bergeben.
Dieses Transportobjekt, eine Instanz der Klasse <code>AufrufKontextTo</code>, muss die Informationen zum anfragenden Anwender und dessen Rollen enthalten.</p>
</div>
<div class="paragraph">
<p>Zur Autorisierung muss die Service-Methode oder die Service-Fassade mit <code>@StelltAufrufKontextBereit</code> annotiert sein.
Die Annotation signalisiert einem Interceptor, das Transportobjekt auszulesen und die bereitgestellten Informationen in den Aufrufkontext des IT-Systems zu Ã¼bertragen.</p>
</div>
<div class="paragraph">
<p>Mit dieser Voraussetzung kÃ¶nnen Service-Methoden durch die Annotation <code>@Gesichert</code> abgesichert werden.
Als Standard-Parameter werden alle Rechte aufgelistet, die eine Anfrage fÃ¼r einen Aufruf beinhalten muss.
Die Rechte sind immer konjunktiv verknÃ¼pft.
Eine disjunktive VerknÃ¼pfung von Rechten ist nicht mÃ¶glich.</p>
</div>
<div class="paragraph">
<p>Folgendes Beispiel (<a href="#listing-absichern-einer-service-methode">Listing 10</a>) zeigt die Implementierung einer Service-Methode, fÃ¼r die der Aufrufkontext automatisch ausgelesen und anschlieÃŸend die Autorisierung gegen den Baustein Sicherheit durchgefÃ¼hrt wird.</p>
</div>
<div id="listing-absichern-einer-service-methode" class="listingblock">
<div class="title">Listing 10. Absichern einer Service-Methode</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@StelltAufrufKontextBereit
@Gesichert("RechtA", "RechtB")
public void abgesicherteMethode(AufrufKontextTo kontext, ...) {
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>ErfÃ¼llt ein Aufrufer die Forderungen der Annotation <code>@Gesichert</code> nicht, so wird ein Fehler des Typs <code>AutorisierungFehlgeschlagenException</code> erzeugt.
Der Fehler wird in der Regel nicht lokal behandelt, sondern einfach zurÃ¼ckgegeben.
Letztlich deuten fehlende Rechte meist auf einen unberechtigten Zugriff oder einen Fehler in der Konfiguration einer aufrufenden Anwendung hin, sodass hier die normale Fehlerbehandlung greift.</p>
</div>
</div>
<div class="sect2">
<h3 id="kompatibilitaet-zu-weiteren-iam-systemen"><a class="anchor" href="#kompatibilitaet-zu-weiteren-iam-systemen"></a>3.7. KompatibilitÃ¤t zu OAuth 2</h3>
<div class="paragraph">
<p>Aufgrund der Umstellung auf OAuth 2 zur Authentifizierung und Autorisierung muss das Bearer Token bei jedem Schnittstellenaufruf Ã¼bertragen werden.
Dies geschieht fÃ¼r existierende Schnittstellen transparent.</p>
</div>
<div class="paragraph">
<p>Der Zugriff auf das Bearer Token geschieht Ã¼ber den <code>AufrufKontextVerwalter</code>.
Die Klasse enthÃ¤lt hierfÃ¼r ein Attribut <code>bearerToken</code>.</p>
</div>
<div id="listing-aufrufkontextverwalter" class="listingblock">
<div class="title">Listing 11. Bearer Token in AufrufKontextVerwalter</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public interface AufrufKontextVerwalter&lt;T extends AufrufKontext&gt; {

    String getBearerToken();

    void setBearerToken(String bearerToken);

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Zur Ãœbertragung wird der HTTP-Header <code>Authorization</code> verwendet.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="paketierung"><a class="anchor" href="#paketierung"></a>4. Paketierung einer Service-Schnittstelle</h2>
<div class="sectionbody">
<div class="paragraph">
<p>IT-Systeme teilen sich folgende Java-Klassen der HTTP Invoker Schnittstelle:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Java-Interface der Schnittstelle (Remote-Bean),</p>
</li>
<li>
<p>Java-Klassen der Transportobjekte,</p>
</li>
<li>
<p>Java-Klassen der Transport-Exceptions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Diese Klassen mÃ¼ssen als JAR mit einer einzigen AbhÃ¤ngigkeit auf die Bibliothek <code>isy-serviceapi-sst</code> paketiert werden.
Sie werden anhand der Vorgaben in <a href="../../blaupausen/detailkonzept-komponente-service/master.html" class="xref page">Detailkonzept Komponente Service</a> und <a href="../../methodik/versionierung/master.html" class="xref page">IsyFact Versionierung</a> versioniert und anhand der Vorgaben in <a href="../../methodik/namenskonventionen/master.html" class="xref page">IsyFact Namenskonventionen</a> benannt.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bereitstellung"><a class="anchor" href="#bereitstellung"></a>5. Bereitstellung einer Service-Schnittstelle</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In der Konfigurationsklasse der Service-Schicht wird die HTTP Invoker Konfiguration der Service-Schnittstelle eingebunden.
Dazu werden das Remote-Bean-Interface und die zugehÃ¶rige Implementierung in Form der Exception-Fassade als Service konfiguriert <a href="#listing-httpinvokerserviceexporter">Listing 12</a>.
Der Bean-Name ist fÃ¼r die URL, unter welcher der Service erreichbar sein wird, wichtig.</p>
</div>
<div id="listing-httpinvokerserviceexporter" class="listingblock">
<div class="title">Listing 12. Konfiguration von Remote Bean und Exception Fassade als Service</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Configuration
public class ServiceConfiguration {

    @Bean("/BeispielBean_v1_0")
    public HttpInvokerServiceExporter beispielService(BeispielExceptionFassade beispiel) {
        HttpInvokerServiceExporter exporter = new HttpInvokerServiceExporter();
        exporter.setService(beispiel);
        exporter.setServiceInterface(BeispielRemoteBean.class);
        return exporter;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="nutzung"><a class="anchor" href="#nutzung"></a>6. Nutzung einer Service-Schnittstelle</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Zur Nutzung einer entfernten Schnittstelle bindet ein IT-System das JAR der Schnittstelle via Maven ein und initialisiert die Remote-Beans damit.
Das geschieht Ã¼ber die vom Spring Framework bereitgestellte Factory-Klasse <code>HttpInvokerProxyFactoryBean</code>, wie in <a href="#listing-invokerconfig">Listing 13</a> dargestellt.
Auf dieser Bean kÃ¶nnen dann die entfernten Methoden aufgerufen werden.</p>
</div>
<div id="listing-invokerconfig" class="listingblock">
<div class="title">Listing 13. Konfiguration fÃ¼r die Nutzung einer entfernten Schnittstelle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Configuration
public class ServiceConfiguration {
    @Bean
    public HttpInvokerProxyFactoryBean beispielRemoteBean(HttpInvokerRequestExecutor executor, ServiceConfigProperties config) {
        HttpInvokerProxyFactoryBean invoker = new HttpInvokerProxyFactoryBean();
        invoker.setServiceUrl(config.getServiceUrl());
        invoker.setServiceInterface(BeispielRemoteBean.class);
        invoker.setHttpInvokerRequestExecutor(executor);
        return invoker;
    }

    @Bean
    public TimeoutWiederholungHttpInvokerRequestExecutor executor(ServiceConfigProperties config) {
        TimeoutWiederholungHttpInvokerRequestExecutor executor = new TimeoutWiederholungHttpInvokerRequestExecutor();
        executor.setAnzahlWiederholungen(config.getWiederholungen());
        executor.setTimeout(config.getTimeout());
        return executor;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Die FactoryBean erwartet eine Service-URL und ein Remote-Bean-Interface zur Initialisierung.
Der Host-Teil der URL muss in jedem Fall in der betrieblichen Konfiguration der Anwendung zu finden sein.
Das Remote-Bean-Interface ist im Schnittstellen-JAR verfÃ¼gbar.</p>
</div>
<div class="paragraph">
<p>Die Nutzung des hier im Beispiel verwendeten <code>TimeoutWiederholungHttpInvokerRequestExecutor</code> ist zwar optional, wird aber dringend empfohlen, um LanglÃ¤ufer zu vermeiden.
Dieser Executor bricht nach dem angegebenen Timeout die Anfrage ab und wiederholt sie bis zur maximalen angegebenen Wiederholungsanzahl.
Die Parameter fÃ¼r Timeout und Wiederholungen sind Bestandteil der betrieblichen Konfiguration (s. <a href="../../isy-konfiguration/konzept/master.html" class="xref page">Konzept Konfiguration</a>).</p>
</div>
<div class="paragraph">
<p>Nutzt das IT-System den Baustein Logging, muss statt der Spring-eigenen Factory die erweiterte <code>IsyHttpInvokerProxyFactoryBean</code> genutzt werden.
Sie versieht die Remote-Beans automatisch mit einem <code>LogMethodInterceptor</code>, der die Aufrufzeiten der ausgehenden Aufrufe misst und loggt.
Die Konfiguration erfolgt wie in <a href="#listing-isyinvokerconfig">Listing 14</a> gezeigt.</p>
</div>
<div id="listing-isyinvokerconfig" class="listingblock">
<div class="title">Listing 14. Konfiguration mit IsyHttpInvokerProxyFactoryBean</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Configuration
public class ServiceConfiguration {
    @Bean
    public IsyHttpInvokerProxyFactoryBean beispielRemoteBean(HttpInvokerRequestExecutor executor, ServiceConfigProperties config) {
        IsyHttpInvokerProxyFactoryBean invoker = new IsyHttpInvokerProxyFactoryBean();
        invoker.setServiceUrl(config.getServiceUrl());
        invoker.setServiceInterface(BeispielRemoteBean.class);
        invoker.setHttpInvokerRequestExecutor(executor);
        invoker.setRemoteSystemName(config.getRemoteSystemName());
        return invoker;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Die erweiterte FactoryBean erwartet nur einen zusÃ¤tzlichen Parameter <code>remoteSystemName</code>.
Dieser wird genutzt, um in allen Log-Ausgaben einen sprechenden Systemnamen zu setzen.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sicherheit"><a class="anchor" href="#sicherheit"></a>7. Sicherheit</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Bei der Ãœbertragung von Daten Ã¼ber eine HTTP-Invoker-Schnittstelle werden Java-Klassen serialisiert und deserialisiert.
Wird bei der Deserialisierung die IntegritÃ¤t der Daten nicht sichergestellt, kÃ¶nnen Angreifer schadhaften Code Ã¼ber eine HttpInvoker Schnittstelle einschleusen (siehe <a href="../../../../glossary/latest/literaturextern/inhalt.html#litextern-CWE-502" class="xref page">CWE-502</a>).
Das Betrifft alle HTTP-Invoker-Schnittstellen, die direkt von auÃŸerhalb einer Anwendungslandschaft benutzt werden kÃ¶nnen.</p>
</div>
<div class="paragraph">
<p>Um die Sicherheit an dieser Stelle zu erhÃ¶hen, mÃ¼ssen HTTP-Invoker-Schnittstellen den <code>IsyHttpInvokerServiceExporter</code> verwenden.
Dieser Exporter deaktiviert standardmÃ¤ÃŸig die Verwendung von Proxy-Klassen, Ã¼ber welche potenziell schadhafter Code deserialisiert werden kann.</p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<div class="divFooter"></div>

<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../_/js/isyfact.js"></script>
  </body>
</html>
