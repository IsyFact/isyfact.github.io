<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Nutzungsvorgaben Logging: Inhalt :: IsyFact Dokumentation</title>
    <link rel="canonical" href="https://github.com/isyfact/isyfact-standards-doku/latest/isy-logging/nutzungsvorgaben/inhalt.html">
    <meta name="generator" content="Antora 3.0.1">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <link rel="stylesheet" href="../../../../_/css/font-awesome.min.css">
    <link rel="stylesheet" href="../../../../_/css/isyfact.css">
    <script>var uiRootPath = '../../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://github.com/isyfact">IsyFact Dokumentation</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="isyfact-standards-doku" data-version="2.5.0-SNAPSHOT">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../einstieg/einstieg.html">IsyFact Standards</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../einstieg/einstieg.html">Einstieg</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../einstieg/vorstellung.html">Vorstellung der IsyFact</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/vorstellung/isyfact-standards.html">IsyFact-Standards</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/vorstellung/isyfact-erweiterungen.html">IsyFact-Erweiterungen</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/vorstellung/rahmenbedingungen.html">Rahmenbedingungen</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/erste-schritte.html">Erste Schritte</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/produkte.html">Eingesetzte Produkte</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/tutorial/master.html">Tutorial</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/whitepaper.html">Whitepaper</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/migrationsleitfaden-if2/master.html">Migrationsleitfaden IsyFact 2</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../blaupausen/blaupausen.html">Blaupausen</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../blaupausen/referenzarchitektur/master.html">Referenzarchitektur</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../blaupausen/referenzarchitektur-it-system/master.html">Referenzarchitektur IT-System</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-anwendungskern/master.html">Anwendungskern</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-datenzugriff/master.html">Datenzugriff</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-service/master.html">Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-web-gui/master.html">Web GUI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-batch/master.html">Batch</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Vorgaben</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/vorgaben-architektur/master.html">Architektur</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/vorgaben-it-sicherheit/master.html">IT-Sicherheit</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../bausteine/bausteine.html">Bausteine</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Datum &amp; Zeit</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-datetime/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-datetime/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Fehlerbehandlung</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-exception-core/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-exception-core/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">HttpInvoker</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-serviceapi-core/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-serviceapi-core/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Konfiguration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-konfiguration/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-konfiguration/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Logging</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Polling</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-polling/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-polling/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">REST</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-service-rest/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-service-rest/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Sicherheit</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sicherheit/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sicherheit/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Sonderzeichen</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sonderzeichen/konzept/sonderzeichen.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sonderzeichen/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Task Scheduling</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-task/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-task/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Überwachung</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-ueberwachung/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-ueberwachung/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Util</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-util/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../plattform/plattform.html">Plattform</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../methodik/methodik.html">Methodik</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../methodik/namenskonventionen/master.html">Namenskonventionen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../methodik/versionierung/master.html">Versionierung</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../methodik/java-programmierkonventionen/master.html">Java-Programmierkonventionen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../methodik/diagrammerstellung.html">Diagrammerstellung und Modellierung</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/diagrammerstellung/diagramsnet.html">diagrams.net</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/diagrammerstellung/enterprise-architect.html">Enterprise Architect</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../methodik/vorlagen.html">Vorlagen</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/vorlagen/bearbeitung.html">Bearbeitung der AsciiDoc-Vorlagen</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../werkzeuge/werkzeuge.html">Werkzeuge</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../werkzeuge/dokumentation/einleitung/einfuehrung.html">Dokumentation gemäß IsyFact</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../werkzeuge/dokumentation/master-antora.html">Projektseite mit Antora (empfohlen)</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../werkzeuge/seitenvorlage.html">Seitenvorlage</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../werkzeuge/kopiervorlage.html">Kopiervorlage für neue Seiten</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../werkzeuge/dokumentation/master-asciidoctorJ.html">Dokumente mit AsciidoctorJ Extensions</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../werkzeuge/entwicklungsumgebung/master.html">Entwicklungsumgebung</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../werkzeuge/versionierungskontrolle/master.html">Versionierungskontrolle</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../changelog/changelog.html">Changelog</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">IsyFact Standards</span>
    <span class="version">2.5 (DEV)</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../../glossary/latest/glossary/master.html">Glossar</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../glossary/latest/glossary/master.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../../einstieg/einstieg.html">IsyFact Standards</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../einstieg/einstieg.html">2.5 (DEV)</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../isyfact-style-doku/latest/isy-style/styleguide.html">Styleguide</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../isyfact-style-doku/latest/isy-style/styleguide.html">5.4</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../einstieg/einstieg.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../einstieg/einstieg.html">IsyFact Standards</a></li>
    <li><a href="inhalt.html">Nutzungsvorgaben Logging: Inhalt</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Inhalt" data-levels="3">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Nutzungsvorgaben Logging: Inhalt</h1>
<div class="sect1">
<h2 id="grundlagen"><a class="anchor" href="#grundlagen"></a>1. Grundlagen</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In diesem Kapitel sind die Grundlagen des Loggings beschrieben.</p>
</div>
<div class="sect2">
<h3 id="grundprinzipien-des-loggings"><a class="anchor" href="#grundprinzipien-des-loggings"></a>1.1. Grundprinzipien des Loggings</h3>
<div class="paragraph">
<p>Im Folgenden werden zunächst die Grundprinzipien des Loggings beschrieben, die den nachfolgenden Kapiteln zu Grunde liegen und das Logging in der IsyFact geprägt haben.
Diese sollen ein einheitliches Verständnis und „Gefühl“ für das Logging vermitteln.</p>
</div>
<div class="paragraph">
<p><strong>Logs als Ereignisdatenbank:</strong> Logdateien werden häufig als einfache Textdateien verstanden, in die Einträge – vergleichbar mit der Ausgabe von Text in der Konsole – hinzugefügt werden.
Zur Umsetzung eines effizienten Loggings müssen die Logs jedoch vielmehr als Ereignisdatenbank verstanden werden, in die wichtige Ereignisse über die komplette Anwendungslandschaft hinweg aufgenommen werden, um Analysen bzgl. des Verhaltens der Systeme und von wichtigen Systemereignissen zu ermöglichen.
Das Schreiben eines Logeintrags darf daher explizit nicht wie das Schreiben eines Fließtextes in eine Logdatei verstanden werden, sondern wie das Speichern eines Ereignisses in einer Datenbank.
Daher gelten die Prinzipien:</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Logeinträge als Ereignis der Anwendung begreifen</strong></p>
</li>
<li>
<p><strong>Logging als Backend – wie eine Datenbank – begreifen</strong></p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p><strong>Zielgerichtetes Logging:</strong> Logging muss zielgerichtet erfolgen, d.h. das Schreiben eines Logeintrags erfolgt zu einem bestimmten Zweck.
Logeinträge, die von niemandem ausgewertet werden, sind überflüssig.
Logeinträge, die nicht die relevanten Informationen enthalten, um sinnvoll ausgewertet werden zu können, sind unbrauchbar.
Daher gelten die Prinzipien:</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p><strong>Definiere den Zweck</strong>: Für jeden Logeintrag muss klar sein, zu welchem Zweck dieser erstellt wird.</p>
</li>
<li>
<p><strong>Formuliere Ausgaben für einen konkreten Anwendungsfall</strong>*: Das Erstellen eines Logeintrags erfolgt für einen konkreten Anwendungsfall, in dem der Logeintrag später genutzt wird.
Die Inhalte des Logeintrags müssen alle Informationen enthalten, so dass dieser Anwendungsfall effizient ausgeführt werden kann.</p>
</li>
<li>
<p><strong>Definiere den Konsumenten</strong>: Für jeden Logeintrag muss klar sein, wer der Konsument des Logeintrags ist – also durch welchen Akteur der Eintrag später ausgewertet wird.
Dies wird erreicht, in dem jedem Anwendungsfall ein Akteur zugeordnet ist, durch den er ausgeführt wird.</p>
</li>
<li>
<p><strong>Verwende nur Ausgaben, die auch ausgewertet werden</strong>: Logeinträge sind nur dann sinnvoll, wenn sie später auch ausgewertet werden.
Logeinträge, die nicht ausgewertet werden (Selbstzweck), sind zu vermeiden.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p><strong>Logging als Funktionalität der Anwendungen</strong>: Logausgaben sind Teil der Funktionalität der Anwendung und daher gilt:</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p><strong>Logging muss qualitätsgesichert werden</strong>: Logeinträge der Log-Level INFO, WARN, ERROR und FATAL müssen (analog zur fachlichen Funktionalität der Anwendung) einem Review unterzogen werden.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="kennzeichnung-von-logeinträgen"><a class="anchor" href="#kennzeichnung-von-logeinträgen"></a>1.2. Kennzeichnung von Logeinträgen</h3>
<div class="paragraph">
<p>Jeder Logeintrag wird mit einem Log-Level gekennzeichnet.
Darüber hinaus werden Logeinträge bestimmter Level zusätzlich mit einer Log-Kategorie und einem Ereignisschlüssel gekennzeichnet, um die maschinelle Auswertung der Logeinträge zu erleichtern.
Die zugrundeliegenden Konzepte werden in den folgenden Abschnitten erläutert.
Die in <a href="#logszenarien">Logszenarien</a> beschriebenen Szenarien treffen konkrete Vorgaben, wann welche Ausprägungen zu verwenden sind.</p>
</div>
<div class="sect3">
<h4 id="log-level"><a class="anchor" href="#log-level"></a>1.2.1. Log-Level</h4>
<div class="paragraph">
<p>Jeder Logeintrag wird bei seiner Erstellung mit einem Log-Level gekennzeichnet.
Dieses dient der Klassifizierung des Logeintrags im Hinblick auf dessen Wichtigkeit.
Die Wichtigkeit ergibt sich dabei insbesondere aus dem Einfluss des geloggten Ereignisses auf den Systembetrieb.
Darüber hinaus wird der Log-Level zur Steuerung der Granularität der erzeugten Logausgaben verwendet.
So kann das Log-Level bspw. auf INFO gestellt werden, wodurch nur noch Logeinträge der gleichen Kategorie oder darunter (WARN, ERROR; FATAL) erzeugt werden.
Die folgenden Log-Level haben sich dabei im Java-Umfeld etabliert und werden auch in der IsyFact eingesetzt:</p>
</div>
<table id="table-loglevel" class="tableblock frame-all grid-all stretch">
<caption class="title">Tabelle 1. Log-Level</caption>
<colgroup>
<col style="width: 4.7619%;">
<col style="width: 19.0476%;">
<col style="width: 38.0952%;">
<col style="width: 38.0953%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">#</th>
<th class="tableblock halign-left valign-top">Level</th>
<th class="tableblock halign-left valign-top">Inhalt</th>
<th class="tableblock halign-left valign-top">Beispiel(e)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FATAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Schwerwiegende Fehler, von denen sich die Anwendung nicht erholen kann und beendet werden muss ("Unrecoverable Error").
Es ist ein Eingreifen des Betriebs notwendig, um die Anwendung wieder zu starten.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Die Eingabe-Datei eines Batchs kann nicht gelesen werden und der Batch muss beendet werden.</p>
</div>
<div class="paragraph">
<p>OutOfMemoryError.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ERROR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fehler, die zum Abbruch einer Operation geführt haben und behandelt (gefangen und nicht weitergereicht) wurden.
Die Anwendung läuft weiter.
Der Betrieb muss die Fehlerursache analysieren und ggf. Gegenmaßnahmen einleiten, um ein erneutes Auftreten des Fehlers zu verhindern.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Nachbarsystem ist endgültig nicht erreichbar.</p>
</div>
<div class="paragraph">
<p>Datenbank ist nicht erreichbar.</p>
</div>
<div class="paragraph">
<p>Fehlerhafter Satz wurde gelesen.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Beim Durchführen einer Operation ist ein Problem aufgetreten.
Die Operation wurde jedoch grundsätzlich durchgeführt.
Der Betrieb muss im Hinblick auf die Fehleranalyse hierbei (zunächst) nicht aktiv werden.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Aufruf eines Nachbarsystems muss wiederholt werden.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INFO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Status-) Hinweise</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Meldungen über den laufenden Betrieb, zum Beispiel zu verarbeiteten Anfragen, ihrem Ergebnis und ihrer Dauer, Anwendung gestartet/beendet</p>
</div>
<div class="paragraph">
<p>Durchführung eines Retries (bspw. auf Grund eines OptimisticLocking-Fehlers)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEBUG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Erweiterte Informationen, um Details im Programmablauf zur Fehleranalyse nachvollziehen zu können.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Meldungen zu markanten Verarbeitungsschritten (bspw. „ Führe Suche nach Personen durch“)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TRACE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Feingranulare und umfangreiche Informationen als Ergänzung des DEBUG-Levels für besonders schwierige Fehleranalysen.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vollständige HTTP-Kommunikation an einer Schnittstelle (Header, Body, technische Informationen).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><span class="underline">Hinweis zum Log-Level FATAL</span>: SLF4J und damit auch logback (welches <code>isy-logging</code> zugrunde liegt) besitzen kein Log-Level FATAL.
Die Unterscheidung, ob ein Error-Logeintrag „FATAL“ ist oder nicht, kann mit Hilfe von Markern umgesetzt werden.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
Siehe auch bei <a href="../../../../glossary/latest/literaturextern/inhalt.html#litextern-slf4j-fatal" class="xref page">SLF4J FATAL</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>isy-logging</code> stellt Methoden zum Schreiben von Logeinträgen im Level ERROR als auch in FATAL bereit.
Bei beiden wird ein Logeintrag im Level ERROR erzeugt, dieser aber je nach verwendeter Methode mit der Kategorie „FATAL“ oder „ERROR“ versehen.
Das Log-Level FATAL kann aus Sicht eines Aufrufers von <code>isy-logging</code> daher wie alle anderen Level verwendet werden.
Bei der Auswertung ist auf diese Besonderheit jedoch zu achten.</p>
</div>
<div class="sect4">
<h5 id="ausgabe-des-log-levels-fatal"><a class="anchor" href="#ausgabe-des-log-levels-fatal"></a>1.2.1.1. Ausgabe des Log-Levels FATAL</h5>
<div class="paragraph">
<p>Das Log-Level FATAL wird ist durch SLF4J nicht vorgesehen und wird daher auch durch logback nicht unterstützt.
Aus diesem Grund werden Logeinträge die im Level FATAL geschrieben werden, im Level ERROR in die Logdatei geschrieben und mit einer entsprechenden Log-Kategorie (FATAL bzw. ERROR) versehen (siehe auch nachfolgender Abschnitt).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="log-kategorien"><a class="anchor" href="#log-kategorien"></a>1.2.2. Log-Kategorien</h4>
<div class="paragraph">
<p>Log-Kategorien dienen der Klassifizierung der Logeinträge im Hinblick auf deren Zweck.
Dies erleichtert die maschinelle Auswertung der Logs und ermöglicht es, gezielt Logeinträge einer Kategorie gesondert zu behandeln (bspw. deren Ausgabe umzuleiten oder zu verwerfen).
Die Log-Kategorien stellen dabei Verfeinerungen der Log-Level dar.
Log-Kategorien werden ausschließlich im Level INFO verwendet und werden in folgender Tabelle beschrieben:</p>
</div>
<table id="table-UnterLogKat" class="tableblock frame-all grid-all stretch">
<caption class="title">Tabelle 2. Unterscheidung der Log-Kategorien</caption>
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 18.1818%;">
<col style="width: 40.909%;">
<col style="width: 31.8183%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Level</th>
<th class="tableblock halign-left valign-top">Kategorie</th>
<th class="tableblock halign-left valign-top">Beschreibung</th>
<th class="tableblock halign-left valign-top">Beispiel(e)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-middle" rowspan="2"><p class="tableblock">ERROR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FATAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logeinträge des Log-Levels FATAL (vgl. <a href="#ausgabe-des-log-levels-fatal">Ausgabe des Log-Levels FATAL</a>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>siehe Log-Level FATAL</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ERROR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logeinträge des Log-Levels ERROR (vgl. <a href="#ausgabe-des-log-levels-fatal">Ausgabe des Log-Levels FATAL</a>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>siehe Log-Level ERROR</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle" rowspan="4"><p class="tableblock">INFO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JOURNAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Informationen zu Systemzustand, Systemereignissen und durchgeführten Operationen.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Herunterfahren des Systems,</p>
</div>
<div class="paragraph">
<p>Änderung der Konfiguration</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PROFILING</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Informationen zum Laufzeitverhalten des Systems.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dauer der Verarbeitung eines Nachbarsystem­aufrufs</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">METRIK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kennzahlen zum Systembetrieb und zur Systemnutzung.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Erfolgreiche/Fehler­hafte Nutzung einer Service-Methode</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SICHERHEIT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Potentieller) Angriffsversuch.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Benutzer-Account wird gesperrt wegen zu vieler ungültiger Anmeldeversuche</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="ereignisschluessel"><a class="anchor" href="#ereignisschluessel"></a>1.2.3. Ereignisschlüssel</h4>
<div class="paragraph">
<p>Ereignisschlüssel dienen der <em>eindeutigen</em> Identifikation des Zwecks, auf Grund dessen der Logeintrag im Log-Level INFO erstellt wurde (bspw. Erstellung eines Logeintrags beim Verlassen einer Systemgrenze zur Performancemessung).
Dies ist notwendig, da das Log-Level INFO eine Vielzahl unterschiedlicher Auswertungsmöglichkeiten bietet.
Ohne die Verwendung des Schlüssels könnte der Zweck des jeweiligen Eintrags meist nur mit Kenntnis des Quellcodes oder Interpretation der Lognachricht ermittelt werden, was eine maschinelle Auswertung der Einträge erschwert oder gar unmöglich macht.</p>
</div>
<div class="paragraph">
<p>Wenn an mehreren Stellen Logeinträge für den gleichen Zweck erstellt werden, wird hierfür der gleiche Ereignisschlüssel verwendet.
Dies ist bspw. im Logszenario „Loggen fachlicher Operationen“ (siehe <a href="#loggen-fachlicher-operationen">Loggen fachlicher Operationen</a>) der Fall, in dem die Durchführung fachlicher Operationen jeweils mit dem gleichen Ereignisschlüssel geloggt werden, so dass alle diese Einträge mit einer einzelnen Abfrage auf den definierten Schlüssel ausgewertet werden können.</p>
</div>
<div class="paragraph">
<p>In den Log-Leveln FATAL, ERROR und WARN wird der jeweilige Fehlerschlüssel als Ereignisschlüssel verwendet.
In den Log-Leveln DEBUG und TRACE werden keine Ereignisschlüssel Verwendet, da dort der Zweck bereits eindeutig durch den Log-Level (Zweck „Fehleranalyse“) bestimmt ist.
Dadurch kann der Aufwand für die Verwendung der Ereignisschlüssel gering gehalten werden.</p>
</div>
<div class="paragraph">
<p>In <a href="#ereignisschluessel-isy-logging">Ereignisschlüssel isy-logging</a> wird eine Reihe von Standardschlüsseln definiert, die durch das Logging-Framework verwendet werden.
Darüber hinaus können in jeder Anwendung eigene Ereignisschlüssel, für systemspezifische Zwecke, definiert werden.</p>
</div>
<div class="paragraph">
<p>Der Aufbau der Ereignisschlüssel entspricht dem folgenden Schema:</p>
</div>
<table class="tableblock frame-none grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>E[A-Z]{5}[0-9]{2}[0-9]{3}</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Dieses setzt sich aus den folgenden Elementen zusammen:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Jedem Schlüssel wird die feste Zeichenkette „<strong>E</strong>“ vorangestellt, um den Eintrag als Ereignisschlüssel zu Kennzeichnen und zu verhindern, dass dieser mit Fehler- oder Hinweisschlüsseln verwechselt wird.</p>
</li>
<li>
<p><strong>5 Buchstaben</strong>, zur Identifikation des Systems.
Diese ist analog zur Identifikation, die auch bei den Ausnahme-IDs (siehe <a href="../../isy-exception-core/konzept/master.html#einleitung" class="xref page">Konzept Fehlerbehandlung</a>) verwendet wird.</p>
<div class="paragraph">
<p>Anmerkung: Die Systemidentifikation ist Teil des Ereignisschlüssels, um sicherzustellen, dass systemspezifische / bibliotheksspezifische Schlüssel nicht in mehreren Komponenten redundant vergeben werden.</p>
</div>
</li>
<li>
<p><strong>2 Ziffern</strong>, zur eindeutigen Identifikation der Komponente, in der der Logeintrag erstellt wird (Komponenten-ID).
Bei der Erstellung einer neuen Anwendung ist in der Spezifikations- bzw. Konstruktionsphase festzulegen, welche Komponente welche ID zugeordnet wird.
Dies ist ebenfalls analog zur Definition der Ausnahme-IDs – es wird für Ausnahme-IDs und Ereignisschlüssel die gleiche Komponenten-ID verwendet.</p>
</li>
<li>
<p><strong>3 Ziffern</strong>, als laufende Nummer der Ereignisschlüssel der jeweiligen Komponente.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Ein exemplarischer Ereignisschlüssel der Geschäftsanwendung XYZ ist demnach:</p>
</div>
<table class="tableblock frame-none grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>EXYZFA12123</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Der Aufbau des Ereignisschlüssels besitzt darüber hinaus explizit keine weitere Semantik, um Redundanzen mit den weiteren Attributen des Logeintrags zu vermeiden.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="vorgaben-fuer-logdateien"><a class="anchor" href="#vorgaben-fuer-logdateien"></a>1.3. Vorgaben für Logdateien</h3>
<div class="paragraph">
<p>Jede Applikation schreibt <em>eine</em> einzelne Logdatei.
Weitere Logdateien sind nicht erlaubt.
Ausnahmen bilden Logdateien, die durch den Container geschrieben werden, z.B. ein Wrapper- oder Access-Log eines Tomcat-Servers.</p>
</div>
<div class="sect3">
<h4 id="namenskonventionen1"><a class="anchor" href="#namenskonventionen1"></a>1.3.1. Namenskonventionen</h4>
<div class="paragraph">
<p>Die Logdateien haben fest vorgegebene Namen, die dem folgenden Namensschema entsprechen:</p>
</div>
<table class="tableblock frame-none grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>&lt;HOST&gt;_&lt;SYSTEM-ID&gt;_&lt;ZEITSTEMPEL&gt;.log</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Die einzelnen Platzhalter im Namensschema sind in folgender Tabelle beschrieben:</p>
</div>
<table id="table-logdatname" class="tableblock frame-all grid-all stretch">
<caption class="title">Tabelle 3. Bestandteile eines Logdateinamens</caption>
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 42.8571%;">
<col style="width: 28.5715%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Bestandteil</th>
<th class="tableblock halign-left valign-top">Werte</th>
<th class="tableblock halign-left valign-top">Beschreibung</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HOST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">z.B. xyzweb01</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name des Servers, auf dem die Logs entstehen</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SYSTEM-ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Durch den Technischen Chefdesigner für die jeweilige Anwendung in Abstimmung mit dem Auftraggeber festzulegen (siehe <a href="../../methodik/namenskonventionen/master.html#einleitung" class="xref page">IsyFact Namenskonventionen</a>)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Name der Anwendung bzw. des Batches.
<em>Anwendung bezieht sich hierbei auf die Anwendungen, die im Tomcat laufen, in Abgrenzung zu Batches.</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ZEITSTEMPEL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">YYYY-MM-DD_HH00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Datum der Logdateien inkl. stundengenauer Uhrzeit.
Zu beachten ist, dass der Zeitstempel erst beim Rotieren der Logs an die Datei angehängt wird (siehe <a href="#log-rotation-und-komprimierung">Log-Rotation und Komprimierung</a>).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Ein Beispiel des Namens einer Logdatei ist demnach:</p>
</div>
<table class="tableblock frame-none grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><div class="content"><div class="paragraph">
<p><code>xyzweb01_abc_2007-09-16_0900.log</code><br>
(Log vom 16. September 2007 ~9 Uhr, von der Anwendung bzw. dem Batch ABC auf dem Server xyzweb01)</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="speicherort"><a class="anchor" href="#speicherort"></a>1.3.2. Speicherort</h4>
<div class="paragraph">
<p>Um die Logdateien durch die Infrastruktur möglichst einfach weiterverarbeiten zu können, werden Logdateien in einem definierten Logverzeichnis je Host abgelegt, welches Unterverzeichnisse für jede Anwendung besitzt.
Diese Verzeichnishierarchie ist für alle Anwendungen und Umgebungen gleich, um den Pflegeaufwand für diese Aufgabe so gering wie möglich zu halten.</p>
</div>
<div class="paragraph">
<p>Logdateien müssen entsprechend dem folgenden Schema abgelegt werden:</p>
</div>
<table class="tableblock frame-none grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><div class="content"><div class="paragraph">
<p><code>/var/log/&lt;SYSTEM-ID&gt;/&lt;LOGDATEI&gt;</code></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Bei der Einführung einer neuen Anwendung ist die System-ID (Anwendungsname/Batch-ID) entsprechend abzustimmen und der Betrieb darüber in Kenntnis zu setzen.</p>
</div>
</div>
<div class="sect3">
<h4 id="log-rotation-und-komprimierung"><a class="anchor" href="#log-rotation-und-komprimierung"></a>1.3.3. Log-Rotation und Komprimierung</h4>
<div class="paragraph">
<p>Um zu verhindern, dass Logdateien zu groß werden und es gleichzeitig zu ermöglichen, die Logdateien nur für bestimmte Fristen vorzuhalten, werden die anfallenden Logeinträge stündlich in neue Dateien geschrieben (rollierendes Logging).</p>
</div>
<div class="paragraph">
<p>Zu beachten ist, dass für den Zeitstempel der rotierten Logdateien die Zeitzone UTC verwendet wird – analog zum Zeitstempel der einzelnen Logeinträge.
Dieser kann von der Systemzeit des Systems abweichen.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="einsatz-des-logging-frameworks"><a class="anchor" href="#einsatz-des-logging-frameworks"></a>2. Einsatz des Logging-Frameworks</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In diesem Abschnitt wird der Einsatz des Logging-Frameworks <code>isy-logging</code> beschrieben.</p>
</div>
<div class="sect2">
<h3 id="aufruf-des-frameworks"><a class="anchor" href="#aufruf-des-frameworks"></a>2.1. Aufruf des Frameworks</h3>
<div class="paragraph">
<p>Zur Erstellung von Logeinträgen gibt es drei Schnittstellen, die jeweils ein spezifisches Anwendungsszenario umsetzen: <code>IsyLoggerStandard</code>, <code>IsyLoggerFachdaten</code> und <code>IsyLoggerTypisiert</code>.
Wird innerhalb einer Klasse mehr als ein Anwendungsszenario verwendet, kann die Schnittstelle <code>IsyLogger</code> verwendet werden, welche alle drei Schnittstellen umfasst.</p>
</div>
<div class="paragraph">
<p>Jede Klasse, in der Logs geschrieben werden, muss eine eigene Logger-Instanz verwenden.
Es ist nicht vorgesehen Logger zu vererben.
Die Erzeugung der Logger-Instanz erfolgt mit der Logger-Factory, die durch <code>isy-logging</code> bereitgestellt wird.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class MyClass {
...
private static final IsyLogger LOG = IsyLoggerFactory.getLogger(MyClass.class);
... oder ...
private static final IsyLoggerStandard LOG = IsyLoggerFactory.getLogger(MyClass.class);
... oder ...
private static final IsyLoggerFachdaten LOG = IsyLoggerFactory.getLogger(MyClass.class);
... oder ...
private static final IsyLoggerTypisiert LOG = IsyLoggerFactory.getLogger(MyClass.class);
...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Der Name des Loggers muss dem Namen der Klasse entsprechen, in welcher der Logger instanziiert wird – dazu wird die Klasse beim Aufruf der Factory übergeben.
Dies ist notwendig, um Logeinträge ihrer Quelle zuordnen zu können.</p>
</div>
<div class="paragraph">
<p>Zwar stellt der Logger eine Vielzahl von Methoden bereit, allerdings unterscheidet sich der Aufruf kaum von den üblichen Methoden anderer Frameworks – die Vielzahl der Methoden ergibt sich primär durch die Bereitstellung unterschiedlich typisierter Methoden zum Loggen von Ausnahmen, datenschutzrelevanter Daten und der Verwendung von Markern.</p>
</div>
<div class="paragraph">
<p><span class="underline">Anmerkungen</span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Die Schnittstelle bietet nicht alle bzw. andere Methoden an, als bspw. SLF4J.
Dies ist beabsichtigt, um die Log-Inhalte in Systemen, die gemäß der IsyFact entwickelt werden, besser standardisieren zu können.
Drittsoftware (bspw. Frameworks wie Hibernate, Spring etc.) oder Systeme, die schrittweise auf das Logging-Framework migriert werden, nutzen automatisch die Logger-Schnittstelle, die durch logback bereitgestellt wird (zum Umgang mit Drittsoftware siehe <a href="#umgang-mit-drittsoftware">Umgang mit Drittsoftware</a>).</p>
</li>
<li>
<p>Die Logeinträge werden beim Schreiben einheitlich mit einem Zeitstempel der Zeitzone „UTC“ versehen.
Hierauf kann beim Aufruf des Loggers keinen Einfluss genommen werden.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="loggen-von-technischen-daten"><a class="anchor" href="#loggen-von-technischen-daten"></a>2.1.1. Loggen von technischen Daten</h4>
<div class="paragraph">
<p>Zum Loggen von technischen und nicht datenschutzrelevanten Daten bietet <code>isy-logging</code> die Schnittstelle <code>IsyLoggerStandard</code> an. <a href="#image-SS-IsyLoggerStandard">Abbildung 1</a> zeigt eine Übersicht der Schnittstelle:</p>
</div>
<div id="image-SS-IsyLoggerStandard" class="imageblock text-center">
<div class="content">
<img src="../_images/nutzungsvorgaben/SS-IsyLoggerStandard.png" alt="SS IsyLoggerStandard">
</div>
<div class="title">Abbildung 1. Schnittstelle IsyLoggerStandard</div>
</div>
<div class="sect4">
<h5 id="loggen-einfacher-nachrichten-tracedebugwarninfo"><a class="anchor" href="#loggen-einfacher-nachrichten-tracedebugwarninfo"></a>2.1.1.1. Loggen einfacher Nachrichten (TRACE/DEBUG/WARN/INFO)</h5>
<div class="paragraph">
<p>Die folgenden Methoden dienen der <em>einfachen</em> Ausgabe von Lognachrichten:</p>
</div>
<div id="listing-MethodenEinfachesLogging" class="listingblock">
<div class="title">Listing 1. Methoden zur einfachen Ausgabe von Lognachrichten</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">trace(String nachricht, Object... werte)
debug(String nachricht, Object... werte)
warn(String schlussel, String nachricht, Object... werte)
info(LogKategorie kategorie, String schlussel, String nachricht, Object... werte)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Der Aufruf wird an die entsprechende Methode des SLF4J-Loggers (mit gleicher Signatur) delegiert.
Dabei werden alle Werte (d.h. die Inhalte für Platzhalter in der Nachricht) zusätzlich als Marker übergeben, so dass sie im Logeintrag als separate Attribute ausgegeben werden können und damit einfacher auswertbar sind:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>parameter1</code>: werte[1].</p>
</li>
<li>
<p><code>parameter2</code>: werte[2].</p>
</li>
<li>
<p>etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Beispiel: Der Aufruf</p>
</div>
<div id="listing-AufrufMarker" class="listingblock">
<div class="title">Listing 2. Aufruf mit Attributen</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">debug("Die Methode {} wurde mit dem Parameter {} aufgerufen.", "addiere", "5")</code></pre>
</div>
</div>
<div class="paragraph">
<p>ergänzt die folgenden Attribute im Logeintrag:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>parameter1</code>: addiere</p>
</li>
<li>
<p><code>parameter2</code>: 5</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="loggen-von-ausnahmen-fatalerrorwarninfo"><a class="anchor" href="#loggen-von-ausnahmen-fatalerrorwarninfo"></a>2.1.1.2. Loggen von Ausnahmen (FATAL/ERROR/WARN/INFO)</h5>
<div class="paragraph">
<p>In den Log-Leveln FATAL, ERROR und WARN existieren je drei Methoden zum Loggen von Exceptions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;fatal/error/warn&gt;(String nachricht, BaseException exception, Object&#8230;&#8203; werte)</code></p>
</li>
<li>
<p><code>&lt;fatal/error/warn&gt;(String nachricht, TechnicalRuntimeException exception, Object&#8230;&#8203; werte)</code></p>
</li>
<li>
<p><code>&lt;fatal/error/warn&gt;(String schluessel, String nachricht, Throwable exception, Object&#8230;&#8203; werte)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Für das Log-Level INFO wird zusätzlich eine Log-Kategorie benötigt.
Beim Loggen einer IsyFact-eigenen Ausnahme wird der Fehlerschlüssel automatisch als Ereignisschlüssel übernommen.
Bei anderen Ausnahmen muss zusätzlich ein Ereignisschlüssel übergeben werden.</p>
</div>
<div class="paragraph">
<p>Der Aufruf wird an die entsprechende Methode des SLF4J-Loggers delegiert.
Als Marker werden dabei übergeben:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>fehlerschluessel</code>: Fehlerschlüssel der <code>BaseException</code>.</p>
</li>
<li>
<p><code>parameter[1..n]</code>: siehe oben (<a href="#loggen-einfacher-nachrichten-tracedebugwarninfo">Loggen einfacher Nachrichten (TRACE/DEBUG/WARN/INFO)</a>)</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="loggen-von-informationen-info"><a class="anchor" href="#loggen-von-informationen-info"></a>2.1.1.3. Loggen von Informationen (INFO)</h5>
<div class="paragraph">
<p>Zum Erstellen von INFO-Logeinträgen wird die folgende Methode bereitgestellt:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>info(LogKategorie kategorie, String schluessel, String nachricht, Object&#8230;&#8203; werte)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Der Aufruf wird an die entsprechende Methode des SLF4J-Loggers delegiert.
Als Marker werden dabei übergeben:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>kategorie</code>: Mit dem Wert des übergebenen Parameters</p>
</li>
<li>
<p><code>schluessel</code>: Mit dem Wert des übergebenen Parameters</p>
</li>
<li>
<p><code>parameter[1..n]</code>: siehe oben (<a href="#loggen-einfacher-nachrichten-tracedebugwarninfo">Loggen einfacher Nachrichten (TRACE/DEBUG/WARN/INFO)</a>)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="loggen-fachlicher-daten"><a class="anchor" href="#loggen-fachlicher-daten"></a>2.1.2. Loggen von fachlichen Daten</h4>
<div class="paragraph">
<p>Lognachrichten dürfen gemäß dem Grundsatz der Datensparsamkeit nur die fachlichen Daten enthalten, die für den Betrieb der jeweiligen Anwendung unbedingt notwendig sind.
Fachliche Daten sind in der Regel alle Teile des fachlichen Datenmodells.
Sie unterliegen häufig den Auflagen des Datenschutzes.
Eine Ausnahme stellen fachliche IDs dar; sie werden nicht als fachliches Datum behandelt.
Welche weiteren Daten als fachlich anzusehen sind, muss in der Systemspezifikation festgelegt werden.
Welche fachlichen Daten im Log enthalten sein müssen, muss im Systementwurf festgelegt werden.</p>
</div>
<div class="paragraph">
<p>Die folgenden zwei Beispiele verdeutlichen, warum es notwendig sein kann, fachliche Daten ins Log aufzunehmen:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Die Daten ermöglichen die in <a href="#auswertungen">Auswertungen</a> definierten Auswertungen.</p>
</li>
<li>
<p>Zur generellen Analyse von Fehlern an einer Schnittstelle werden einige der an ihr übertragenen Daten benötigt.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Zum Loggen fachlicher Daten bietet <code>isy-logging</code> die Schnittstelle <code>IsyLoggerFachdaten</code> an.
<a href="#image-SS-IsyLoggerFachdaten">Abbildung 2</a> zeigt eine Übersicht der Schnittstelle.</p>
</div>
<div id="image-SS-IsyLoggerFachdaten" class="imageblock text-center">
<div class="content">
<img src="../_images/nutzungsvorgaben/SS-IsyLoggerFachdaten.png" alt="SS IsyLoggerFachdaten">
</div>
<div class="title">Abbildung 2. Schnittstelle IsyLoggerFachdaten</div>
</div>
<div class="paragraph">
<p>Zu allen Methoden, die in <a href="#loggen-von-technischen-daten">Loggen von technischen Daten</a> beschrieben wurden, bietet die Schnittstelle <code>IsyLoggerFachdaten</code> eine äquivalente Methode mit gleicher Signatur an, die zum Loggen fachlicher Daten im jeweiligen Log-Level verwendet wird.
Die Methoden tragen dabei jeweils das Suffix <code>Fachdaten</code> im Namen.</p>
</div>
<div class="paragraph">
<p>Eine besondere Rolle innerhalb der fachlichen Daten spielen personenbezogenen Daten und insbesondere Daten gemäß Artikel 9 DSGVO.
Diese sollten nur in absoluten Ausnahmefällen ins Log geschrieben werden und müssen zwingend mit speziellen Markern versehen werden (s. <a href="#verwendung-von-markern-in-logeinträgen">Verwendung von Markern in Logeinträgen</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="verwendung-von-markern-in-logeinträgen"><a class="anchor" href="#verwendung-von-markern-in-logeinträgen"></a>2.1.3. Verwendung von Markern in Logeinträgen</h4>
<div class="paragraph">
<p>Zum beliebigen Markieren von Logeinträgen bietet <code>isy-logging</code> die Schnittstelle <code>IsyLoggerTypisiert</code> an.
<a href="#image-SS-IsyLoggerTypisiert">Abbildung 3</a> zeigt eine Übersicht der Schnittstelle:</p>
</div>
<div id="image-SS-IsyLoggerTypisiert" class="imageblock text-center">
<div class="content">
<img src="../_images/nutzungsvorgaben/SS-IsyLoggerTypisiert.png" alt="SS IsyLoggerTypisiert">
</div>
<div class="title">Abbildung 3. Schnittstelle IsyLoggerTypisiert</div>
</div>
<div class="paragraph">
<p>Die in <a href="#loggen-fachlicher-daten">Loggen von fachlichen Daten</a> beschriebene Funktionalität verwendet intern einen festen Marker, um einen Logeintrag als datenschutzrelevant („Fachdaten“) zu kennzeichnen.
Die Schnittstelle <code>IsyLoggerTypisiert</code> ermöglicht es Anwendungen darüber hinaus, Logeinträge mit beliebigen Markern zu versehen.</p>
</div>
<div class="paragraph">
<p>Zu allen Methoden, die in <a href="#loggen-von-technischen-daten">Loggen von technischen Daten</a> beschrieben wurden, bietet die Schnittstelle <code>IsyLoggerTypisiert</code> eine äquivalente Methode mit gleicher Signatur an, die zum Markieren der jeweiligen Logeinträge verwendet werden kann.
Die Methoden besitzen jeweils einen zusätzlichen Parameter vom Typ <code>IsyDatentypMarker</code>.
Anwendungen können ihre Marker von der Klasse <code>AbstractIsyDatentypMarker</code> ableiten.</p>
</div>
<div class="paragraph">
<p>Für die Kennzeichnung von personenbezogenen Daten und für Daten gemäß Artikel 9 DSGVO werden von <code>isy-logging</code> die Marker <code>PersonenbezogeneDatenMarker</code> und <code>DsgvoArtikel9DatenMarker</code> bereitgestellt.
Sie werden zusammen mit der Schnittstelle <code>IsyLoggerTypisiert</code> verwendet:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>LOG.info(LogKategorie.JOURNAL, DsgvoArtikel9DatenMarker.INSTANZ, "schluessel", "nachricht")</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="verwendung-von-platzhaltern-in-nachrichten"><a class="anchor" href="#verwendung-von-platzhaltern-in-nachrichten"></a>2.1.4. Verwendung von Platzhaltern in Nachrichten</h4>
<div class="paragraph">
<p>In den Lognachrichten können Platzhalter verwendet werden, die beim Erstellen des Logeintrags mit  den konkreten Werten des aktuellen Aufrufs ersetzt werden (bspw. gemessene Laufzeit).</p>
</div>
<div class="paragraph">
<p>Platzhalter sind in den Nachrichten durch geschweifte Klammern <code>{}</code> zu kennzeichnen, bspw.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// RICHTIG:
LOG.debug("Die Methode {} wurde mit dem Parameter {} aufgerufen.", method.getName(), wert)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Die Verwendung des Parameters <code>werte</code> zum Ersetzen der Platzhalter ermöglicht es zudem, die übergebenen Parameter als separate Attribute in den Logeintrag zu übernehmen (siehe vorhergehende Abschnitte), was die Auswertbarkeit der Einträge erleichtert.
Zudem wird die Performance des Systems leicht erhöht, da die Konkatenation des Strings nur dann erfolgt, wenn der Logeintrag auch geschrieben wird (d.h. der Log-Level eingeschaltet ist) – dieser Performance-Gewinn ist jedoch vernachlässigbar und nicht die eigentliche Motivation dieser Vorgehensweise.</p>
</div>
<div class="paragraph">
<p>Das direkte Konkatenieren von Zeichenketten zum Aufbau einer Lognachricht ist nicht erlaubt:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">//FALSCH:
LOG.debug("Die Methode " + method.getName() + " wurde mit dem Parameter " + wert + " aufgerufen.")</code></pre>
</div>
</div>
<div class="paragraph">
<p>Das früher weitverbreitete <code>isDebugEnabled</code> ist im Normalfall nicht mehr notwendig (da die Konkatenation durch logback nur stattfindet, wenn der Logeintrag auch geschrieben wird) und sollte daher auch nicht mehr verwendet werden, um den Code übersichtlich zu halten:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">//FALSCH:
if (LOG.isDebugEnabled()) {
  LOG.debug("Die Methode {} wurde mit dem Parameter {} aufgerufen.", method.getName(), wert).
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ausnahme ist hierbei jedoch das Loggen komplexer Meldungen:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">//RICHTIG:
if (LOG.isDebugEnabled()) {
   LOG.debug("Debug-Meldung: {} ", myObject.complexMethod());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In diesem Code-Beispiel wird sehr viel Rechenzeit verbraucht, um die Log-Information von der Methode <code>myObject.complexMethod()</code> zu bekommen.
Um den komplexen Aufruf nur durchzuführen, wenn der Logeintrag auch wirklich geschrieben wird, ist es in diesem Fall sinnvoll die Prüfung <code>isDebugEnabled</code> durchzuführen.</p>
</div>
</div>
<div class="sect3">
<h4 id="hilfsklassen"><a class="anchor" href="#hilfsklassen"></a>2.1.5. Hilfsklassen</h4>
<div class="paragraph">
<p><code>isy-logging</code> stellt die folgenden Hilfsklassen zum Erstellen von Logeinträgen bereit.</p>
</div>
<div class="sect4">
<h5 id="loggingmethodinterceptor-und-loggingmethodinvoker"><a class="anchor" href="#loggingmethodinterceptor-und-loggingmethodinvoker"></a>2.1.5.1. LoggingMethodInterceptor und LoggingMethodInvoker</h5>
<div class="paragraph">
<p>Die Klassen <code>LoggingMethodInterceptor</code> und <code>LoggingMethodInvoker</code> bieten die Möglichkeit, einheitliche Logeinträge vor und nach dem Aufruf einer Methode für verschiedene Zwecke (insbesondere dem Messen der Laufzeit für das Profiling) zu erstellen.
Beide erzeugen die gleichen Logeinträge, dienen jedoch unterschiedlichen Einsatzzwecken.</p>
</div>
<div class="paragraph">
<p>Der Interceptor wird per Spring als Method-Interceptor konfiguriert und kann dadurch querschnittlich für eingehende Methodenaufrufe konfiguriert werden – dies wird in <a href="#logbackconfiglistener">[logbackconfiglistener]</a> beschrieben.</p>
</div>
<div class="paragraph">
<p>Der Invoker wird direkt im Anwendungscode für die Durchführung von Methodenaufrufen verwendet.
Zur Verwendung des Invokers, muss eine Instanz des Interceptors als Klassenvariable erstellt werden:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class MyClass {
private static final LoggingMethodInterceptor _LOG_INTERCEPTOR_ = new LoggingMethodInterceptor(true, true, false, false);
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Der Konstruktor besitzt folgende Signatur:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>LoggingMethodInvoker(Method methode, IsyLogger logger, boolean loggeAufruf, boolean loggeErgebnis, boolean loggeDauer, boolean loggeDaten, boolean loggeDatenBeiException, long loggeMaximaleParameterGroesse)</code>: Methode ist die aufzurufende Methode.
Die Flags werden verwendet, um zu steuern, welche Logeinträge erstellt werden (siehe unten).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Das Loggen eines Methodenaufrufs erfolgt mit der Methode:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>fuehreMethodeAus(Object zielobjekt, Object&#8230;&#8203; parameter)</code>: Ruft per Reflection die Methode, welche per Konstruktor gesetzte wurde, auf dem Zielobjekt mit den übergebenen Parametern auf und schreibt die Logeinträge mit folgenden Ereignisschlüsseln (Details zu den Inhalten der jeweiligen Logeinträge finden sich in Kapitel <a href="#ereignisschluessel-isy-logging">Ereignisschlüssel isy-logging</a>):</p>
</li>
</ul>
</div>
<table id="table-ESLogMthdInvk" class="tableblock frame-all grid-all stretch">
<caption class="title">Tabelle 4. Ereignisschlüssel LoggingMethodInvoker</caption>
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Ereignisschlüssel LoggingMethodInvoker</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Falls loggeAufruf = true</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO01001</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Falls loggeErgebnis = true und keine Exception geliefert wurde</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO01002</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Falls loggeErgebnis = true und eine Exception geliefert wurde</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO01003</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Falls loggeDauer = true und keine Exception geliefert wurde</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO01004</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Falls loggeDauer = true und eine Exception geliefert wurde</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO01005</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Darüber hinaus werden folgende Debug-Logeinträge erstellt:</p>
</div>
<table id="table-DbgLogEntry" class="tableblock frame-all grid-all stretch">
<caption class="title">Tabelle 5. Debug Logeinträge</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Level</th>
<th class="tableblock halign-center valign-top">Text</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>Falls loggeDatenBeiException = true</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">DEBUG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Die &lt;Klasse. Methode&gt; wurde mit folgenden Parametern aufgerufen &lt;Parameter&gt;.</p>
<p class="tableblock">             ANMERKUNG: Der Logeintrag wird als „Fachdaten“ gekennzeichnet.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>Falls loggeDaten = true und eine Exception geliefert wurde</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">DEBUG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Die &lt;Klasse. Methode&gt; wurde mit folgenden Parametern aufgerufen &lt;Parameter&gt;.</p>
<p class="tableblock">             ANMERKUNG: Der Logeintrag wird als „Fachdaten“ gekennzeichnet.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>Falls Debug-Einträge erstellt werden und ein Parameter zu groß ist</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">DEBUG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Die &lt;Klasse.Methode&gt; wurde mit einem zu großen Parameter aufgerufen.
             Position: &lt;Position des Parameters&gt;, Klasse: &lt;Klasse des Parameters&gt;</p>
<p class="tableblock">             ANMERKUNG: Der Logeintrag wird als „Fachdaten“ gekennzeichnet. Außerdem werden zu große Parameter
             in den oben genannten Logeinträgen durch „&lt;Maximale Größe überschritten&gt;“ ersetzt.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Den Aufrufen von Nachbarsystemen kommt eine besondere Wichtigkeit bei der Analyse des Laufzeitverhaltens von Systemen zu.
Daher stellt der Invoker für Methodenaufrufe von Nachbarsystemen einen eigenen Konstruktor bereit:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>LoggingMethodInvoker(Method methode, IsyLogger logger, boolean loggeAufruf, boolean loggeErgebnis, boolean loggeDauer, boolean loggeDaten, boolean loggeDatenBeiException , long loggeMaximaleParameterGroesse, String nachbarsystemName, String nachbarsystemUrl)</code>: Analog zu oben, nur das der Name und die URL des aufgerufenen Nachbarsystems übergeben wird.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Dieser Konstruktor ist beim Aufruf einer Service-Schnittstelle eines Nachbarsystems zu verwenden (vgl. auch Szenario „Performance überwachen“ in <a href="#performance-ueberwachen">Performance überwachen</a>).
Zu beachten ist, dass die Klasse <code>IsyHttpInvokerClientInterceptor</code>, welche durch den Baustein Service bereitgestellt wird (siehe <a href="../../blaupausen/detailkonzept-komponente-service/master.html#einleitung" class="xref page">Detailkonzept Komponente Service</a>), bereits einen entsprechenden Aufruf des Invokers durchführt.
Bei Verwendung dieses Konstruktors werden die Logeinträge mit folgenden Ereignisschlüsseln erstellt:</p>
</div>
<div class="paragraph">
<p>Ereignisschlüssel LoggingMethodInvoker (Nachbarsystemaufruf)</p>
</div>
<table id="table-ESLogMthdInvkNSAufr" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Ereignisschlüssel LoggingMethodInvoker (Nachbarsystemaufruf)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Falls loggeAufruf = true</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO01011</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Falls loggeErgebnis = true und keine Exception geliefert wurde</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO01012</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Falls loggeErgebnis = true und eine Exception geliefert wurde</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO01013</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Falls loggeDauer = true und keine Exception geliefert wurde</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO01014</code></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Falls loggeDauer = true und eine Exception geliefert wurde</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO01015</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="logapplicationlistener"><a class="anchor" href="#logapplicationlistener"></a>2.1.5.2. LogApplicationListener</h5>
<div class="paragraph">
<p>Die Hilfsklasse <code>LogApplicationListener</code> dient dem Loggen von Änderungen des Systemzustands.
Sie muss gemäß <a href="#logapplicationlistener-1">LogApplicationListener</a> als Spring-Bean konfiguriert, aber danach nicht mehr explizit aufgerufen werden.
Die Klasse erstellt die Logeinträge mit folgenden Ereignisschlüsseln (Details zu den Inhalten der jeweiligen Logeinträge finden sich in <a href="#ereignisschluessel-isy-logging">Ereignisschlüssel isy-logging</a>):</p>
</div>
<table id="table-ESLogAppLstn" class="tableblock frame-all grid-all stretch">
<caption class="title">Tabelle 6. Ereignisschlüssel LogApplicationListener</caption>
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Ereignisschlüssel LogApplicationListener</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Beim Starten einer Anwendung / eines Batches</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO02001</code>, <code>EISYLO02003</code> und je ein Eintrag mit Schlüssel <code>EISYLO02004</code> für die folgenden Parameter: Java-Version, Zeitzone, Heap-Size, File-Encoding</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Beim Stoppen einer Anwendung / eines Batches</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO02002</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="mdchelper"><a class="anchor" href="#mdchelper"></a>2.1.5.3. MdcHelper</h5>
<div class="paragraph">
<p>Die Klasse MdcHelper erleichtert das Setzen von Informationen im MDC (Mapped Diagnostic Context).</p>
</div>
<div class="paragraph">
<p>Es werden Methoden zum Setzen und Lesen der Korrelations-ID bereitgestellt:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>pushKorrelationsId(…): Zum „pushen“ einer neuen Korrelations-ID in den MDC.
Dies bedeutet: Wenn die Korrelations-ID „X“ gesetzt wird, wird diese im Attribut „korrelationsid“ im MDC gesetzt.
Sollte dieses Attribut bereits gesetzt sein (bspw. mit der Korrelations-ID „Y“), so wird das Attribut durch „Y;X“ ersetzt.</p>
</li>
<li>
<p><code>liesKorrelationsId()</code>: Liest die Korrelations-ID aus dem MDC.</p>
</li>
<li>
<p><code>entferneKorrelationsId()</code>: Entfernt die zuletzt „gepushte“ Korrelations-ID (bspw. „Y;X“ wird zu „Y“).</p>
</li>
<li>
<p><code>entferneKorrelationsIds()</code>: Entfernt alle Korrelations-IDs.</p>
<div class="paragraph">
<p>Darüber hinaus werden Methoden zum Kennzeichen der Inhalte im MDC als fachlich bereitgestellt (vgl. Abschnitt <a href="#loggen-fachlicher-daten">Loggen von fachlichen Daten</a>):</p>
</div>
</li>
<li>
<p><code>setzeMarkerFachdaten(&#8230;&#8203;)</code>: Markiert den MDC als fachlich / nicht fachlich.</p>
</li>
<li>
<p><code>liesMarkerFachdaten()</code>: Gibt an, ob der MDC fachliche Daten enthält.</p>
</li>
<li>
<p><code>entferneMarkerFachdaten()</code>: Entfernt den Marker für Fachdaten.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="mcdfilter"><a class="anchor" href="#mcdfilter"></a>2.1.6. MDC-Filter</h4>
<div class="paragraph">
<p>Durch die Spring-Autokonfiguration in <code>isy-aufrufkontext</code> wird ein Servlet-Filter erstellt, welcher automatisch bei jedem Request die Korrelations-ID aus dem Http-Header ausliest und in den MDC setzt.
Ist der Header nicht gesetzt, wird eine neue Korrelations-ID generiert.</p>
</div>
</div>
<div class="sect3">
<h4 id="diagnosekontext-korrelations-id"><a class="anchor" href="#diagnosekontext-korrelations-id"></a>2.1.7. Diagnosekontext / Korrelations-ID</h4>
<div class="paragraph">
<p>Die Korrelations-ID (siehe <a href="master.html#einleitung" class="xref page">Logging - Konzept</a>) ist in jedem Eintrag mitzuloggen, damit die Logeinträge einzelnen Aufrufen zugeordnet und über die Komponenten der <a href="../../../../glossary/latest/glossary/master.html#glossar-anwendungslandschaft" class="xref page">Anwendungslandschaft</a> verfolgt werden können.
Das Ermitteln der Korrelations-ID erfolgt automatisch durch <code>isy-logging</code>.
Hierzu wird der Mapped Diagnostic Context (MDC) verwendet, der durch SLF4J bzw. logback zur Verfügung gestellt wird.
Der MDC wird über eine statische Methode gesetzt, und zwar pro Thread:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>MDC.put("Korrelations-ID", "&lt;Korrelations-ID&gt;");</pre>
</div>
</div>
<div class="paragraph">
<p>Die Korrelations-ID kann sich aus mehreren Unique-IDs zusammensetzen, durch die der Aufruf durch die Anwendungslandschaft nachverfolgt werden kann.
Die IDs müssen hintereinander gehängt, getrennt durch ein Semikolon, im Kontext gesetzt werden, bspw.:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>MDC.put("Korrelations-ID", "c15638a2-4c38-4d18-b887-5ebd2a1c427d;f60143b3-3408-4501-9947-240ec1c48667;c893d44f-3b8e-446e-a360-06a520440e64");</pre>
</div>
</div>
<div class="paragraph">
<p>Am Ende der Verarbeitung ist der MDC wieder zu entfernen:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>MDC.remove("Korrelations-ID");</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Anmerkung zu Multi-Threading</strong></p>
</div>
<div class="paragraph">
<p>Es wird davon ausgegangen, dass es innerhalb eines Request kein Multi-Threading gibt, sondern nur in den Clients.
Da der Client einem bestimmten Benutzer zugeordnet werden kann, wird hier kein MDC benötigt.</p>
</div>
<div class="paragraph">
<p>Sollte jedoch Multi-Threading innerhalb eines Requests vorhanden sein, so ist der MDC dem Thread mitzugeben.
Somit müssen alle Klassen, die das Interface Runnable implementieren, eine Methode vorsehen, um den MDC von der Klasse zu bekommen, die den Thread startet.
Ansonsten besitzt der gestartete Thread nicht den Kontext des aufrufenden Threads.
Zusätzlich muss im Thread eine weitere Unique-ID an die Korrelations-ID im MDC angehängt werden, so dass auch die Logeinträge des Threads eindeutig identifiziert werden können.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="konfiguration"><a class="anchor" href="#konfiguration"></a>2.2. Konfiguration</h3>
<div class="paragraph">
<p>In diesem Abschnitt werden die notwendigen Konfigurationen zum Einrichten des Loggings beschrieben.
Die Konfiguration erfolgt dabei ausschließlich über die Konfigurationsdatei von logback und Spring – <code>isy-logging</code> besitzt selbst keine zusätzliche Konfigurationsdatei.</p>
</div>
<div class="sect3">
<h4 id="logback-konfiguration"><a class="anchor" href="#logback-konfiguration"></a>2.2.1. Logback-Konfiguration</h4>
<div class="paragraph">
<p>Folgende Aspekte sind bei der Logback-Konfiguration zu beachten:</p>
</div>
<div class="paragraph">
<p><span class="underline">Konfigurationsdateien</span></p>
</div>
<div class="paragraph">
<p>Alle Anwendungen dürfen ihre Logging-Konfiguration ausschließlich über die Konfigurationsdateien <code>logback.xml</code> und <code>application.properties</code> vornehmen.
Die Auslieferung der Logging-Konfiguration geschieht mit den applikationsspezifischen Konfigurationsdateien für die jeweilige Umgebung.
Die Ablage der Konfigurationsdatei in Sourcen und Kompilaten ist durch das <a href="../../isy-konfiguration/konzept/master.html#einleitung" class="xref page">Konzept Konfiguration</a>) definiert.
Die Konfigurationsdateien dürfen nicht in einem Archiv (JAR-Bibliothek) abgelegt werden, sondern müssen als einzelne Dateien installiert werden.</p>
</div>
<div class="paragraph">
<p><span class="underline">Konfiguration des Log-Levels</span></p>
</div>
<div class="paragraph">
<p>In Produktion ist die Konfiguration in aller Regel fix, da sie auf die betriebliche Infrastruktur abgestimmt sein muss.
In der Produktionsumgebung darf daher nur der Log-Level angepasst werden.
Der Log-Level wird über <code>application.properties</code> eingestellt.
Damit dies funktioniert, wird das Attribut <code>level</code> bei der Definition der Logger in <code>logback.xml</code> weggelassen.
Standardmäßig werden die Systeme in Produktion im Log-Level INFO betrieben.
Bei Bedarf kann jedoch auf DEBUG und in Ausnahmefällen auf TRACE gewechselt werden, um detaillierte Informationen zur Fehleranalyse bereitzustellen.
Andere Log-Level sind zu vermeiden.</p>
</div>
<div class="sect4">
<h5 id="anwendungen-zeitbasiertes-rollieren"><a class="anchor" href="#anwendungen-zeitbasiertes-rollieren"></a>2.2.1.1. Anwendungen (zeitbasiertes Rollieren)</h5>
<div class="paragraph">
<p>Die Bibliothek <code>isy-logging</code> stellt bereits einen vorkonfigurierten Appender bereit, durch den Logdateien gemäß den in <a href="#vorgaben-fuer-logdateien">Vorgaben für Logdateien</a> definierten Vorgaben erstellt werden.
In der Anwendung bzw. im Batch selbst ist daher nur noch eine minimale Logging-Konfiguration notwendig:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;configuration scan="true" scanPeriod="1 minutes"&gt;
&lt;!-- Eindeutige mIdentifikation der Instanz der Anwendung. --&gt;
&lt;contextName&gt;testserver_testsystem&lt;/contextName&gt;
&lt;!-- Pfad der Logdatei, ohne Endung --&gt;
&lt;property name="LOGFILE_PATH" value="logausgaben/testserver_testsystem" /&gt;
&lt;!-- MDC in die Ausgabe mitaufnehmen. --&gt;
&lt;property name="INCLUDE_MDC" value="false" /&gt;
&lt;!-- Include der vorkonfigurierten Appender. --&gt;
&lt;include resource="resources/isylogging/logback/appender.xml" /&gt;
&lt;!-- Root-Logger als Grundlage für alle Logger-Instanzen --&gt;
&lt;root&gt;
&lt;appender-ref ref="DATEI_ANWENDUNG" /&gt;
&lt;/root&gt;
&lt;/configuration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Folgende Parameter sind zu setzen:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>LOGFILE_PATH</code>: Der Pfad der Logdatei (LOGFILE_PATH) muss gemäß den <a href="#vorgaben-fuer-logdateien">Vorgaben für Logdateien</a> angepasst werden.</p>
</li>
<li>
<p><code>INCLUDE_MDC</code>: Gibt an, ob der komplette Inhalt des MDC in das Log aufgenommen werden soll (true) oder nicht (false).</p>
</li>
<li>
<p><code>CONTEXT_NAME</code>: Als <code>contextName</code> wird „&lt;HOST&gt;_&lt;SYSTEM-ID&gt;“ zur eindeutigen Identifikation der Instanz der Anwendung bzw. des Batches angegeben.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="lokale-entwicklungsumgebung-konsolenausgabe"><a class="anchor" href="#lokale-entwicklungsumgebung-konsolenausgabe"></a>2.2.1.2. Lokale Entwicklungsumgebung (Konsolenausgabe)</h5>
<div class="paragraph">
<p>In der lokalen Entwicklungsumgebung ist es hilfreich, die Log-Ausgaben direkt auf der Konsole in einem einfachlesbaren Format auszugeben.
Hierfür wird folgende Konfiguration verwendet:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;configuration scan="false"&gt;
&lt;!-- Include der vorkonfigurierten Appender. --&gt;
&lt;include resource="resources/isylogging/logback/appender-entwicklung.xml" /&gt;
&lt;!-- Root-Logger als Grundlage für alle Logger-Instanzen --&gt;
&lt;root&gt;
&lt;appender-ref ref="KONSOLE" /&gt;
&lt;/root&gt;
&lt;/configuration&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="weitere-konfigurationsmöglichkeiten"><a class="anchor" href="#weitere-konfigurationsmöglichkeiten"></a>2.2.1.3. Weitere Konfigurationsmöglichkeiten</h5>
<div class="paragraph">
<p>In diesem Abschnitt werden weitere Möglichkeiten der Konfiguration von logback beschrieben, die bei Bedarf genutzt werden können:</p>
</div>
</div>
<div class="sect4">
<h5 id="maximale-logeintragslaenge-festlegen"><a class="anchor" href="#maximale-logeintragslaenge-festlegen"></a>2.2.1.4. Maximale Länge des Logeintrags festlegen</h5>
<div class="paragraph">
<p>Es kann die maximale Länge eines Logeintrags in Bytes festgelegt werden.
Sollte ein Logeintrag länger als dieser Wert sein, so wird der Logeintrag gekürzt (siehe <a href="master.html#einleitung" class="xref page">Logging - Konzept</a>).
Wird kein Wert angegeben, so beträgt der Standardwert 32000 Bytes.
Wird der Wert auf 0 festgelegt, so gibt es keine Begrenzung in der Länge des Logeintrags.
Die Beschränkung der Länge gilt nur für Logeinträge der Levels <code>INFO</code>, <code>WARN</code> und <code>ERROR</code>.</p>
</div>
<div class="paragraph">
<p>Die maximale Länge eines Logeintrags wird wie folgt gesetzt:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;property name="MAX_LENGTH" value="32000" /&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="logging-für-einzelne-klassen-deaktivieren"><a class="anchor" href="#logging-für-einzelne-klassen-deaktivieren"></a>2.2.1.5. Logging für einzelne Klassen deaktivieren</h5>
<div class="paragraph">
<p>Es kann sinnvoll sein, das Log-Level einer einzelnen Klasse oder eines Packages abweichend zum Root-Logger zu konfigurieren – bspw. falls ein Framework in einer bestimmten Klasse irreführende Logeinträge erzeugt.
Dies geschieht nach folgendem Schema:</p>
</div>
<div class="listingblock">
<div class="title">Listing 3. logback.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;root&gt;
  &lt;appender-ref ref="KONSOLE" /&gt;
&lt;/root&gt;

&lt;logger name="de.bund.bva.isyfact" additivity="false"&gt;
  &lt;appender-ref ref="KONSOLE"/&gt;
&lt;/logger</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 4. application.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">logging.level.root=INFO
logging.level.de.bund.bva.isyfact=DEBUG</code></pre>
</div>
</div>
<div class="paragraph">
<p>Das Attribut <code>additivity=false</code> gibt dabei an, dass für die konfigurierte Klasse bzw. das konfigurierte Package ausschließlich dieser Logger und nicht zusätzlich der Root-Logger verwendet werden soll.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="spring-konfiguration"><a class="anchor" href="#spring-konfiguration"></a>2.2.2. Spring-Konfiguration</h4>
<div class="paragraph">
<p>Im Folgenden werden die Spring-Konfigurationen zur Integration von logback in Spring und zur Konfiguration der genutzten Hilfsmechanismen (vgl. <a href="master.html#einleitung" class="xref page">Logging - Konzept</a>) beschrieben.</p>
</div>
<div class="sect4">
<h5 id="loggingmethodinterceptor"><a class="anchor" href="#loggingmethodinterceptor"></a>2.2.2.1. LoggingMethodInterceptor</h5>
<div class="paragraph">
<p>Der <code>LoggingMethodInterceptor</code> besitzt die folgenden Konfigurationsparameter:</p>
</div>
<div class="paragraph">
<p><code>loggeDauer</code>, <code>loggeAufruf</code>, <code>loggeErgebnis</code>, <code>loggeDaten</code>, <code>loggeDatenBeiException</code> und <code>loggeMaximaleParameterGroesse</code> (vgl. <a href="#loggingmethodinterceptor-und-loggingmethodinvoker">LoggingMethodInterceptor und LoggingMethodInvoker</a>).</p>
</div>
<div class="paragraph">
<p>Durch <code>isy-logging</code> werden zwei Instanzen des LogInterceptors mit unterschiedlichen Ausprägungen der oben genannten Parameter automatisch konfiguriert:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>boundaryLogInterceptor</code>: Dieser wird verwendet, um Aufrufe an Systemgrenzen zu loggen.
Zur Kennzeichnung von Systemgrenzen wird die von <code>isy-logging</code> bereitgestellt Annotation <code>@Systemgrenze</code> verwendet.
Damit werden alle Service-Schnittstellen, GUI-Controller und Batchausführungsbeans annotiert (siehe Szenarien in <a href="#aufruf-an-systemgrenze">Aufruf an Systemgrenze</a> und <a href="#rueckliefern-einer-exception-an-systemgrenze">Rückliefern einer Exception an Systemgrenze</a>).</p>
</li>
<li>
<p><code>komponentLogInterceptor</code>: Dieser wird verwendet, um Aufrufe an Komponentengrenzen zu loggen.
Hierfür wird die analog die Annotation <code>@Komponentengrenze</code> bereitgestellt.
Damit werden alle relevanten Komponenten-Schnittstellen annotiert (siehe Szenario in Abschnitt <a href="#aufruf-an-komponentengrenze">Aufruf an Komponentengrenze</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Die Standardkonfiguration der Interceptoren zeigt <a href="#table-ESIsyLog">Tabelle 8</a>.
Sie kann in Ausnahmefällen über <code>application.properties</code> geändert werden:</p>
</div>
<div class="paragraph">
<p>Ereignisschlüssel isy-logging</p>
</div>
<table id="table-ESIsyLog" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 42.8571%;">
<col style="width: 14.2857%;">
<col style="width: 42.8572%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Bemerkung</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isy.logging.boundary.loggeDauer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">Muss auf <code>true</code> sein, um das Logszenario <em>Aufruf an Systemgrenze</em> umzusetzen.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isy.logging.boundary.loggeAufruf</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isy.logging.boundary.loggeErgebnis</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isy.logging.boundary.loggeDaten</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kann in einer Testumgebung oder temporär in Produktion auf <code>true</code> gesetzt werden, um die gesamte Schnittstellenkommunikation zur Unterstützung der Fehlersuche auszugeben.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isy.logging.boundary.loggeDatenBeiException</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Muss auf <code>true</code> sein, um das Logszenario <em>Rückliefern einer Exception an Systemgrenze</em> umzusetzen.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isy.logging.boundary.loggeMaximaleParameterGroesse</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Setzt die maximale Größe von Parametern, die ins Log geschrieben werden dürfen, in Bytes.</p>
</div>
<div class="paragraph">
<p>Ist nur aktiv, wenn <code>loggeDaten</code> oder <code>loggeDatenBeiException</code> auf <code>true</code> gesetzt ist.</p>
</div>
<div class="paragraph">
<p>0 bedeutet keine Beschränkung.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isy.logging.component.loggeDauer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Die Ausgabe der Dauer und der durchgeführten Aufrufe an Komponentengrenzen führt zu einem hohen Logvolumen.
Daher ist es sinnvoll, den Parameter im Produktivbetrieb nur bei Bedarf auf v zu stellen (vgl. Logszenario <em>Aufruf an Komponentengrenze</em>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isy.logging.component.loggeAufruf</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isy.logging.component.loggeErgebnis</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">Kann in einer Testumgebung oder temporär in Produktion zur Unterstützung der Fehlersuche <code>true</code> gesetzt werden.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isy.logging.component.loggeDaten</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isy.logging.component.loggeDatenBeiException</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isy.logging.component.loggeMaximaleParameterGroesse</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Setzt die maximale Größe von Parametern, die ins Log geschrieben werden dürfen, in Bytes.</p>
</div>
<div class="paragraph">
<p>Ist nur aktiv, wenn loggeDaten oder loggeDatenBeiException auf <code>true</code> gesetzt ist.</p>
</div>
<div class="paragraph">
<p>0 bedeutet keine Beschränkung.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><span class="underline"><strong>Anpassen der Konvertierung</strong></span></p>
</div>
<div class="paragraph">
<p>Ist der Parameter <code>loggeDatenBeiException</code> auf <code>true</code> gesetzt, werden die übergebenen Schnittstellenparameter der Methode, bei der eine Exception aufgetreten ist, falls sie nicht zu groß sind oder die Größenbeschränkung deaktiviert ist, konvertiert (serialisiert) und in den Logeintrag übernommen.
Handelt es sich bei einem der Parameter um eine Objektstruktur, wird diese Struktur teilweise rekursiv durchlaufen und sämtliche Attribute in den Logeintrag übernommen.
Bei dieser Konvertierung gelten standardmäßig folgende Regeln:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Sämtliche Objekte im Package <code>de.bund.bva</code> (inkl. Subpackages) werden rekursiv durchlaufen.</p>
</li>
<li>
<p>Alle anderen Objekte, Primitives und Enums werden mit <code>toString</code> umgewandelt.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Dieses Verhalten <span class="underline"><strong>kann</strong></span> bei Bedarf konfigurativ angepasst werden, in dem die beiden Properties <code>isy.logging.&lt;boundary | component&gt;.converterIncludes</code> und <code>isy.logging.&lt;boundary | component&gt;.converterExcludes</code> angegeben werden.
Dabei gilt:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Alle Objekte aus Packages (und Sub-Packages) in der Liste <code>converterIncludes</code> werden Rekursiv durchlaufen.</p>
</li>
<li>
<p>Alle Objekte aus Packages (und Sub-Packages) in der Liste <code>converterExcludes</code> werden ignoriert.</p>
</li>
<li>
<p>Alle anderen Objekte werden mit <code>toString</code> umgewandelt.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Gründe für die Anpassung der Konfiguration können bspw. sein:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Exkludieren einzelner Packages, die nicht serialisiert werden können oder nicht relevant sind und dadurch zu unnötigen Loginhalten führen.</p>
</li>
<li>
<p>Inkludieren einzelner Packages, falls die Anwendung nicht in der Domäne <code>de.bund.bva</code> entwickelt wird.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Eine exemplarische Konfiguration ist im Folgenden dargestellt:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">isy.logging.boundary.converterIncludes=x.y.z, u.v.w
isy.logging.boundary.converterExcludes=a.b.c</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="logapplicationlistener-1"><a class="anchor" href="#logapplicationlistener-1"></a>2.2.2.2. LogApplicationListener</h5>
<div class="paragraph">
<p>Der LogApplicationListener wird über folgende Properties konfiguriert:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">isy.logging.anwendung.typ=&lt;SYSTEMART&gt;
isy.logging.anwendung.name=&lt;SYSTEMNAME&gt;
isy.logging.anwendung.version=&lt;SYSTEMVERSION&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Die Platzhalter müssen dabei wie folgt ersetzt werden:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>SYSTEMART</code>: Kürzel der Systemart gemäß den Namenskonventionen – bspw. <code>REG</code> bei einem Register, <code>GA</code> bei einer Geschäftsanwendung, <code>QA</code> bei einer Querschnittsanwendung, <code>BAT</code> bei einem Batch.</p>
</li>
<li>
<p><code>SYSTEMNAME</code>: Name der Anwendung analog zu <a href="#anwendungen-zeitbasiertes-rollieren">Anwendungen (zeitbasiertes Rollieren)</a>.</p>
</li>
<li>
<p><code>VERSIONSNUMMER</code>: Versionsnummer der Anwendung.
Diese ist als interner Konfigurationsparameter in der Anwendung abzulegen.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="performance-logging"><a class="anchor" href="#performance-logging"></a>2.2.3. Performance-Logging</h4>
<div class="paragraph">
<p>In diesem Abschnitt werden die notwendigen Konfigurationen zum Einrichten des Performance-Loggings beschrieben.</p>
</div>
<div class="paragraph">
<p>Die Auswahl der zu loggenden Aufrufe erfolgt über die Namenskonventionen von IsyFact.
Eine Übersicht über die erfassten Klassen bietet die folgende Tabelle:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Schicht / Klassen</th>
<th class="tableblock halign-left valign-top">Pointcut</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Controller / Webaufrufe</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>public *  <strong>..gui..*Controller.</strong>(..)</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Serviceschicht</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>public * <strong>..service..*ServiceImpl.</strong>(..)</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Core-Komponenten</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>public * <strong>..core..*Impl.</strong>(..)</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AWF-Klassen</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>* * ..core..Awf*.*(..)</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AFU-Klassen</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>* * ..core..Afu*.*(..)</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DAOs</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>public * <strong>..persistence..*DaoImpl.</strong>(..)</code></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Bei allen Aufrufen wird nur die Dauer des Aufrufs geloggt.
Das Performance-Logging wird über die Property <code>isy.logging.performancelogging.enabled=true</code> eingeschaltet.</p>
</div>
<div class="sect4">
<h5 id="annotation-fuer-performance-logging"><a class="anchor" href="#annotation-fuer-performance-logging"></a>2.2.3.1. Annotation für Performance-Logging</h5>
<div class="paragraph">
<p>Für den Fall, dass Aufrufe außerhalb der Namenskonventionen geloggt werden sollen, wird die Annotation <code>@PerformanceLogging</code> bereitgestellt.
Damit werden Methoden annotiert, die vom Performance-Logging erfasst werden sollen.
So können z.B. auch die Aufrufe fremder RemoteBean-Schnittstellen geloggt werden.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="umgang-mit-drittsoftware"><a class="anchor" href="#umgang-mit-drittsoftware"></a>2.2.4. Umgang mit Drittsoftware</h4>
<div class="paragraph">
<p>Es muss sichergestellt werden, dass alle Bibliotheken – auch solche die nicht nach den Vorgaben der IsyFact entwickelt wurden – logback, mit der in <a href="#logback-konfiguration">Logback-Konfiguration</a> definierten Konfiguration, nutzen.
Dadurch wird gewährleistet, dass die definierten Vorgaben zu Logdateien und Struktur der Logeinträge einheitlich  umgesetzt werden.</p>
</div>
<div class="paragraph">
<p>Beim Einsatz von <a href="../../../../glossary/latest/glossary/master.html#glossar-bibliothek" class="xref page">Bibliotheken</a>, die nicht nach der IsyFact entwickelt wurden, muss daher unterschieden werden:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Die Bibliothek loggt mittels logback oder SLF4J</strong>: Es sind keine Maßnahmen notwendig.</p>
</li>
<li>
<p><strong>Die Bibliothek setzt ein anderes Logging-Framework ein</strong>: Es muss eine entsprechende „Bridge“ integriert werden, welche die Aufrufe der Bibliothek an das jeweilige Logging-Framework auf logback umleitet.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>SLF4J stellt bereits fertige Bridges für alle gängigen Logging-Frameworks zur Verfügung, deren Einsatz im Folgenden beschrieben wird.
Grundsätzlich ist es unkritisch, wenn alle Bridges konfiguriert werden.
Um die Komplexität der Konfiguration und deren Wartung nicht unnötig zu erhöhen, sollten jedoch nur die Bridges eingerichtet werden, die auch tatsächlich benötigt werden.</p>
</div>
<div class="paragraph">
<p>Bei sämtlichen Bridges muss sichergestellt werden, dass das <code>logback.jar</code> als einzige SLF4J-Implementierung in der Anwendung vorhanden ist.</p>
</div>
<div class="sect4">
<h5 id="bridge-fuer-commons-logging"><a class="anchor" href="#bridge-fuer-commons-logging"></a>2.2.4.1. Bridge für commons-logging</h5>
<div class="paragraph">
<p>SLF4J stellt mit der Bibliothek <code>jcl-over-slf4j.jar</code> eine Bridge von commons-logging zu slf4j zur Verfügung.
Diese kann wie folgt eingesetzt werden:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>commons-logging*.jar</code> aus der Anwendung entfernen (bzw. sicherstellen, dass diese durch Maven nicht in die Anwendung integriert werden)</p>
</li>
<li>
<p><code>jcl-over-slf4j.jar</code> in die Anwendung ergänzen</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="bridge-fuer-java.util.logging"><a class="anchor" href="#bridge-fuer-java.util.logging"></a>2.2.4.2. Bridge für java.util.logging</h5>
<div class="paragraph">
<p>SLF4J stellt für die java.util.logging API ebenfalls eine Bridge zur Verfügung (jul-to-slf4j.jar).
Um die Bridge zu aktivieren müssen zunächst alle vorhandenen Log-Handler entfernt und danach ein Handler
zum Weiterleiten der Log-Aufrufe an SLF4J installiert werden.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
Weitere Informationen über SLF4J unter <a href="../../../../glossary/latest/literaturextern/inhalt.html#litextern-slf4j-bridge-handler" class="xref page">SLF4JBridgeHandler</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Dies kann wie folgt umgesetzt werden:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>jul-to-slf4j.jar</code> in die Anwendung ergänzen</p>
</li>
<li>
<p>Den folgenden Abschnitt in die Spring-Konfiguration der Anwendung ergänzen:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Configuration
public class LoggingBridgeConfig {
    @Bean
    public SLF4JBridgeHandler slf4JBridgeHandler() {
        SLF4JBridgeHandler.removeHandlersForRootLogger();
        SLF4JBridgeHandler.install();
        return new SLF4JBridgeHandler();
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="vorgaben-zur-logerstellung"><a class="anchor" href="#vorgaben-zur-logerstellung"></a>3. Vorgaben zur Logerstellung</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Die Zielsetzung des Loggings ist es, unterschiedliche Auswertungen zu ermöglichen, um damit verschiedene Problemstellungen und Informationsbedarfe, die während des Betriebs der Systeme entstehen, einfach und effizient beantworten zu können.
Grundlage hierfür bildet zum einen die technische Vereinheitlichung des Loggings, die in den vorangegangen Abschnitten (Nutzung und Konfiguration) beschrieben wurde.
Zum Anderen muss das Logging jedoch insbesondere auch inhaltlich – also <em>wann</em> wird <em>was</em> geloggt – einheitlich und zielgerichtet im Hinblick auf die verschiedenen Auswertungen erfolgen.
Dadurch wird sichergestellt, dass die Logeinträge einfach ausgewertet werden können und alle notwendigen Informationen vorliegen.</p>
</div>
<div class="paragraph">
<p>Aus diesem Grund werden im folgenden Abschnitt zunächst die verschiedenen Auswertungen beschrieben, die für alle Anwendungen relevant sind.
Bei Entwurf eines Systems können systemspezifische Anforderungen definiert werden, die analog zu den hier aufgeführten Themen adressiert werden müssen.
Es ist Aufgabe des Technischen Chefdesigners diese Anforderungen im Rahmen des Systementwurfs abzustimmen und zu berücksichtigen.</p>
</div>
<div class="paragraph">
<p>Die konkreten Szenarien, in denen Logeinträge zu erstellen sind, werden in <a href="#logszenarien">Logszenarien</a> definiert.</p>
</div>
<div class="sect2">
<h3 id="auswertungen"><a class="anchor" href="#auswertungen"></a>3.1. Auswertungen</h3>
<div class="paragraph">
<p>In diesem Abschnitt werden Auswertungen beschrieben, die auf den Logs der <a href="../../../../glossary/latest/glossary/master.html#glossar-anwendungslandschaft" class="xref page">Anwendungslandschaft</a> durchgeführt werden können müssen.
Die Auswertung erfolgt dabei meist durch den Betrieb und nicht durch die Entwickler.
Es ist jedoch Aufgabe der Entwickler sämtliche Informationen in den Logs bereitzustellen, so dass die Szenarien effizient durchgeführt werden können.</p>
</div>
<div class="paragraph">
<p>Es wird zwischen folgenden Akteuren unterschieden:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Betrieb: Mitarbeiter der IT-Abteilung, in der das System bzw. die Anwendungslandschaft betrieben wird.</p>
</li>
<li>
<p>Entwickler: Mitarbeiter der Entwicklungsabteilung, durch die die Anwendung entwickelt, gewartet und/oder weiterentwickelt wird.</p>
</li>
<li>
<p>Fachbereich: Mitarbeiter des Fachbereichs / der Fachabteilung, durch die die Anwendung fachlich betreut und geführt wird.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="schwerwiegenden-fehler-erkennen-und-behandeln"><a class="anchor" href="#schwerwiegenden-fehler-erkennen-und-behandeln"></a>3.1.1. Schwerwiegenden Fehler erkennen und behandeln</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Akteur</th>
<th class="tableblock halign-left valign-top">Betrieb, Entwickler</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Log-Level</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>FATAL</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Kategorie</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>FATAL</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Schwerwiegende Fehler, von denen sich die Anwendung nicht erholen kann und beendet werden muss ("Unrecoverable Error"), müssen umgehend erkannt werden.
Zu diesem Zweck überwacht das betriebliche Monitoring das Log-Level FATAL und alarmiert den Betrieb bei jedem neuen Eintrag.</p>
</div>
<div class="paragraph">
<p>Logeinträge im Level FATAL signalisieren, dass der Systembetrieb unterbrochen ist und der Betrieb schnellstmöglich aktiv werden muss, um die Fehlerursache mit Hilfe der bereitgestellten Informationen zu analysieren, zu beheben und die Anwendung wieder neu zu starten.</p>
</div>
<div class="paragraph">
<p>Falls der Betrieb im Rahmen der Fehleranalyse feststellt, dass die Exception auf einen Fehler in der Anwendung zurückzuführen ist, wird der Logeintrag zur Fehleranalyse an die Entwickler übergeben.</p>
</div>
<div class="paragraph">
<p>Beispiele:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>OutOfMemoryError</code></p>
</li>
<li>
<p><code>StackOverflowError</code></p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="beeinträchtigung-des-betriebs-erkennen-und-behandeln"><a class="anchor" href="#beeinträchtigung-des-betriebs-erkennen-und-behandeln"></a>3.1.2. Beeinträchtigung des Betriebs erkennen und behandeln</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Akteur</th>
<th class="tableblock halign-left valign-top">Betrieb, Entwickler</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Log-Level</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ERROR</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Kategorie</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ERROR</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Beeinträchtigungen des Systembetriebs (bspw. Netzwerkverbindung kann nicht aufgebaut werden), müssen umgehend erkannt werden.
Zu diesem Zweck überwacht das betriebliche Monitoring das Log-Level ERROR und alarmiert den Betrieb bei jedem neuen Eintrag.</p>
</div>
<div class="paragraph">
<p>Logeinträge im Level ERROR signalisieren, dass der Fehler durch die Anwendung behandelt wurde und die Anwendung weiterläuft.
Der Betrieb muss jedoch schnellstmöglich aktiv werden, um die Fehlerursache mit Hilfe der bereitgestellten Informationen zu analysieren, zu beheben und damit ein erneutes Auftreten des Fehlers zu verhindern.</p>
</div>
<div class="paragraph">
<p>Falls der Betrieb im Rahmen der Fehleranalyse feststellt, dass die Exception auf einen Fehler in der Anwendung zurückzuführen ist, wird der Logeintrag zur Fehleranalyse an die Entwickler übergeben.</p>
</div>
<div class="paragraph">
<p>Beispiele:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Fehler bei Netzwerkverbindung</p>
</li>
<li>
<p>Datenbankverbindung konnte nicht aufgebaut werden</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="unerwartetes-systemverhalten-erkennen-und-behandeln"><a class="anchor" href="#unerwartetes-systemverhalten-erkennen-und-behandeln"></a>3.1.3. Unerwartetes Systemverhalten erkennen und behandeln</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Akteur</th>
<th class="tableblock halign-left valign-top">Entwickler</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Log-Level</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>WARN</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Kategorie</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>WARN</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Unerwartetes Systemverhalten muss umgehend erkannt werden.
Zu diesem Zweck überwacht das betriebliche Monitoring das Log-Level WARN.
Die entsprechenden Logeinträge werden an die Entwicklungsabteilung zur Analyse des Verhaltens und Identifikation notwendiger Maßnahmen übergeben.</p>
</div>
<div class="paragraph">
<p>Logeinträge im Level WARN signalisieren, dass der Fehler den Systembetrieb (wahrscheinlich) nicht beeinträchtigt.
Die bereitgestellten Informationen richten sich an die Entwickler.
Der Betrieb muss im Hinblick auf die Fehleranalyse hierbei zunächst nicht aktiv werden.</p>
</div>
<div class="paragraph">
<p>Beispiele:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Inkonsistenzen im Datenbestand</p>
</li>
<li>
<p><code>IllegalArgumentException</code></p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="betriebliche-ueberwachung"><a class="anchor" href="#betriebliche-ueberwachung"></a>3.1.4. Betriebliche Überwachung</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Akteur</th>
<th class="tableblock halign-left valign-top">Betrieb</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Log-Level</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>INFO</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Kategorie</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>METRIK</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Logeinträge können dazu verwendet werden, Statistiken zu ermitteln, um eine betriebliche Überwachung des Systems zu realisieren.</p>
</div>
<div class="paragraph">
<p>Die folgenden Auswertungen werden dazu durchgeführt:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ermittlung der Anzahl der Aufrufe eines Services innerhalb der letzten Minute.</p>
</li>
<li>
<p>Ermittlung der Anzahl der Aufrufe eines Services, die einen Fehler erzeugt haben, innerhalb der letzten Minute.</p>
</li>
<li>
<p>Ermittlung der Durchschnittsdauer der letzten Aufrufe eines Services.</p>
</li>
<li>
<p>Ermittlung des Zeitpunkts, wann die letzte Prüfung des Systems durchgeführt wurde und wann die letzte Prüfung erfolgreich war.
Detaillierte Informationen zur Systemprüfung und der zu erstellenden Logeinträge ist im <a href="../../isy-ueberwachung/konzept/master.html#einleitung" class="xref page">Konzept Überwachung</a> beschrieben.</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="performance-ueberwachen"><a class="anchor" href="#performance-ueberwachen"></a>3.1.5. Performance überwachen</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Akteur</th>
<th class="tableblock halign-left valign-top">Betrieb</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Log-Level</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>INFO</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Kategorie</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>PROFIL</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>„Performance-Analyse“ meint die Analyse von Laufzeiten an bestimmten kritischen Stellen der Anwendungslandschaft (bspw. an Service-Methoden) und insbesondere deren Entwicklung über die Zeit.
Dies wird durchgeführt, um</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Engpässe zu erkennen, bspw.
wenn Aufrufe einer Komponente zunehmend länger dauern.</p>
</li>
<li>
<p>Auswirkung einer Änderung auf die Performance zu bewerten, bspw. um Laufzeiten vor und nach einer Aktualisierung der Datenbank zu vergleichen.</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="nutzungshaeufigkeit-auswerten"><a class="anchor" href="#nutzungshaeufigkeit-auswerten"></a>3.1.6. Nutzungshäufigkeit auswerten</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Akteur</th>
<th class="tableblock halign-left valign-top">Betrieb</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Log-Level</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>INFO</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Kategorie</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>METRIK</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Die Analyse der Nutzungshäufigkeit bestimmter kritischer Stellen der Anwendungslandschaft (bspw. von Service-Methoden oder Komponenten) und insbesondere deren Entwicklung über die Zeit wird zu folgenden Zwecken durchgeführt:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Anomalien in Nutzung erkennen: Durch die betriebliche Überwachung der Nutzungshäufigkeit von Systemen können Ausreißer
im Nutzerverhalten erkannt werden, die ggf. ein Fehlverhalten des Aufrufers (bspw. große Anzahl an Aufrufen weil Testsystem auf Produktivumgebung gelenkt ist) oder gar auf einen Missbrauchsversuch (Vielzahl unautorisierter Zugriffe, um Benutzerdaten zu erraten) hindeuten.</p>
</li>
<li>
<p>Auswirkung von Änderungen prognostizieren: Es kann bspw. überprüft werden, wie oft eine alte Schnittstelle noch verwendet wird und ob (bzw. mit welchem Aufwand) dieses abgeschaltet werden kann.</p>
</li>
<li>
<p>Auswirkung von Änderungen analysieren: Es kann bspw. überprüft werden, ob eine Erhöhung der Cache-Größe zur gewünschten Reduktion der Nachbarsystemaufrufe geführt hat.</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="systemzustand-und--ereignisse-überwachen"><a class="anchor" href="#systemzustand-und--ereignisse-überwachen"></a>3.1.7. Systemzustand und -ereignisse überwachen</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Akteur</th>
<th class="tableblock halign-left valign-top">Betrieb</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Log-Level</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>INFO</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Kategorie</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>JOURNAL</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Die Analyse des Systemzustands und der Systemereignisse umfasst bspw. welche Version sich mit welcher Konfiguration in Betrieb befand, welche Änderungen vorgenommen wurden, ob die Anwendung gestartet oder beendet wurde, etc.</p>
</div>
<div class="paragraph">
<p>Diese Analyse wird querschnittlich zur Unterstützung der anderen Analysen durchgeführt, um bspw. Fehler auf Änderungen des Systemzustands zurückzuführen, oder Performance-Schwankungen zu erklären.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="verarbeitung-eines-aufrufs-in-anwendungslandschaft-nachvollziehen"><a class="anchor" href="#verarbeitung-eines-aufrufs-in-anwendungslandschaft-nachvollziehen"></a>3.1.8. Verarbeitung eines Aufrufs in Anwendungslandschaft nachvollziehen</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Akteur</th>
<th class="tableblock halign-left valign-top">Entwickler</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Log-Level</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>INFO</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Kategorie</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>JOURNAL</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Das Nachvollziehen, durch welche Systeme ein Aufruf der Anwendungslandschaft verarbeitet und weitergeleitet wurde (die Korrelation der Logs zu einem Aufruf aus verschiedenen Systemen), dient den folgenden Zwecken:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Unterstützung der Fehleranalyse, falls die systeminternen Logeinträge nicht ausreichend sind, bspw. weil der Fehler durch ein aufrufendes System verursacht wurde.</p>
</li>
<li>
<p>Nachvollziehen der Auswirkung eines Fehlers, um bspw. erkennen zu können, ob durch den Aufruf in einem anderen System bereits Daten verändert wurden, die zurückgesetzt werden müssen.</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="fachliche-verarbeitung-eines-aufrufs-nachvollziehen"><a class="anchor" href="#fachliche-verarbeitung-eines-aufrufs-nachvollziehen"></a>3.1.9. Fachliche Verarbeitung eines Aufrufs nachvollziehen</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Akteur</th>
<th class="tableblock halign-left valign-top">Fachbereich</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Log-Level</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>INFO</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Kategorie</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>JOURNAL</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Der Fachbereich kann die Anforderung an ein System stellen, dass die fachliche Verarbeitung eines Aufrufs über das Logging nachvollziehbar sein muss.</p>
</div>
<div class="paragraph">
<p>Hierzu werden an definierten Stellen in der Anwendung spezifische Logeinträge erstellt – bspw. beim Start oder Beenden eines Anwendungsfalls, beim Aufruf einer Anwendungsfunktion etc.</p>
</div>
<div class="paragraph">
<p>Die Anforderungen an das Logging sowie die Auswertung der Logeinträge sind spezifisch für das jeweilige System und müssen mit dem Fachbereich abgestimmt werden.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="fehleranalyse-debugging"><a class="anchor" href="#fehleranalyse-debugging"></a>3.1.10. Fehleranalyse (Debugging)</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Akteur</th>
<th class="tableblock halign-left valign-top">Entwickler</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Log-Level</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DEBUG, TRACE</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Kategorie</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DEBUG</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Die Fehleranalyse ist das „klassische“ Szenario der Log-Auswertung.
Hierbei werden detaillierte Debug-Informationen analysiert, um die Ursache eines Fehlers im Programmcode zu finden und diesen zu beheben.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="logszenarien"><a class="anchor" href="#logszenarien"></a>3.2. Logszenarien</h3>
<div class="paragraph">
<p>In diesem Abschnitt werden die verschiedenen Logszenarien beschrieben, die definieren, <em>wann</em> <em>welche</em> Logeinträge zu erstellen sind, um die im vorhergehenden Abschnitt definierten Auswertungen zu ermöglichen.</p>
</div>
<div class="paragraph">
<p>Die Bibliothek <code>isy-logging</code> stellt bereits einige Mechanismen bereit, durch die die notwendigen Logeinträge für einzelne Auswertungen querschnittlich und rein konfigurativ umgesetzt werden können.
Diese sind in <a href="#konfiguration-1">Konfiguration</a> beschrieben.</p>
</div>
<div class="paragraph">
<p>Logeinträge die individuell in bei der Anwendungsentwicklung zu erstellen sind, sind in <a href="#anwendungsentwicklung">Anwendungsentwicklung</a> beschrieben.</p>
</div>
<div class="paragraph">
<p>Wichtig ist, dass bei der Umsetzung einer Anwendung <em>keine</em> Logeinträge erstellt werden, zu denen es <em>kein</em> Szenario gibt – oder umgekehrt: sollte es sinnvoll sein einen Logeintrag zu erstellen, dann muss dafür auch ein Szenario definiert werden.</p>
</div>
<div class="paragraph">
<p>Die Szenarien sind nach folgendem Schema aufgebaut:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 71.4286%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Beschreibung der Situation innerhalb einer Anwendung.</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logging</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Das durchzuführende Logging.</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Auswertungsszenario</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Die Auswertungen, für die die erstellten Logeinträge verwendet werden.</em></p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="vorgaben-fuer-alle-logszenarien"><a class="anchor" href="#vorgaben-fuer-alle-logszenarien"></a>3.2.1. Vorgaben für alle Logszenarien</h4>
<div class="paragraph">
<p>Die folgenden Regeln sind für alle Logeinträge zu beachten:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Keine Binärdaten loggen</strong>: Binärdaten sind nur schwer auswertbar und führen potentiell zu sehr langen Einträgen.
Binärdaten dürfen daher nicht gelogged werden.</p>
</li>
<li>
<p><strong>Größe der Parameter beschränken</strong>: Beim Loggen der Schnittstellenkommunikation können durch große Objektstrukturen ebenfalls sehr große Logeinträge entstehen.
Das Loggen von Parametern kann durch entsprechende Konfiguration auf eine Maximalgröße beschränkt werden.</p>
</li>
<li>
<p><strong>Größe des Logeintrags beschränken</strong>: Große Logeinträge können zu Fehlern bei der weiteren Verarbeitung führen.
Daher sollte darauf geachtet werden, dass Logeinträge eine invidiuell definierte maximale Länge nicht überschreiten.
Zudem sollte diese maximale Länge in der Konfigurationsdatei <code>logback.xml</code> definiert sein (s. <a href="#maximale-logeintragslaenge-festlegen">Maximale Länge des Logeintrags festlegen</a>).</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="konfiguration-1"><a class="anchor" href="#konfiguration-1"></a>3.2.2. Konfiguration</h4>
<div class="paragraph">
<p>Die folgenden Szenarien können rein konfigurativ umgesetzt werden, mit Mitteln, die durch <code>isy-logging</code> bereitgestellt werden.
Sollte einer dieser Mechanismen in einer Anwendung nicht umgesetzt werden können (bspw. weil die Anwendung nur Teile der IsyFact einsetzt und bspw. Spring nicht verwendet), müssen die entsprechenden Einträge explizit durch Aufruf des Logging-Frameworks erstellt werden.</p>
</div>
<div class="sect4">
<h5 id="aufruf-an-systemgrenze"><a class="anchor" href="#aufruf-an-systemgrenze"></a>3.2.2.1. Aufruf an Systemgrenze</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 71.4286%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Es wird eine Außenschnittstelle des Systems – Service, GUI-Controller oder Batch – aufgerufen (eingehender Aufruf).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logging</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Der Aufruf der Methode wird mit Hilfe des <code>LogInterceptor</code> geloggt.
Dieser muss gemäß <a href="#loggingmethodinterceptor">LoggingMethodInterceptor</a> für alle Außenschnittstellen des Systems konfiguriert sein.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Auswertungsszenario</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Performance analysieren</p>
</li>
<li>
<p>Nutzungshäufigkeit analysieren</p>
</li>
<li>
<p>Verarbeitung eines Aufrufs in Anwendungslandschaft nachvollziehen</p>
</li>
<li>
<p>Betriebliche Überwachung</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="rueckliefern-einer-exception-an-systemgrenze"><a class="anchor" href="#rueckliefern-einer-exception-an-systemgrenze"></a>3.2.2.2. Rückliefern einer Exception an Systemgrenze</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 71.4286%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Beim Aufruf eines Systems ist ein Fehler aufgetreten.
Es wird eine Exception an den Aufrufer zurückgegeben.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logging</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Es müssen die übermittelten Eingabeparameter mit Hilfe des <code>LogInterceptor</code> geloggt werden.
Dieser muss gemäß <a href="#loggingmethodinterceptor">LoggingMethodInterceptor</a> für alle Außenschnittstellen des Systems konfiguriert sein.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Auswertungsszenario</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Fehleranalyse (Debugging)</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="aufruf-an-komponentengrenze"><a class="anchor" href="#aufruf-an-komponentengrenze"></a>3.2.2.3. Aufruf an Komponentengrenze</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 71.4286%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Es wird eine Methode einer Komponentenschnittstelle im Anwendungskern aufgerufen (eingehender Aufruf).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logging</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Das Loggen von Aufrufen an Komponentengrenzen liefert insbesondere für die Performanceanalyse wichtige Informationen, führt jedoch in den meisten Anwendungen zu einem sehr hohen Logvolumen.</p>
</div>
<div class="paragraph">
<p>Jede Anwendung muss den LogInterceptor gemäß <a href="#loggingmethodinterceptor">LoggingMethodInterceptor</a> konfigurieren, so dass das Logging an den Komponentengrenzen bei Bedarf aktiviert werden kann.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Auswertungsszenario</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Performance überwachen</p>
</li>
<li>
<p>Nutzungshäufigkeit analysieren</p>
</li>
<li>
<p>Verarbeitung eines Aufrufs in Anwendungslandschaft nachvollziehen</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="aufruf-eines-daos"><a class="anchor" href="#aufruf-eines-daos"></a>3.2.2.4. Aufruf eines DAOs</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 71.4286%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Es wird eine Methode eines DAOs aufgerufen (eingehender Aufruf).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logging</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Der Aufruf der Methode wird mit Hilfe des <code>LogInterceptor</code> geloggt.
Dieser muss gemäß <a href="#loggingmethodinterceptor">LoggingMethodInterceptor</a> für alle Komponentenschnittstellen konfiguriert sein.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Auswertungsszenario</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Performance überwachen</p>
</li>
<li>
<p>Nutzungshäufigkeit analysieren</p>
</li>
<li>
<p>Verarbeitung eines Aufrufs in Anwendungslandschaft nachvollziehen</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="aufruf-eines-nachbarsystems"><a class="anchor" href="#aufruf-eines-nachbarsystems"></a>3.2.2.5. Aufruf eines Nachbarsystems</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 71.4286%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Es wird ein entfernter Service eines Nachbarsystems aufgerufen.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logging</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Der Aufruf der Methode wird mit Hilfe des <code>LogInterceptor</code> geloggt.
Dazu muss in der aufrufenden Klasse gemäß <a href="#loggingmethodinterceptor-und-loggingmethodinvoker">LoggingMethodInterceptor und LoggingMethodInvoker</a> eine Instanz der Klasse erstellt und das Remote-Interface des Nachbarsystems mit Hilfe der Methode <code>rufeNachbarsystemAuf</code> aufgerufen werden.
Dies wird bereits durch den Baustein HTTP Invoker umgesetzt (siehe <a href="../../isy-serviceapi-core/nutzungsvorgaben/master.html#einleitung" class="xref page">Nutzungsvorgaben HTTP-Invoker</a>), sodass hierfür keine Anpassung notwendig ist.
Bei Nachbarsystemen, die selbst kein IsyFact-konformes Logging umsetzen (Drittsoftware wie bspw. ein Suchverfahren), kann es notwendig sein, zusätzliche Informationen in der aufrufenden Anwendung zu loggen.
Entsprechende Vorgaben werden in den Nutzungskonzepten der jeweiligen Bausteine definiert.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Auswertungsszenario</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Nutzungshäufigkeit analysieren</p>
</li>
<li>
<p>Verarbeitung eines Aufrufs in Anwendungslandschaft nachvollziehen</p>
</li>
<li>
<p><em>Weitere systemspezifische Auswertungen</em></p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="hochfahren-herunterfahren"><a class="anchor" href="#hochfahren-herunterfahren"></a>3.2.2.6. Hochfahren / Herunterfahren</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 71.4286%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ein Anwendungssystem oder ein Batch wird gestartet oder beendet.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logging</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Der Vorgang wird durch den <code>LogApplicationListener</code> geloggt.
Dieser muss gemäß <a href="#logapplicationlistener">LogApplicationListener</a> konfiguriert sein.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Auswertungsszenario</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Systemzustand und -ereignisse überwachen</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="neueinlesen-eines-geänderten-konfigurationsparameters"><a class="anchor" href="#neueinlesen-eines-geänderten-konfigurationsparameters"></a>3.2.2.7. Neueinlesen eines geänderten Konfigurationsparameters</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 71.4286%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Es wird festgestellt, dass sich ein Konfigurationsparameter der betrieblichen Konfiguration oder eine Laufzeitkonfiguration geändert hat.
Der geänderte Wert wird im laufenden Betrieb übernommen.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logging</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Es muss ein Logeintrag erstellt werden, der die Änderung des Konfigurationsparameters dokumentiert:</p>
</div>
<div class="paragraph">
<p><code>log.info("Der Konfigurationsparameter &lt;Parameter&gt; wurde geändert von &lt;Alter Wert&gt; auf &lt;Neuer Wert&gt;", &lt;Name des Parameters&gt;, &lt;Alter Wert&gt;, &lt;Neuer Wert&gt;)</code></p>
</div>
<div class="paragraph">
<p>Dies wird durch die Klasse <code>ReloadablePropertyKonfiguration</code> der Bibliothek <code>isy-konfiguration</code> bereits umgesetzt, so dass bei deren Verwendung hierfür nichts mehr zu tun ist.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Auswertungsszenario</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Systemzustand und -ereignisse überwachen</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="loggen-der-schnittstellenkommunikation"><a class="anchor" href="#loggen-der-schnittstellenkommunikation"></a>3.2.2.8. Loggen der Schnittstellenkommunikation</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 71.4286%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>In Ausnahmefällen kann es notwendig sein, Teile oder die gesamten Daten, die über eine Schnittstelle ausgetauscht werden, zu loggen.
Dies ist insbesondere dann der Fall, wenn:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Es sich um eine technisch sehr komplexe oder proprietäre Schnittstelle handelt.</p>
</li>
<li>
<p>Ein „unerklärliches“ Verhalten im Systembetrieb festgestellt wurde, welches mit den Standard Debug-Ausgaben nicht nachvollzogen  werden kann.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logging</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Das Erstellen der Logeinträge erfolgt mittels des LogInterceptors der bereits für die Szenarien in <a href="#schwerwiegenden-fehler-erkennen-und-behandeln">Schwerwiegenden Fehler erkennen und behandeln</a> und <a href="#beeinträchtigung-des-betriebs-erkennen-und-behandeln">Beeinträchtigung des Betriebs erkennen und behandeln</a> konfiguriert wurde.</p>
</div>
<div class="paragraph">
<p>Zur Ausgabe der Schnittstellenkommunikation muss der Schalter loggeDaten auf true gesetzt werden (<a href="#loggingmethodinterceptor">LoggingMethodInterceptor</a>).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Auswertungsszenario</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Fehleranalyse (Debugging)</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="anwendungsentwicklung"><a class="anchor" href="#anwendungsentwicklung"></a>3.2.3. Anwendungsentwicklung</h4>
<div class="paragraph">
<p>In diesem Abschnitt sind alle Szenarien beschrieben, bei denen Logeinträge im Anwendungscode explizit durch den Entwickler vorzusehen sind.</p>
</div>
<div class="paragraph">
<p>Wenn durch ein Logszenario ein Eintrag im Level INFO gefordert ist, muss ein entsprechender Ereignisschlüssel definiert werden – dies ist in <a href="#ereignisschluessel">Ereignisschlüssel</a> beschrieben.
Die definierten Schlüssel müssen im Systementwurf dokumentiert werden – analog zu <a href="#ereignisschluessel-isy-logging">Ereignisschlüssel isy-logging</a> dieses Dokuments.</p>
</div>
<div class="sect4">
<h5 id="behandlung-einer-exception"><a class="anchor" href="#behandlung-einer-exception"></a>3.2.3.1. Behandlung einer Exception</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 71.4286%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Es wird eine Exception gefangen und behandelt.</p>
</div>
<div class="paragraph">
<p>Wichtig: Exceptions werden nur geloggt, wenn Sie auch behandelt werden.
Wird eine Exception nicht behandelt (also an den Aufrufer weitergereicht), wird sie auch nicht geloggt.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logging</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Je nach Schwere des Fehlers wird die Exception in einem der folgenden Log-Level geloggt (siehe <a href="#log-level">Log-Level</a>):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>FATAL: Falls es sich um einen schwerwiegenden Fehler handelt (vgl. auch Szenario „Schwerwiegenden Fehler erkennen und behandeln“ in <a href="#schwerwiegenden-fehler-erkennen-und-behandeln">Schwerwiegenden Fehler erkennen und behandeln</a>).</p>
</li>
<li>
<p>ERROR: Falls der Fehler zur Beeinträchtigung des Systembetriebs führt, das System aber weiterlaufen kann (vgl. auch Szenario „Beeinträchtigung des Betriebs erkennen und behandeln“ in
<a href="#beeinträchtigung-des-betriebs-erkennen-und-behandeln">Beeinträchtigung des Betriebs erkennen und behandeln</a>)</p>
</li>
<li>
<p>WARN: Wenn es sich um ein inkonsistentes / unerwartetes Systemverhalten handelt, welches der Entwicklungsabteilung mitgeteilt werden muss (vgl. auch Szenario „Unerwartetes Systemverhalten erkennen und behandeln“ in
<a href="#unerwartetes-systemverhalten-erkennen-und-behandeln">Unerwartetes Systemverhalten erkennen und behandeln</a>).</p>
</li>
<li>
<p>INFO: Wenn es sich um einen „erwarteten“ Fehler handelt, der durch das System behandelt werden.
Dies umfasst insbesondere auch Exceptions, die mit einem Retry behandelt werden – bspw. wenn eine OptimisticLockException gefangen und die Anfrage wiederholt wird.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Das Erstellen der Logeinträge erfolgt mittels der Methoden <code>log.fatal(…)</code>, <code>log.error(…)</code>, <code>log.warn(…)</code> und <code>log.info(…)</code>.
Sollte es zwingend notwendig sein, datenschutzrelevante fachliche Daten in den Logeintrag zu schreiben, muss stattdessen die entsprechende Methode zum Loggen von Fachdaten verwendet werden (vgl. <a href="../konzept/master.html#einleitung" class="xref page">Logging - Konzept</a>): <code>log.fatalFachdaten(…)</code>, <code>log.errorFachdaten(…)</code> und <code>log.warnFachdaten(…)</code>.</p>
</div>
<div class="paragraph">
<p>Die Lognachricht muss das eingetretene Szenario kurz und möglichst Präzise beschreiben, bspw.: „Fehler beim Zugriff auf die Datenbank“.</p>
</div>
<div class="paragraph">
<p><span class="underline">Anmerkung</span>: Zur Fehleranalyse sind insbesondere der Fehlerschlüssel, Fehlertext und der Stacktrace relevant.
Diese werden automatisch durch das Logging-Framework geloggt und müssen daher nicht manuell in die Lognachricht übernommen werden.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Auswertungsszenario</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Schwerwiegenden Fehler erkennen und behandeln</p>
</li>
<li>
<p>Beeinträchtigung des Betriebs erkennen und behandeln</p>
</li>
<li>
<p>Unerwartetes Systemverhalten erkennen und behandeln</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="wichtige-systemereignisse"><a class="anchor" href="#wichtige-systemereignisse"></a>3.2.3.2. Wichtige Systemereignisse</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 71.4286%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Es tritt ein wichtiges Ereignis auf, welches für die Durchführung der folgenden Auswertungen relevant ist:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Betriebliche Überwachung</p>
</li>
<li>
<p>Performance überwachen</p>
</li>
<li>
<p>Nutzungshäufigkeit auswerten</p>
</li>
<li>
<p>Systemzustand und -ereignisse überwachen</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Es ist Aufgabe des technischen Chefdesigners diese Stellen im Rahmen des Systementwurfs zu Identifizieren und mit dem Auftraggeber abzustimmen.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logging</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Es muss ein spezifischer Ereignisschlüssel definiert, im Systementwurf dokumentiert und ein Logeintrag im Level INFO erstellt werden.
Tritt an mehreren Stellen in der Anwendung das gleiche zu loggende Ereignis auf, kann der gleiche Ereignisschlüssel verwendet werden.<br>
Das Loggen der Einträge erfolgt mit der Methode<br>
<code>log.info(&lt;kategorie&gt;, &lt;schluessel&gt;, &lt;nachricht&gt;, &lt;werte&gt;)</code><br>
Bspw.:<br>
<code>log.info(LogKategorie.JOURNAL, "SYSXY01234", "Das Sucherfahren lieferte einen Datensatz mit ID {}.
Dieser ist nicht im Bestand vorhanden und wird im Suchverfahren gelöscht.", "12345");</code><br>
<code>log.info(LogKategorie.SICHERHEIT, "SYSXY01235", "Innerhalb der letzten Minute wurden {}
ungültige Logins mit Anwendernamen {} durchgeführt.", "29", "max_muster");</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Auswertungsszenario</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Betriebliche Überwachung</p>
</li>
<li>
<p>Performance überwachen</p>
</li>
<li>
<p>Nutzungshäufigkeit auswerten</p>
</li>
<li>
<p>Systemzustand und -ereignisse überwachen</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="durchführen-einer-bulk-query"><a class="anchor" href="#durchführen-einer-bulk-query"></a>3.2.3.3. Durchführen einer Bulk-Query</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 71.4286%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Es wird eine native SQL-Bulk-Query (Manipulation mehrerer Datensätze) in der Datenbank durchgeführt.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logging</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Es muss ein Logeintrag erstellt werden, der die Query beschreibt und die Anzahl der betroffenen Datensätze als Platzhalter enthält:<br>
<code>log.debug("&lt;Beschreibung der Query mit Platzhalter für Anzahl der betroffenen Datensätze und Name der Query&gt;",
&lt;Name der Query&gt;, &lt;Anzahl Datensätze&gt;);</code><br>
Bspw.:<br>
<code>log.debug("Query \{} zum Löschen veralteter Sachverhalte wurde ausgeführt.
Es wurden \{} Sachverhalte gelöscht.", &lt;Name der Query&gt;, &lt;Anzahl Datensätze&gt;);</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Auswertungsszenario</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Fehleranalyse</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="unterstützung-der-fehleranalyse-debug"><a class="anchor" href="#unterstützung-der-fehleranalyse-debug"></a>3.2.3.4. Unterstützung der Fehleranalyse (Debug)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 71.4286%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An allen Stellen der Verarbeitungslogik, die für eine spätere Fehleranalyse <em>relevant</em> sind, müssen entsprechende DEBUG-Einträge erstellt werden.
Welche Stellen relevant sind, ist abhängig vom konkreten System und kann nicht allgemein festgelegt werden.
Es liegt im Ermessen des Technischen Chefdesigners und der Entwickler, diese Stellen zu identifizieren.
Typische Szenarien sind:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Unterschiedliche Zweige in <code>if-then-else</code> Anweisungen.</p>
</li>
<li>
<p>Passieren kritischer Verarbeitungsschritte bspw. dem Abschluss der Prüfung übermittelter Daten.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logging</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Das Erstellen der Logeinträge erfolgt mittels der Methode:<br>
<code>log.debug("&lt;Nachricht&gt;", "&lt;Werte&gt;");</code><br>
Sollte es zwingend notwendig sein, fachliche, datenschutzrelevante Daten in den Logeintrag zu schreiben, muss stattdessen die Methode<br>
<code>log.debugFachdaten("&lt;Nachricht&gt;", "&lt;Werte&gt;");</code><br>
verwendet werden (vgl. <a href="../konzept/master.html#einleitung" class="xref page">Logging - Konzept</a>).<br>
Da dieses Szenario eine Vielzahl unterschiedlicher Fälle zusammenfasst, können hierfür keine konkreten Nachrichten vorformuliert werden.
Zu beachten ist, dass die Nachrichten primär durch Entwickler im Falle eines Fehlers ausgewertet werden, meist aber nicht dem Entwickler, der den Code geschrieben hat.<br>
Die jeweilige Nachricht <strong>muss</strong> daher <strong>zwingend</strong> so formuliert werden, dass das Ereignis auch ohne Kenntnis des Quellcodes verstanden werden kann – analog zu den in <a href="#fachliche-korrelation-von-eintraegen">Fachliche Korrelation von Einträgen</a> definierten Lognachrichten.
Bspw.:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Falsch</strong>: „Hier“, „Fertig“, „1“, „OK“</p>
</li>
<li>
<p><strong>Richtig</strong>: „Regelwerksprüfungen erfolgreich abgeschlossen“, „Führe Suche nach Personen durch“</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="underline">Anmerkung</span>: Für eine detaillierte Fehleranalyse ist es natürlich meist unerlässlich auch den Programmcode einzusehen.
Durch die verständliche Formulierung der Logeinträge kann der Hergang, der zu einem Fehler geführt hat, jedoch viel einfacher und schneller nachvollzogen werden und damit die Fehlerquelle schneller identifiziert werden.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Auswertungsszenario</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Fehleranalyse (Debugging)</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="fachliche-korrelation-von-eintraegen"><a class="anchor" href="#fachliche-korrelation-von-eintraegen"></a>3.2.3.5. Fachliche Korrelation von Einträgen</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 71.4286%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>In komplexen Verfahren kann es notwendig sein, die erstellten Logeinträge fachlich in Verbindung zueinander zu setzen – bspw. Kennzeichnen aller Logeinträge, die sich auf einen bestimmten Datensatz beziehen, durch Aufnahme des eindeutigen Schlüssel des betroffenen Datensatzes.</p>
</div>
<div class="paragraph">
<p>Wenn diese Anforderung gegeben ist, kann dies beim Aufruf an der Systemgrenze (vgl. Szenario <a href="#aufruf-an-systemgrenze">Aufruf an Systemgrenze</a>) wie im Folgenden beschrieben berücksichtigt werden.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logging</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An der Systemgrenze wird der eindeutige Schlüssel des Datensatzes in den MDC aufgenommen.
Dabei müssen folgende Aspekte berücksichtigt werden:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Das Setzen und Entfernen des Schlüssels im MDC erfolgt direkt über die Klasse „MDC“, die von SLF4J bereitgestellt wird.</p>
</li>
<li>
<p>Der MDC ist eine Map (Mapped Diagnostic Context - Name-Wert-Paar). Als Name muss ein sprechender, gut auswertbarer Name verwendet werden bspw. „kundennummer“.</p>
</li>
<li>
<p>Sollte es sich bei dem Schlüssel um datenschutzrelevante Daten handeln, muss der MDC mit einem Marker als „fachlich“ gekennzeichnet werden (vgl. <a href="#mdchelper">MdcHelper</a>).</p>
</li>
<li>
<p>Der Schlüssel und der ggf. gesetzte Marker müssen in jedem Fall beim Verlassen der Methode, in der sie gesetzt wurden, wieder aus dem MDC entfernt werden.
Das Entfernen sollte daher in einem „finally“-Block stattfinden.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Auswertungsszenario</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Fachliche Verarbeitung eines Aufrufs nachvollziehen</p>
</li>
<li>
<p>Fehleranalyse (Debugging)</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="loggen-fachlicher-operationen"><a class="anchor" href="#loggen-fachlicher-operationen"></a>3.2.3.6. Loggen fachlicher Operationen</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 71.4286%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Der Fachbereich hat für das System Anforderungen definiert, dass die Verarbeitung einzelner Aufrufe fachlich nachvollziehbar sein muss.
Dies ist im Auswertungsszenario „Fachliche Verarbeitung eines Aufrufs nachvollziehen“ (siehe <a href="#fachliche-verarbeitung-eines-aufrufs-nachvollziehen">Fachliche Verarbeitung eines Aufrufs nachvollziehen</a>) beschrieben.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logging</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Die zu erstellenden Logeinträge sind spezifisch für das jeweilige Verfahren.
Zu beachten ist jedoch, dass die Aufrufe im Log-Level INFO zu erstellen sind.
Für alle Logeinträge, die dem gleichen Zweck dienen (also der gleichen fachlichen Anforderung), muss der gleiche Ereignisschlüssel verwendet werden.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Auswertungsszenario</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Fachliche Verarbeitung eines Aufrufs nachvollziehen</p>
</li>
<li>
<p>Fehleranalyse (Debugging)</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ereignisschluessel-isy-logging"><a class="anchor" href="#ereignisschluessel-isy-logging"></a>4. Ereignisschlüssel isy-logging</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Im Folgenden werden die spezifischen Ereignisschlüssel der Komponente <code>isy-logging</code> beschrieben:</p>
</div>
<table id="table-ESisylog" class="tableblock frame-all grid-all stretch">
<caption class="title">Tabelle 7. Ereignisschlüssel isy-logging</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 10%;">
<col style="width: 15%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Schlüssel (s.u.)</th>
<th class="tableblock halign-center valign-top">Level</th>
<th class="tableblock halign-left valign-top">Kategorie</th>
<th class="tableblock halign-left valign-top">Text</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO01001</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">INFO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JOURNAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Methode &lt;Klasse.Methode&gt; wird aufgerufen.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO01002</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">INFO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">METRIK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Aufruf von &lt;Klasse.Methode&gt; erfolgreich beendet.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO01003</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">INFO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">METRIK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Aufruf von &lt;Klasse.Methode&gt; mit Fehler beendet.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO01004</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">INFO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PROFILING</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Aufruf von &lt;Klasse.Methode&gt; erfolgreich beendet. Der Aufruf dauerte &lt;Dauer in Millisekunden&gt; ms.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO01005</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">INFO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PROFILING</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Aufruf von &lt;Klasse.Methode&gt; mit Fehler beendet. Der Aufruf dauerte &lt;Dauer in Millisekunden&gt; ms.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO01011</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">INFO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JOURNAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Die Methode &lt;Klasse.Methode&gt; des Nachbarsystems &lt;systemname&gt; wird unter der URL &lt;url&gt; aufgerufen.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO01012</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">INFO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">METRIK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Aufruf von &lt;Klasse.Methode&gt; des Nachbarsystems &lt;systemname&gt; unter der URL &lt;url&gt; erfolgreich beendet.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO01013</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">INFO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">METRIK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Aufruf von &lt;Klasse.Methode&gt; des Nachbarsystems &lt;systemname&gt; unter der URL &lt;url&gt; mit Fehler beendet.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO01014</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">INFO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PROFILING</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Aufruf von &lt;Klasse.Methode&gt; des Nachbarsystems &lt;systemname&gt; unter der URL &lt;url&gt; erfolgreich beendet.
Der Aufruf dauerte &lt;Dauer in Millisekunden&gt; ms.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO01015</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">INFO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PROFILING</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Aufruf von &lt;Klasse.Methode&gt; des Nachbarsystems &lt;systemname&gt; unter der URL &lt;url&gt; mit Fehler beendet.
Der Aufruf dauerte &lt;Dauer in Millisekunden&gt; ms.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO02001</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">INFO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JOURNAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ApplicationContext des Systems &lt;Systemname&gt; (Systemart) wurde gestartet oder aktualisiert.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO02002</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">INFO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JOURNAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Der ApplicationContext des Systems &lt;Systemname&gt; (Systemart) wurde gestopped.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO02003</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">INFO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JOURNAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Die Systemversion ist &lt;Versionsnummer&gt;.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EISYLO02004</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">INFO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JOURNAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Der Laufzeitparameter &lt;Parametername&gt; besitzt den Wert &lt;Wert&gt;.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</article>
  </div>
</main>
</div>
<div class="divFooter"></div>

<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../_/js/isyfact.js"></script>
  </body>
</html>
