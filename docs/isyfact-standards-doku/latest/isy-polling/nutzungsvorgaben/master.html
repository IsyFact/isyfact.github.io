<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Baustein Polling :: IsyFact Dokumentation</title>
    <link rel="canonical" href="https://github.com/isyfact/isyfact-standards-doku/latest/isy-polling/nutzungsvorgaben/master.html">
    <meta name="generator" content="Antora 3.0.1">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <link rel="stylesheet" href="../../../../_/css/font-awesome.min.css">
    <link rel="stylesheet" href="../../../../_/css/isyfact.css">
    <script>var uiRootPath = '../../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://github.com/isyfact">IsyFact Dokumentation</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="isyfact-standards-doku" data-version="2.5-SNAPSHOT">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../einstieg/vorstellung.html">IsyFact Standards</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Einstieg</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../einstieg/vorstellung.html">Vorstellung der IsyFact</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/vorstellung/isyfact-standards.html">IsyFact-Standards</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/vorstellung/isyfact-erweiterungen.html">IsyFact-Erweiterungen</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../einstieg/vorstellung/rahmenbedingungen.html">Rahmenbedingungen</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/erste-schritte.html">Erste Schritte</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/tutorial/master.html">Tutorial</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/whitepaper/master.html">Whitepaper</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../einstieg/migrationsleitfaden-if2/master.html">Migrationsleitfaden IsyFact 2</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Blaupausen</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../blaupausen/referenzarchitektur/master.html">Referenzarchitektur</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../blaupausen/referenzarchitektur-it-system/master.html">Referenzarchitektur IT-System</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-anwendungskern/master.html">Anwendungskern</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-datenzugriff/master.html">Datenzugriff</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-service/master.html">Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-web-gui/master.html">Web GUI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/detailkonzept-komponente-batch/master.html">Batch</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Vorgaben</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/vorgaben-architektur/master.html">Architektur</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../blaupausen/vorgaben-it-sicherheit/master.html">IT-Sicherheit</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Bausteine</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Datum &amp; Zeit</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-datetime/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-datetime/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Fehlerbehandlung</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-exception-core/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-exception-core/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">HttpInvoker</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-serviceapi-core/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-serviceapi-core/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Konfiguration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-konfiguration/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-konfiguration/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Logging</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-logging/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-logging/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Polling</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">REST</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-service-rest/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-service-rest/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Sicherheit</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sicherheit/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sicherheit/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Sonderzeichen</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sonderzeichen/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-sonderzeichen/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Task Scheduling</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-task/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-task/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Ãœberwachung</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-ueberwachung/konzept/master.html">Konzept</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-ueberwachung/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Util</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../isy-util/nutzungsvorgaben/master.html">Nutzungsvorgaben</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Methodik</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../methodik/namenskonventionen/master.html">Namenskonventionen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../methodik/versionierung/master.html">Versionierung</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../methodik/java-programmierkonventionen/master.html">Java-Programmierkonventionen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../methodik/diagrammerstellung.html">Diagrammerstellung und Modellierung</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/diagrammerstellung/diagramsnet.html">diagrams.net</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/diagrammerstellung/enterprise-architect.html">Enterprise Architect</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../methodik/vorlagen.html">Vorlagen</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/tailoring/tailoring.html">Tailoring</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodik/spezifikation/datenflussdiagramme.html">Datenflussdiagramme</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Werkzeuge</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../werkzeuge/einrichtung_entwicklungsumgebung/master.html">Entwicklungsumgebung</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../werkzeuge/versionierungskontrolle/master.html">Versionierungskontrolle</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../werkzeuge/handbuch_dokumentation/master.html">Dokumentation der IsyFact</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../werkzeuge/seitenvorlage.html">Seitenvorlage</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../werkzeuge/kopiervorlage.html">Kopiervorlage fÃ¼r neue Seiten</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../changelog/changelog.html">Changelog</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">IsyFact Standards</span>
    <span class="version">2.5-SNAPSHOT</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../../glossary/latest/glossary/master.html">Glossar</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../glossary/latest/glossary/master.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../../einstieg/vorstellung.html">IsyFact Standards</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../einstieg/vorstellung.html">2.5-SNAPSHOT</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../einstieg/vorstellung.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../einstieg/vorstellung.html">IsyFact Standards</a></li>
    <li>Bausteine</li>
    <li>Polling</li>
    <li><a href="master.html">Nutzungsvorgaben</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Inhalt" data-levels="3">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Baustein Polling</h1>
<div id="preamble">
<div class="sectionbody">
<h3 id="_nutzungsvorgaben" class="discrete">Nutzungsvorgaben</h3>
<div class="paragraph">
<p><span class="image left"><img src="../../../../glossary/latest/licence/_images/IFS-Logo.png" alt="IFS-Logo" width="150"></span> Dieses Dokument ist ein Teil der IsyFact-Standards. Alle Inhalte dieses Dokuments, insbesondere Texte und Grafiken, sind urheberrechtlich geschÃ¼tzt. Alle urheberrechtlichen Nutzungs- und Verwertungsrechte liegen beim Bundesverwaltungsamt.</p>
</div>
<div class="paragraph">
<p><span class="image right"><img src="../../../../glossary/latest/licence/_images/CC-BY.png" alt="Creative Commons Namensnennung" width="100"></span>
Die Nutzung ist unter den Lizenzbedingungen der Creative Commons Namensnennung 4.0 International gestattet.
Die Lizenzbestimmungen sind unter folgender URL erhÃ¤ltlich:</p>
</div>
<div class="paragraph">
<p><a href="../../../../glossary/latest/literaturextern/inhalt.html#litextern-cc-licence" class="xref page">Creative-Commons-Lizenz</a></p>
</div>
<div class="paragraph">
<p><strong>Java Bibliothek / IT-System</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 20%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Art</th>
<th class="tableblock halign-left valign-top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">isy-polling</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bibliothek</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">v2.5-SNAPSHOT</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="einleitung"><a class="anchor" href="#einleitung"></a>1. Einleitung</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In <a href="thisdoc.html#einleitung" class="xref page">Polling - Konzept</a> werden die konzeptionellen Grundlagen und Vorgaben fÃ¼r Polling definiert, um eine einheitliche Umsetzung in der gesamten <a href="../../../../glossary/latest/glossary/master.html#glossar-Anwendungslandschaft" class="xref page">Anwendungslandschaft</a> zu gewÃ¤hrleisten.
Dieses Dokument beschreibt die Verwendung der <a href="../../../../glossary/latest/glossary/master.html#glossar-Bibliothek" class="xref page">Bibliothek</a> <code>isy-polling</code>, die dieses Verfahren implementiert.</p>
</div>
<div class="paragraph">
<p>Dieses Dokument richtet sich an Entwickler und Chefdesigner, die Polling-FunktionalitÃ¤t in eine Anwendung integrieren wollen.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="die-bibliothek-isy-polling"><a class="anchor" href="#die-bibliothek-isy-polling"></a>2. Die Bibliothek isy-polling</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Die Bibliothek <code>isy-polling</code> der IsyFact-Standards implementiert den im <a href="#">Polling - Konzept</a> dargestellten Synchronisationsmechanismus Ã¼ber JMX.
Die Bibliothek kann mit mehreren zu pollenden Datenquellen und beliebig vielen Instanzen der Anwendung zum Abfragen einer Datenquelle umgehen.</p>
</div>
<div class="paragraph">
<p>Zur weiteren ErlÃ¤uterung der einzelnen Klassen der Bibliothek wird zunÃ¤chst der Begriff â€žPolling-Clusterâ€œ definiert:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
Ein <strong>Polling-Cluster</strong> besteht aus einer Menge von Anwendungsinstanzen, die jeweils die gleiche Datenquelle abfragen und wird durch eine innerhalb der Anwendung eindeutige ID identifiziert.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Ein Polling-Cluster wird durch die Klasse <code>PollingCluster</code> implementiert.
Diese Klasse ist dafÃ¼r zustÃ¤ndig, die Informationen eines Polling-Clusters zu verwalten.
Hierzu zÃ¤hlen insbesondere der Zeitpunkt der letzten Polling-AktivitÃ¤t und die Wartezeit.
Die wesentlichen Parameter eines Polling-Clusters werden Ã¼ber die Anwendungskonfiguration festgelegt und beim Start der Anwendung eingelesen.</p>
</div>
<div class="paragraph">
<p>Die Verwaltung des Pollings fÃ¼r mehrere Nachrichtenquellen erfolgt Ã¼ber einen Polling-Verwalter (Klasse <code>PollingVerwalter</code>).
Der Polling-Verwalter kennt und verwaltet alle PollingCluster der Anwendung.
Die Klasse <code>PollingVerwalter</code> ist die einzige Klasse der Bibliothek, die eine Anwendungsimplementierung direkt nutzt.</p>
</div>
<div class="paragraph">
<p>Die Methode <code>startePolling</code> prÃ¼ft, ob die aufrufende Anwendungsinstanz das Polling durchfÃ¼hren darf.
Hierzu wird ihr die ID des Polling-Clusters als Argument Ã¼bergeben.
Sie liefert <code>true</code>, wenn das Polling gestartet werden darf, ansonsten <code>false</code>.
HierfÃ¼r wird der seit der letzten Polling-AktivitÃ¤t vergangene Zeitraum der anderen Instanzen des Polling-Clusters Ã¼ber JMX abgefragt und zusammen mit der im Polling-Cluster hinterlegten Wartezeit ausgewertet.</p>
</div>
<div class="paragraph">
<p>Die Methode <code>aktualisiereZeitpunktLetztePollingÂ­Aktivitaet</code> setzt den Zeitpunkt der letzten Polling-AktivitÃ¤t fÃ¼r den Polling-Cluster mit der Ã¼bergebenen ID auf den aktuellen Systemzeitpunkt, die Methode <code>getZeitpunktLetztePollingAktivitaet</code> liefert den Zeitpunkt der letzten Polling-AktivitÃ¤t fÃ¼r den Polling-Cluster mit der Ã¼bergebenen ID.</p>
</div>
<div class="paragraph">
<p>Mit der Annotation <code>PollingAktion</code> ist es mÃ¶glich, eine Methode zu annotieren, bei deren Aufruf dann der Zeitstempel fÃ¼r den angegebenen Polling-Cluster aktualisiert wird.
Der zugehÃ¶rige Interceptor ist in der Klasse <code>PollingAktionInterceptor</code> implementiert.</p>
</div>
<div class="paragraph">
<p>SchlieÃŸlich ermÃ¶glicht die Klasse <code>PollingMBean</code> den anderen Instanzen, den seit der letzten Polling-AktivitÃ¤t vergangenen Zeitraum Ã¼ber JMX abzufragen.</p>
</div>
<div class="paragraph">
<p>In <a href="#polling-klassendiagramm">Abbildung 1</a> ist das Klassendiagramm der Bibliothek <code>isy-polling</code> dargestellt.</p>
</div>
<div id="polling-klassendiagramm" class="imageblock text-center">
<div class="content">
<img src="../_images/nutzungsvorgaben/polling-klassendiagramm.png" alt="polling klassendiagramm">
</div>
<div class="title">Abbildung 1. Klassendiagramm der Bibliothek isy-polling</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="einbinden-der-bibliothek-in-die-anwendung"><a class="anchor" href="#einbinden-der-bibliothek-in-die-anwendung"></a>3. Einbinden der Bibliothek in die Anwendung</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Polling wird in der Regel in einem Verarbeitungszyklus implementiert, der Ã¼ber einen Timer gestartet wird.
Der Verarbeitungszyklus kann eine oder nacheinander mehrere Datenquellen abfragen.</p>
</div>
<div class="paragraph">
<p>Das Einbinden der Bibliothek <code>isy-polling</code> in eine Anwendung erfolgt Ã¼ber Spring.
JMX-Verbindungen und Polling-Cluster werden Ã¼ber die Anwendungskonfiguration definiert.</p>
</div>
<div class="paragraph">
<p>Im Folgenden wird im Detail beschrieben, wie die Bibliothek eingebunden und genutzt wird.</p>
</div>
<div class="sect2">
<h3 id="anwendungskonfiguration"><a class="anchor" href="#anwendungskonfiguration"></a>3.1. Anwendungskonfiguration</h3>
<div class="paragraph">
<p>In der Anwendungskonfiguration werden Polling-Cluster und JMX-Verbindungsparameter definiert.
Bei der Definition der Polling-Cluster hat man die MÃ¶glichkeit einen Cluster fÃ¼r einen gesamten Verarbeitungszyklus oder einen Cluster fÃ¼r jede abzufragende Datenquelle zu definieren.
Welche der beiden MÃ¶glichkeiten gewÃ¤hlt wird, hÃ¤ngt vom konkreten Anwendungsfall ab und muss beim Entwurf der Anwendung entschieden werden.</p>
</div>
<div class="sect3">
<h4 id="lastverteilung-ueber-cluster-definition"><a class="anchor" href="#lastverteilung-ueber-cluster-definition"></a>3.1.1. Lastverteilung Ã¼ber Cluster-Definition</h4>
<div class="paragraph">
<p>Wird ein Polling-Cluster je zu pollender Datenquelle festgelegt, so kann eine gewisse Lastverteilung erreicht werden wie folgendes Beispiel zeigt:</p>
</div>
<div class="paragraph">
<p><span class="underline">Beispiel</span>:</p>
</div>
<div class="paragraph">
<p>In einer Anwendung ist ein Verarbeitungszyklus so realisiert, dass drei E-Mail-Konten nacheinander abgefragt werden.
Der Verarbeitungszyklus wird periodisch Ã¼ber einen Timer gestartet.
Es gibt zwei Instanzen der Anwendung.
Wird fÃ¼r jedes E-Mail-Konto ein eigener Polling-Cluster definiert, so ist der Ablauf der folgende:</p>
</div>
<div class="paragraph">
<p>Der Timer im KnotenÂ 1 startet den Verarbeitungszyklus.
Es wird zunÃ¤chst der Polling-Verwalter gefragt, ob das Polling fÃ¼r den ClusterÂ 1 gestartet werden darf.
KnotenÂ 2 hat das Polling noch nicht begonnen, so dass der Polling-Verwalter im KnotenÂ 1 die Verarbeitung der Nachrichten aus dem E-Mail-KontoÂ 1 erlaubt.</p>
</div>
<div class="paragraph">
<p>Zwischenzeitlich startet auch der Timer im KnotenÂ 2 einen Verarbeitungszyklus.
Der Polling-Verwalter im KnotenÂ 2 erkennt, dass das Polling im KnotenÂ 1 fÃ¼r den ClusterÂ 1 bereits aktiv ist und verweigert die Erlaubnis, die Nachrichten des E-Mail-KontoÂ 1 abzuarbeiten.
Die Anwendung fragt den Polling-Verwalter daher als nÃ¤chstes um Erlaubnis, das Polling fÃ¼r den ClusterÂ 2 durchzufÃ¼hren.
Das wird erlaubt und KnotenÂ 2 verarbeitet die Nachrichten des E-Mail-KontoÂ 2.</p>
</div>
<div class="paragraph">
<p>WÃ¤hrend KnotenÂ 2 noch mit den Nachrichten des E-Mail-KontoÂ 2 beschÃ¤ftigt ist, hat KnotenÂ 1 alle Nachrichten aus E-Mail-KontoÂ 1 verarbeitet.
Er fragt jetzt den Polling-Verwalter um Erlaubnis, das Polling fÃ¼r den ClusterÂ 2 durchzufÃ¼hren.
Die Erlaubnis wird verweigert, weil KnotenÂ 2 bereits damit beschÃ¤ftigt ist.
Daher fragt die Anwendung als nÃ¤chstes um Erlaubnis, das Polling fÃ¼r den Cluster 3 durchzufÃ¼hren.
Das wird erlaubt und KnotenÂ 1 verarbeitet die Nachrichten aus dem E-Mail-KontoÂ 3.</p>
</div>
<div class="paragraph">
<p>KnotenÂ 2 ist mit der Verarbeitung des E-Mail-KontoÂ 2 fertig und mÃ¶chte nun E-Mail-KontoÂ 3 verarbeiten, was aber verweigert wird, da KnotenÂ 1 bereits damit beschÃ¤ftigt ist.
Dies schlieÃŸt den Verarbeitungszyklus im Knoten 2 ab.</p>
</div>
<div class="paragraph">
<p>Dieses Beispiel zeigt, dass E-Mail-Konten parallel von beiden Instanzen abgearbeitet werden kÃ¶nnen.</p>
</div>
</div>
<div class="sect3">
<h4 id="konfigurationsklassen"><a class="anchor" href="#konfigurationsklassen"></a>3.1.2. Konfiguration Ã¼ber Properties</h4>
<div class="paragraph">
<p>Polling-Cluster und JMX-Verbindungsparameter werden Ã¼ber Properties in <code>application.properties</code> konfiguriert.
Konfigurationsparameter einer AusprÃ¤gung haben dann das Namensschema &lt;Konfigurationsklassen-PrÃ¤fix&gt;.&lt;ID der AusprÃ¤gung&gt;.&lt;Name des Konfigurationsparameters&gt;.</p>
</div>
<div class="paragraph">
<p>Das Beispiel in <a href="#listing-PollingKonfiguration">Listing 1</a> zeigt folgende Vorgaben:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Die Properties von fÃ¼r die Konfiguration der JMX-Verbindungen haben das PrÃ¤fix <code>isy.polling.jmx.verbindungen</code>.
Das PrÃ¤fix fÃ¼r die Cluster-Konfiguration ist <code>isy.polling.cluster</code>.</p>
</li>
<li>
<p>FÃ¼r die Konfiguration der JMX-Verbindung gibt es die Konfigurationsparameter <code>host</code>, <code>port</code>, <code>benutzer</code> und <code>passwort</code>.
FÃ¼r die Konfiguration der Cluster gibt es die Parameter <code>name</code>, <code>wartezeit</code>, <code>jmxverbindungen</code>.</p>
</li>
<li>
<p>Es gilt die Konvention, dass IDs fÃ¼r AusprÃ¤gungen groÃŸgeschrieben werden.
Damit kann an einzelnen KonfigurationseintrÃ¤gen sofort erkannt werden, dass sie zu einer Konfigurationsklasse gehÃ¶ren.</p>
</li>
</ul>
</div>
<div id="listing-PollingKonfiguration" class="listingblock">
<div class="title">Listing 1. Polling Konfiguration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">isy.polling.jmx.verbindungen.SERVER1.host = host1
isy.polling.jmx.verbindungen.SERVER1.port = 9001
isy.polling.jmx.verbindungen.SERVER1.benutzer = userid1
isy.polling.jmx.verbindungen.SERVER1.passwort = pwd1

isy.polling.cluster.POSTFACH1_CLUSTER.name = Postfachabruf-1
isy.polling.cluster.POSTFACH1_CLUSTER.wartezeit = 600
isy.polling.cluster.POSTFACH2_CLUSTER.name = Postfachabruf-2
isy.polling.cluster.POSTFACH2_CLUSTER.wartezeit = 700
isy.polling.cluster.POSTFACH2_CLUSTER.jmxverbindungen = server1,server2</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="konfigurationsparameter"><a class="anchor" href="#konfigurationsparameter"></a>3.1.2.1. Konfigurationsparameter</h5>
<div class="paragraph">
<p>JMX-Verbindungen haben die folgenden Attribute:</p>
</div>
<div class="paragraph">
<p><code>isy.polling.jmx.verbindungen.&lt;ID&gt;.host</code>:<br>
Hostangabe fÃ¼r den JMX-Zugriff.</p>
</div>
<div class="paragraph">
<p><code>isy.polling.jmx.verbindungen.&lt;ID&gt;.port</code>:<br>
Portangabe fÃ¼r den JMX-Zugriff.</p>
</div>
<div class="paragraph">
<p><code>isy.polling.jmx.verbindungen.&lt;ID&gt;.benutzer</code>:<br>
Benutzerkennung fÃ¼r den JMX-Zugriff</p>
</div>
<div class="paragraph">
<p><code>isy.polling.jmx.verbindungen.&lt;ID&gt;.passwort</code>:<br>
Kennwort fÃ¼r den JMX-Zugriff</p>
</div>
<div class="paragraph">
<p>Polling-Cluster haben die folgenden Attribute:</p>
</div>
<div class="paragraph">
<p><code>isy.polling.cluster.&lt;ID&gt;.name</code>:<br>
Name des Polling-Clusters.
Der hier festgelegte Name wird zur MBean-Identifikation benutzt und ist in der JMX-Konsole sichtbar.</p>
</div>
<div class="paragraph">
<p><code>isy.polling.cluster.&lt;ID&gt;.wartezeit</code>:<br>
Wartezeit in Sekunden, die abgelaufen sein muss, damit diese Anwendung das Polling Ã¼bernehmen kann.
Dieser Wert sollte doppelt so groÃŸ sein, wie der Delay-Wert des Timers, der den Verarbeitungszyklus auslÃ¶st.
Die Wartezeit muss mindestens 10 Sekunden betragen.</p>
</div>
<div class="paragraph">
<p><code>isy.polling.cluster.&lt;ID&gt;.jmxverbindungen</code>:<br>
Kommaseparierte Liste von IDs der Verbindungsparameter zu den Ã¼brigen Clusterservern.
Dieser Eintrag ist optional und wird in der Regel nicht benÃ¶tigt.
Wird er weggelassen, so werden alle fÃ¼r das Polling konfigurierten JMX-Verbindungen zugeordnet.</p>
</div>
<div class="paragraph">
<p>Die JMX-Domain fÃ¼r den Polling-Verwalter ist in der Regel das Basispackage der Anwendung:</p>
</div>
<div class="paragraph">
<p><code>isy.polling.jmx.domain=&lt;DomÃ¤ne&gt;</code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="konfiguration-fuer-den-test"><a class="anchor" href="#konfiguration-fuer-den-test"></a>3.1.3. Konfiguration fÃ¼r den Test</h4>
<div class="paragraph">
<p>FÃ¼r Tests der Anwendung, insbesondere fÃ¼r lokale Entwicklertests, stehen in der Regel nicht mehrere Instanzen der Anwendung zur VerfÃ¼gung.
In diesem Fall kann das konfigurierte Polling die Tests behindern.</p>
</div>
<div class="paragraph">
<p>FÃ¼r Tests kann der Polling-Verwalter in den Standalone-Modus versetzt werden.
In diesem Modus erkennt der Polling-Verwalter, dass keine Cluster-Partner existieren und die Polling-Aktionen werden immer zugelassen.</p>
</div>
<div class="paragraph">
<p>Der Standalone-Modus wird automatisch gesetzt, wenn in der Konfiguration der keine JMX-Verbindungen Ã¼ber die Property <code>isy.polling.jmx.verbindungen</code> konfiguriert werden.
Da dieses Verhalten in der Regel im Produktivbetrieb nicht erwÃ¼nscht ist, wird die folgende Warnung in die Log-Ausgabe geschrieben:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
FÃ¼r das Polling der Anwendung wurden keine JMX-Verbindungsparameter angegeben! Der Polling-Modus wurde auf "Standalone" gesetzt!
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="beispiel-fuer-eine-polling-konfiguration"><a class="anchor" href="#beispiel-fuer-eine-polling-konfiguration"></a>3.1.4. Beispiel fÃ¼r eine Polling-Konfiguration</h4>
<div class="paragraph">
<p>In <a href="#listing-BeispielPollingKonfiguration">Listing 2</a> ist eine vollstÃ¤ndige Polling-Konfiguration fÃ¼r einen Cluster aufgefÃ¼hrt, der aus insgesamt zwei Instanzen der Anwendung besteht.</p>
</div>
<div id="listing-BeispielPollingKonfiguration" class="listingblock">
<div class="title">Listing 2. Beispiel Polling Konfiguration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"># -----------------------------------------------------------
# Parameter fÃ¼r das Polling
# -----------------------------------------------------------

# Verbindungsparameter zum anderen Knoten
# Hostangabe fÃ¼r den JMX-Zugriff
isy.polling.jmx.verbindungen.SERVER2.host = localhost
# Portangabe fÃ¼r den JMX-Zugriff
isy.polling.jmx.verbindungen.SERVER2.port = 9010
# Benutzerkennung fÃ¼r den JMX-Zugriff
isy.polling.jmx.verbindungen.SERVER2.benutzer = userid
# Kennwort fÃ¼r den JMX-Zugriff
isy.polling.jmx.verbindungen.SERVER2.passwort = pwd

# JMX-Domain; In der Regel das Basispackage der Anwendung
isy.polling.jmx.domain=de.bund.bva.domaene.anwendung

# Name des Clusters. Dieser Name wird zur Bildung der MBean-
# Identifikation verwendet.
isy.polling.cluster.MAILABRUF_CLUSTER.name = XY-Nachrichten
# Wartezeit in Sekunden, die abgelaufen sein muss, damit
# diese Anwendung das Polling Ã¼bernehmen kann.
isy.polling.cluster.MAILABRUF_CLUSTER.wartezeit = 600</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cluster kÃ¶nnen nicht dynamisch nur durch die Konfiguration erzeugt werden.
Sie sind vielmehr eng mit der Anwendungslogik verknÃ¼pft und sollten daher nicht vom Betrieb geÃ¤ndert werden.</p>
</div>
</div>
<div class="sect3">
<h4 id="beispiel-fuer-eine-polling-konfiguration-mit-lastverteilung"><a class="anchor" href="#beispiel-fuer-eine-polling-konfiguration-mit-lastverteilung"></a>3.1.5. Beispiel fÃ¼r eine Polling-Konfiguration mit Lastverteilung</h4>
<div class="paragraph">
<p>In <a href="#listing-BeispielPollingKonfigurationLastverteilung">Listing 3</a> ist die Polling-Konfiguration fÃ¼r zwei zu pollende Datenquellen mit jeweils eigenem Polling-Cluster aufgefÃ¼hrt.
Die beiden Cluster bestehen jeweils aus den zwei gleichen Instanzen der Anwendung.
Wie in Kapitel <a href="#lastverteilung-ueber-cluster-definition">Lastverteilung Ã¼ber Cluster Definition</a> beschrieben, kann so eine Lastverteilung erfolgen.</p>
</div>
<div id="listing-BeispielPollingKonfigurationLastverteilung" class="listingblock">
<div class="title">Listing 3. Beispiel Polling Konfiguration mit Lastverteilung</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"># -----------------------------------------------------------
# Parameter fÃ¼r das Polling
# -----------------------------------------------------------

# Verbindungsparameter zum anderen Knoten
# Hostangabe fÃ¼r den JMX-Zugriff
isy.polling.jmx.verbindungen.SERVER2.host = localhost
# Portangabe fÃ¼r den JMX-Zugriff
isy.polling.jmx.verbindungen.SERVER2.port = 9010
# Benutzerkennung fÃ¼r den JMX-Zugriff
isy.polling.jmx.verbindungen.SERVER2.benutzer = userid
# Kennwort fÃ¼r den JMX-Zugriff
isy.polling.jmx.verbindungen.SERVER2.passwort = pwd

# JMX-Domain; In der Regel das Basispackage der Anwendung
isy.polling.jmx.domain=de.bund.bva.domaene.anwendung

# Parameter des POSTFACH1_CLUSTER
# Name des Clusters. Dieser Name wird zur Bildung der MBean-
# Identifikation verwendet.
isy.polling.cluster.POSTFACH1_CLUSTER.name = Postfachabruf-1
# Wartezeit in Sekunden, die abgelaufen sein muss, damit
# diese Anwendung das Polling Ã¼bernehmen kann.
isy.polling.cluster.POSTFACH1_CLUSTER.wartezeit = 600
# Parameter des POSTFACH2_CLUSTER
# Name des Clusters. Dieser Name wird zur Bildung der MBean-
# Identifikation verwendet.
isy.polling.cluster.POSTFACH2_CLUSTER.name = Postfachabruf-2
# Wartezeit in Sekunden, die abgelaufen sein muss, damit
# diese Anwendung das Polling Ã¼bernehmen kann.
isy.polling.cluster.POSTFACH2_CLUSTER.wartezeit = 600</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="spring-konfiguration"><a class="anchor" href="#spring-konfiguration"></a>3.2. Spring-Konfiguration</h3>
<div class="paragraph">
<p>Die Bean fÃ¼r den Polling-Verwalter wird automatisch durch <code>isy-polling</code> konfiguriert.
Der Interceptor, der zur Verwendung der <code>@PollingAktion</code>-Annotation notwendig, wird ebenfalls automatisch konfiguriert.
ZusÃ¤tzlich wird fÃ¼r jeden Cluster eine MBean konfiguriert (<a href="#listing-KonfigurationMBeans">Listing 4</a>).</p>
</div>
<div id="listing-KonfigurationMBeans" class="listingblock">
<div class="title">Listing 4. Konfiguration der MBeans</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Bean
public PollingMBean mailabrufClusterMonitor(PollingVerwalter pollingVerwalter) {
    PollingMBean mBean = new PollingMBean();
    mBean.setClusterId("MAILABRUF_CLUSTER");
    mBean.setPollingVerwalter(pollingVerwalter);

    return mBean;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#listing-KonfigurationMBeans">Listing 4</a>: Die Property <code>pollingVerwalter</code> enthÃ¤lt die Referenz auf die Komponente â€žPolling-Verwalterâ€œ, die Property <code>clusterId</code> enthÃ¤lt die ID des Polling-Clusters, fÃ¼r den sie den seit der letzten Polling-AktivitÃ¤t vergangenen Zeitraum liefern soll.</p>
</div>
<div class="paragraph">
<p>Die Einbindung in JMX erfolgt Ã¼ber den MBean-Exporter dann wie in <a href="#listing-EinbindungJMX">Listing 5</a>.</p>
</div>
<div id="listing-EinbindungJMX" class="listingblock">
<div class="title">Listing 5. Einbindung in JMX</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Bean
public MBeanExporter mBeanExporter(@Qualifier("mailabrufClusterMonitor") PollingMBean mailabrufClusterMonitor, IsyPollingProperties isyPollingProperties) {
    MBeanExporter mBeanExporter = new MBeanExporter();
    mBeanExporter.setRegistrationPolicy(RegistrationPolicy.REPLACE_EXISTING);
    mBeanExporter.setAssembler(new MetadataMBeanInfoAssembler(new AnnotationJmxAttributeSource()));
    mBeanExporter.setAutodetect(false);

    Map&lt;String, Object&gt; mBeans = new HashMap&lt;&gt;();
    String key = "de.bund.bva.isyfact.polling:type=PollingStatus,name=\"Polling-Aktivitaet-"
        + isyPollingProperties.getCluster().get("MAILABRUF_CLUSTER").getName() + "\"";

    mBeans.put(key, mailabrufClusterMonitor);
    mBeanExporter.setBeans(mBeans);

    return mBeanExporter;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Hierbei ist zu beachten, dass der Cluster-Name aus der Konfiguration hier fÃ¼r die Bildung des Keys fÃ¼r die MBeans verwendet wird.</p>
</div>
</div>
<div class="sect2">
<h3 id="nutzung-im-code"><a class="anchor" href="#nutzung-im-code"></a>3.3. Nutzung im Code</h3>
<div class="paragraph">
<p>Wie bereits erwÃ¤hnt, wird Polling in der Regel in einem Verarbeitungszyklus implementiert, der Ã¼ber einen Timer gestartet wird.
Der Verarbeitungszyklus kann eine oder nacheinander mehrere Datenquellen abfragen, fÃ¼r die jeweils ein Polling-Cluster definiert sein kann.
FÃ¼r jeden Polling-Cluster werden in einem Verarbeitungszyklus die folgenden Schritte ausgefÃ¼hrt:</p>
</div>
<div class="paragraph">
<p><a href="#listing-AbfragePollingVerwalter">Listing 6</a>, ob das Polling fÃ¼r den Cluster gestartet werden darf.
Ist das nicht der Fall, ist die Verarbeitung fÃ¼r den Cluster beendet.</p>
</div>
<div id="listing-AbfragePollingVerwalter" class="listingblock">
<div class="title">Listing 6. Abfrage des Polling-Verwalters</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">if(!pollingVerwalter.startePolling("MAILABRUF_CLUSTER")) {
  LOG.info("Verarbeitung wurde nicht gestartet, da die " +
    "Wartezeit fÃ¼r den Cluster mit der ID " +
    "\"MAILABRUF_CLUSTER\" noch nicht " +
    "abgelaufen ist.");
  return;
}
fuehreVerarbeitungDurch();</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>DurchfÃ¼hren der Verarbeitung fÃ¼r jeden Datensatz.
Am Ende der Verarbeitung eines Datensatzes wird der Zeitpunkt der letzten Polling-AktivitÃ¤t aktualisiert.</p>
</li>
</ol>
</div>
<div id="listing-VerarbeitungDatensatz" class="listingblock">
<div class="title">Listing 7. Verarbeitung fÃ¼r jeden Datensatz</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// ...
for (Datensatz datensatz: datensaetze) {
  // Verarbeite Datensatz
  // ...
  pollingVerwalter.aktualisiereZeitpunktLetztePollingAktivitaet("MAILABRUF_CLUSTER");
}
// ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>oder</p>
</div>
<div id="listing-VerarbeitungPollingAktion" class="listingblock">
<div class="title">Listing 8. Verarbeitung mit Polling-Aktion</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
* FÃ¼hrt eine Polling-Aktion aus
*/
@PollingAktion(pollingCluster="MAILABRUF_CLUSTER")
public void doPollingAktion () {
  // Verarbeite Datensatz
  // ...
}
// ...
  for (Datensatz datensatz: datensaetze) {
    // Verarbeite Datensatz
    // ...
    doPollingAktion();
  }
// ...</code></pre>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<div class="divFooter"></div>

<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../_/js/isyfact.js"></script>
  </body>
</html>
